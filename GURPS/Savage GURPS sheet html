<!--  ==== ==== ==== version 5.4 13DEC2019 Author: Scott Sveter ==== ==== ==== -->
<div class="sheet-wrapper">
	<div class="sheet-hidden">
		<input type="number" name="attr_10" value="10" disabled="disabled" />
		<input type="number" name="attr_reeling_threshold" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_hp_collapse" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_hp_check1" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_hp_check2" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_hp_check3" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_hp_check4" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_dead" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_destroyed" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_fp_tired" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_fp_collapse" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_fp_uncons" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_cond_ST_mod" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_cond_DX_mod" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_cond_IQ_mod" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_cond_HT_mod" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_cond_AD_mod" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_cond_SC_mod" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_temp_ST_mod" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_temp_DX_mod" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_temp_IQ_mod" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_temp_HT_mod" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_temp_AD_mod" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_temp_SC_mod" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_STRoll_mod" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_DXRoll_mod" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_IQRoll_mod" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_HTRoll_mod" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_skillRoll_mod" value="0" step="1" readonly="readonly" />
		<input type="text" name="attr_current_conditions" value="" readonly="readonly" />
		<input type="checkbox" name="attr_surprised" value="1" />
		<input type="text" name="attr_man_description" value="" readonly="readonly" />
		<input type="text" name="attr_man_notes" value="" readonly="readonly" />
		<input type="text" name="attr_man_active_defense" value="" readonly="readonly" />
		<input type="number" name="attr_man_block_mod" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_man_dodge_mod" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_man_parry_mod" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_man_melee_mod" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_man_ranged_mod" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_att_points" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_advantages_points" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_disadvantages_points" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_quirks_points" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_racial_points" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_skills_points" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_techniques_points" value="0" step="1" readonly="readonly" />
		<input type="number" name="attr_spells_points" value="0" step="1" readonly="readonly" />
		<input type="text" name="attr_targeteffects" value="" readonly="readonly" />
		<input type="text" name="attr_targetrestr" value="" readonly="readonly" />
		<input type="number" name="attr_targetpenalty" value="0" readonly="readonly" />
		<input type="number" name="attr_targettable" readonly="readonly"/>
		<input type="number" name="attr_targetsubtable" readonly="readonly"/>
		<input type="number" name="attr_targettype" readonly="readonly"/>
		<input type="number" name="attr_basic_lift" readonly="readonly"/>
	</div>

<div class="heading">
	<input class="sheet-toggle" type="checkbox" title="Heading"/>
	<span class="sheet-checkbox">Heading</span>
<div class="content">
	<div class="sheet-box sheet-identity">
		<div class="sheet-table">
			<div class="sheet-header sheet-header-identity">
				<div class="sheet-cell sheet-col0">Identity</div>
			</div>
			<div class="sheet-row sheet-row-identity">
				<div class="sheet-cell sheet-col0">Name:</div>
				<div class="sheet-cell sheet-col1"><input name="attr_character_name" type="text" placeholder="Character Name"></div>
			</div>
			<div class="sheet-row sheet-row-identity">
				<div class="sheet-cell sheet-col0">Title:</div>
				<div class="sheet-cell sheet-col1"><input name="attr_title_name" type="text" placeholder="Title"></div>
			</div>
			<div class="sheet-row sheet-row-identity">
				<div class="sheet-cell sheet-col0">Religion:</div>
				<div class="sheet-cell sheet-col1"><input name="attr_religion_name" type="text" placeholder="Religion"></div>
			</div>
		</div>
	</div>
	<div class="sheet-box sheet-player">
		<div class="sheet-table">
			<div class="sheet-header sheet-header-player">
				<div class="sheet-cell sheet-col0">Player Information</div>
			</div>
			<div class="sheet-row sheet-row-player">
				<div class="sheet-cell sheet-col0">Player:</div>
				<div class="sheet-cell sheet-col1"><input name="attr_player_name" type="text" placeholder="Player Name"></div>
			</div>
			<div class="sheet-row sheet-row-player">
				<div class="sheet-cell sheet-col0">Campaign:</div>
				<div class="sheet-cell sheet-col1"><input name="attr_campaign_name" type="text" placeholder="Campaign"></div>
			</div>
			<div class="sheet-row sheet-row-player">
				<div class="sheet-cell sheet-col0">Created On:</div>
				<div class="sheet-cell sheet-col1"><input name="attr_creation_date" type="text" placeholder="date" /></div>
			</div>
		</div>
	</div>
	<div class="sheet-box sheet-description">
		<div class="sheet-table">
			<div class="sheet-header sheet-header-description">
				<div class="sheet-cell sheet-col0">Description</div>
			</div>
			<div class="sheet-row sheet-row-descr">
				<div class="sheet-cell sheet-col0">Race:</div>
				<div class="sheet-cell sheet-col1"><input type="text" name="attr_race" placeholder="Race" /></div>
				<div class="sheet-cell sheet-col2">Height:</div>
				<div class="sheet-cell sheet-col3"><input type="text" name="attr_height" placeholder="0" /></div>
				<div class="sheet-cell sheet-col4">Hair:</div>
				<div class="sheet-cell sheet-col5"><input type="text" name="attr_hair" placeholder="Hair" /></div>
			</div>
			<div class="sheet-row sheet-row-descr">
				<div class="sheet-cell sheet-col0">Gender:</div>
				<div class="sheet-cell sheet-col1"><input type="text" name="attr_gender" placeholder="Gender" /></div>
				<div class="sheet-cell sheet-col2">Weight:</div>
				<div class="sheet-cell sheet-col3"><input type="text" name="attr_weight" placeholder="0" /></div>
				<div class="sheet-cell sheet-col4">Eyes:</div>
				<div class="sheet-cell sheet-col5"><input type="text" name="attr_eyes" placeholder="Eyes" /></div>
			</div>
			<div class="sheet-row sheet-row-descr">
				<div class="sheet-cell sheet-col0">Age:</div>
				<div class="sheet-cell sheet-col1"><input type="text" name="attr_age" placeholder="0" /></div>
				<div class="sheet-cell sheet-col2">Size:</div>
				<div class="sheet-cell sheet-col3"><input type="text" name="attr_SM" placeholder="0" /></div>
				<div class="sheet-cell sheet-col4">Skin:</div>
				<div class="sheet-cell sheet-col5"><input type="text" name="attr_skin" placeholder="Skin" /></div>
			</div>
			<div class="sheet-row sheet-row-descr-bottom">
				<div class="sheet-cell sheet-col0">Birthday:</div>
				<div class="sheet-cell sheet-col1"><input type="text" name="attr_birthdate" placeholder="Date" /></div>
				<div class="sheet-cell sheet-col2">TL:</div>
				<div class="sheet-cell sheet-col3"><input type="text" name="attr_tl" placeholder="0" /></div>
				<div class="sheet-cell sheet-col4">Hand:</div>
				<div class="sheet-cell sheet-col5"><input type="text" name="attr_hand" placeholder="Hand" /></div>
			</div>
		</div>
	</div>

	<div class="sheet-box sheet-point-summary">
		<div class="sheet-table">
			<div class="sheet-header sheet-header-point-summary">
				<div class="sheet-cell sheet-col0"><span name="attr_total_points"></span> Points</div>
			</div>
			<div class="sheet-row sheet-row-point-summary">
				<div class="sheet-cell sheet-col0">Race:</div>
				<div class="sheet-cell sheet-col1 sheet-readonly"><span name="attr_racial_points"></span></div>
			</div>
			<div class="sheet-row sheet-row-point-summary">
				<div class="sheet-cell sheet-col0">Attributes:</div>
				<div class="sheet-cell sheet-col1 sheet-readonly"><span name="attr_att_points"></span></div>
			</div>
			<div class="sheet-row sheet-row-point-summary">
				<div class="sheet-cell sheet-col0">Advantages:</div>
				<div class="sheet-cell sheet-col1 sheet-readonly"><span name="attr_advantages_points"></span></div>
			</div>
			<div class="sheet-row sheet-row-point-summary">
				<div class="sheet-cell sheet-col0">Disadvantages:</div>
				<div class="sheet-cell sheet-col1 sheet-readonly"><span name="attr_disadvantages_points"></span></div>
			</div>
			<div class="sheet-row sheet-row-point-summary">
				<div class="sheet-cell sheet-col0">Quirks:</div>
				<div class="sheet-cell sheet-col1 sheet-readonly"><span name="attr_quirks_points"></span></div>
			</div>
			<div class="sheet-row sheet-row-point-summary">
				<div class="sheet-cell sheet-col0">Skills:</div>
				<div class="sheet-cell sheet-col1 sheet-readonly"><span name="attr_skillstechniques_points"></span></div>
			</div>
			<div class="sheet-row sheet-row-point-summary">
				<div class="sheet-cell sheet-col0">Spells:</div>
				<div class="sheet-cell sheet-col1 sheet-readonly"><span name="attr_spells_points"></span></div>
			</div>
			<div class="sheet-row sheet-row-point-summary-unspent">
				<div class="sheet-cell sheet-col0">Unspent Pts:</div>
				<div class="sheet-cell sheet-col1 sheet-readonly"><span name="attr_unspentpoints"></span></div>
			</div>
		</div>
	</div>

</div>	
</div>	
	
	<div class="sheet-box sheet-status-bar">
		<div class="sheet-header sheet-header-status">

			<div class="sheet-cell sheet-current-move">
				<div class="sheet-popup">Move</div><span class="sheet-tooltip">Current Move</span>
			</div>
			<div class="sheet-cell sheet-current-dodge">
				<div class="sheet-popup">Dodge</div><span class="sheet-tooltip">Current Dodge</span>
			</div>
			<div class="sheet-cell sheet-current-enc">
				<div class="sheet-popup">Encumbrance</div><span class="sheet-tooltip">Current Encumbrance</span>

			</div>
			<div class="sheet-cell sheet-current-hp">
				<div class="sheet-popup">Hit Points</div><span class="sheet-tooltip">Current HP</span>
			</div>
			<div class="sheet-cell sheet-current-fat">
				<div class="sheet-popup">Fatigue</div><span class="sheet-tooltip">Current FP</span>
			</div>
			<div class="sheet-cell sheet-current-conditions">
				<div class="sheet-popup">Conditions</div><span class="sheet-tooltip">Current Afflictions</span>
			</div>
		</div>

		<div class="sheet-row sheet-row-status sheet-readonly">
			<div class="sheet-cell sheet-current-move">
				<span name="attr_current_move"></span>
			</div>
			<div class="sheet-cell sheet-current-dodge">
				<span name="attr_dodge_esl"></span>
			</div>
			<input type="hidden" value="0" name="attr_encumbrance_level" class="sheet-encumbrance" />
			<div class="sheet-cell sheet-current-enc sheet-overweight">
				<span name="attr_encumbrance_name"></span>
			</div>
			<div class="sheet-cell sheet-current-hp">
				<span name="attr_hit_points"></span>
			</div>
			<div class="sheet-cell sheet-current-fat">
				<span name="attr_fatigue_points"></span>
			</div>
			<div class="sheet-cell sheet-current-conditions">
				<span name="attr_current_conditions"></span>
			</div>
		</div>
	</div>
	
	<!-- ===== ===== ===== ===== TABS ===== ===== ===== ===== -->
	<input type="radio" name="attr_tab" value="1" class="sheet-tab sheet-tab1" checked="checked" /><span>General</span>
	<input type="radio" name="attr_tab" value="2" class="sheet-tab sheet-tab2" /><span>Traits</span>
	<input type="radio" name="attr_tab" value="3" class="sheet-tab sheet-tab3" /><span>Skills</span>
	<input type="radio" name="attr_tab" value="4" class="sheet-tab sheet-tab4" /><span>Combat</span>
	<input type="radio" name="attr_tab" value="5" class="sheet-tab sheet-tab5" /><span>Inventory</span>
	<input type="radio" name="attr_tab" value="6" class="sheet-tab sheet-tab6" /><span>Grimoire</span>
	<input type="radio" name="attr_tab" value="7" class="sheet-tab sheet-tab7" /><span>Rituals</span>
	<input type="radio" name="attr_tab" value="8" class="sheet-tab sheet-tab8" /><span>Notes</span>
	<input type="radio" name="attr_tab" value="0" class="sheet-tab sheet-tab0" /><span title="Sheet Options">y</span>
	<div class="sheet-tab-br"></div>

	<!-- ===== ===== ===== ===== GENERAL TAB ===== ===== ===== ===== -->
	<div class="sheet-tab1">

		<!-- _____ _____ ATTRIBUTE BOX _____ _____ -->
		<div class="sheet-box sheet-attribute">
			<div class="sheet-table">
				<div class="sheet-header">
					<div class="sheet-cell sheet-col0">Attributes</div>
					<div class="sheet-cell sheet-col1">
						<div class="sheet-popup">Mod</div>
						<span class="sheet-tooltip">
							A modifier that will be applied to your attribute.
							<br />
							All derived attributes draw their base from
							your<br />
							unmodified attributes. Therefore this MOD will<br />
							generally only affect direct attribute rolls
							and<br />
							skills rolls.
						</span>
					</div>
					<div class="sheet-cell sheet-col2">Pts</div>
				</div> <!-- .sheet-header -->
				<div class="sheet-main-attribute">
					<div class="sheet-row sheet-row-strength">
						<div class="sheet-cell sheet-col0">
							<div class="sheet-popup">Strength (ST):</div>
							<span class="sheet-tooltip">
								Strength
								<br />
								10pts/level
								<br />
								Unmodified <span name="attr_strength_base">
									<div class="sheet-cell sheet-col2">
							<input type="number" name="attr_strength_mod" value="0" step="1" />
						</div>
						<div class="sheet-cell sheet-col3">
							<input type="number" name="attr_strength_points" value="0" step="10" />
						</div>
								</span>
							</span>
						</div>
						<div class="sheet-cell sheet-col1 sheet-readonly">
							<input type="text" name="attr_strength" value="10" readonly="readonly" />
							<input type="hidden" name="attr_strength" value="10"/>
						</div>
						
						<div class="sheet-cell sheet-col4">
							<button class="sheet-roll-button" type="roll" name="attr_ST_roll" value="!attr @{character_id} Strength [[@{strength} + @{modifier} + @{STRoll_mod}]]"></button>
						</div>
					</div> <!-- .sheet-row -->
					<div class="sheet-row sheet-row-dexterity">
						<div class="sheet-cell sheet-col0">
							<div class="sheet-popup">Dexterity (DX):</div>
							<span class="sheet-tooltip">
								Dexterity
								<br />
								20pts/level
								<br />
								Unmodified: <span name="attr_dexterity_base"></span>
							</span>
						</div>
						<div class="sheet-cell sheet-col1 sheet-readonly">
							<input name="attr_dexterity" value="10" readonly="readonly" /><input type="hidden" name="attr_dexterity" value="10"/>
						</div>
						<div class="sheet-cell sheet-col2">
							<input type="number" name="attr_dexterity_mod" value="0" step="1" />
						</div>
						<div class="sheet-cell sheet-col3">
							<input type="number" name="attr_dexterity_points" value="0" step="20" />
						</div>
						<div class="sheet-cell sheet-col4">
							<button class="sheet-roll-button" type="roll" name="attr_DX_roll" value="!attr @{character_id} Dexterity [[@{dexterity} + @{modifier} + @{DXRoll_mod}]]"></button>
						</div>
					</div> <!-- .sheet-row -->
					<div class="sheet-row sheet-row-intelligence">
						<div class="sheet-cell sheet-col0">
							<div class="sheet-popup">Intelligence (IQ):</div>
							<span class="sheet-tooltip">
								Intelligence
								<br />
								20pts/level
								<br />
								Unmodified: <span name="attr_intelligence_base"></span>
							</span>
						</div>
						<div class="sheet-cell sheet-col1 sheet-readonly">
							<input name="attr_intelligence" value="10" readonly="readonly" /><input type="hidden" name="attr_intelligence" value="10"/>
						</div>
						<div class="sheet-cell sheet-col2">
							<input type="number" name="attr_intelligence_mod" value="0" step="1" />
						</div>
						<div class="sheet-cell sheet-col3">
							<input type="number" name="attr_intelligence_points" value="0" step="20" />
						</div>
						<div class="sheet-cell sheet-col4">
							<button class="sheet-roll-button" type="roll" name="attr_IQ_roll" value="!attr @{character_id} Intelligence [[@{intelligence} + @{modifier} + @{IQRoll_mod}]]"></button>
						</div>
					</div> <!-- .sheet-row -->
					<div class="sheet-row sheet-row-health">
						<div class="sheet-cell sheet-col0">
							<div class="sheet-popup">Health (HT):</div>
							<span class="sheet-tooltip">
								Health
								<br />
								10pts/level
								<br />
								Unmodified: <span name="attr_health_base"></span>
							</span>
						</div>
						<div class="sheet-cell sheet-col1 sheet-readonly">
							<input name="attr_health" value="10" readonly="readonly" /><input type="hidden" name="attr_health" value="10"/>
						</div>
						<div class="sheet-cell sheet-col2">
							<input type="number" name="attr_health_mod" value="0" step="1" />
						</div>
						<div class="sheet-cell sheet-col3">
							<input type="number" name="attr_health_points" value="0" step="10" />
						</div>
						<div class="sheet-cell sheet-col4">
							<button class="sheet-roll-button" type="roll" name="attr_HT_roll" value="!attr @{character_id} Health [[@{health} + @{modifier} + @{HTRoll_mod}]]"></button>
						</div>
					</div> <!-- .sheet-row -->
				</div>
				<div class="sheet-row sheet-row-willpower sheet-hr">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Will:</div>
						<span class="sheet-tooltip">
							Willpower
							<br />
							Based on Intelligence
							<br />
							5pts/level
							<br />
							Unmodified: <span name="attr_willpower_base"></span>
						</span>
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">
						<input name="attr_willpower" value="10" readonly="readonly" />
					</div>
					<div class="sheet-cell sheet-col2">
						<input type="number" name="attr_willpower_mod" value="0" step="1" />
					</div>
					<div class="sheet-cell sheet-col3">
						<input type="number" name="attr_willpower_points" value="0" step="5" />
					</div>
					<div class="sheet-cell sheet-col4">
						<button class="sheet-roll-button" type="roll" name="attr_Will" value="!attr @{character_id} Willpower [[@{willpower} + @{modifier}]]"></button>
					</div>
				</div> <!-- .sheet-row -->
				<div class="sheet-row sheet-row-fear">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Fright Check:</div>
						<span class="sheet-tooltip">
							Fright Check
							<br />
							Based on Willpower
							<br />
							2pts/level
							<br />
							Unmodified: <span name="attr_fear_check_base"></span>
						</span>
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">
						<input name="attr_fear_check" value="10" readonly="readonly" />
					</div>
					<div class="sheet-cell sheet-col2">
						<input type="number" name="attr_fear_check_mod" value="0" step="1" />
					</div>
					<div class="sheet-cell sheet-col3">
					</div>
					<div class="sheet-cell sheet-col4">
						<button class="sheet-roll-button" type="roll" name="attr_Fright" value="!fear @{character_id} ?{Roll Type|Fear |Awe |Confusion } [[@{fear_check} + @{modifier}]] @{fright_check_threshold}"></button>
					</div>
				</div> <!-- .sheet-row -->
				<div class="sheet-row sheet-row-fear">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Threshold:</div>
						<span class="sheet-tooltip">
							Fright Check Threshold
							<br />
							If final modified fright check exceeds threshold,<br/> 
							then reduce modified fright check to threshold level.
							<br />
							Can be modifed by Brave, Rule of 15, etc.
						</span>
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">
						<input type="number" name="attr_fright_check_threshold" value="13" readonly="readonly" >
					</div>
					<div class="sheet-cell sheet-col2">
						<input type="number" name="attr_fright_check_threshold_mod" value="0" step="1" />
					</div>
					<div class="sheet-cell sheet-col3">
						&nbsp;
					</div>
					<div class="sheet-cell sheet-col4">
						&nbsp;
					</div>
						
				</div>
				<div class="sheet-row sheet-row-basic-speed sheet-hr">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Basic Speed</div>
						<span class="sheet-tooltip">
							Basic Speed
							<br />
							Based on Health and Dexterity
							<br />
							5pts/0.25
							<br />
							Unmodified: <span name="attr_basic_speed_base"></span>
						</span>
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">
						<input name="attr_basic_speed" value="0" readonly="readonly" />
					</div>
					<div class="sheet-cell sheet-col2">
						<input type="number" name="attr_basic_speed_mod" value="0" step="0.25" />
					</div>
					<div class="sheet-cell sheet-col3">
						<input type="number" name="attr_basic_speed_points" value="0" step="5" />
					</div>
					<div class="sheet-cell sheet-col4">
						<button class="sheet-roll-tracker" type="roll" value="!power --name|Initiative --Init: |@{character_name} [[@{basic_speed} &{tracker:=}]]" name="roll_Init"></button>
					</div>
				</div> <!-- .sheet-row -->
				<div class="sheet-row sheet-row-basic-move">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Basic Move</div>
						<span class="sheet-tooltip">
							Basic Move
							<br />
							Based on Basic Speed
							<br />
							5pts/level
							<br />
							Unmodified: <span name="attr_basic_move_base"></span>
						</span>
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">
						<input name="attr_basic_move" value="0" readonly="readonly" />
					</div>
					<div class="sheet-cell sheet-col2">
						<input type="number" name="attr_basic_move_mod" value="0" step="1" />
					</div>
					<div class="sheet-cell sheet-col3">
						<input type="number" name="attr_basic_move_points" value="0" />
					</div>
				</div> <!-- .sheet-row -->
				<div class="sheet-row sheet-row-basic-move">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Enhanced Move</div>
						<span class="sheet-tooltip">
							Enhanced ground move. 
							<br />
							10pts per half level.
							<br />
							Level: <span name="attr_enhanced_ground_move_multiple"></span>
						</span>
					</div>
					<div class="sheet-cell sheet-col1">
						<input type="number" name="attr_enhanced_ground_move" value="0" readonly="readonly">
					</div>
					<div class="sheet-cell sheet-col2">
						<input type="number" name="attr_enhanced_ground_move_mod" value="0" step=".5" class="editable" />
					</div>
					<div class="sheet-cell sheet-col3">
						<input type="hidden" name="attr_enhanced_ground_move_points" value="0" />
					</div>
				</div> <!-- .sheet-row -->
				<div class="sheet-row sheet-row-perception sheet-hr">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Perception:</div>
						<span class="sheet-tooltip">
							Perception
							<br />
							Based on Intelligence
							<br />
							5pts/level
							<br />
							Unmodified: <span name="attr_perception_base"></span>
						</span>
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">
						<input name="attr_perception" value="10" readonly="readonly" />
					</div>
					<div class="sheet-cell sheet-col2">
						<input type="number" name="attr_perception_mod" value="0" step="1" />
					</div>
					<div class="sheet-cell sheet-col3">
						<input type="number" name="attr_perception_points" value="0" step="5" />
					</div>
					<div class="sheet-cell sheet-col4">
						<button class="sheet-roll-button" type="roll" name="attr_Per" value="!attr @{character_id} Perception [[@{perception} + @{modifier}]]"></button>
					</div>
				</div> <!-- .sheet-row -->
				<div class="sheet-row sheet-row-perception">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Vision</div>
						<span class="sheet-tooltip">
							Visual Perception
							<br />
							Based on Perception
							<br />
							2pts/level
							<br />
							Unmodified: <span name="attr_vision_base" ></span>
						</span>
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">
						<input name="attr_vision" value="10" readonly="readonly" />
						<input type="hidden" name="attr_vision_name" value="Vision" />
					</div>
					<div class="sheet-cell sheet-col2">
						<input type="number" name="attr_vision_mod" value="0" step="1" />
					</div>
					<div class="sheet-cell sheet-col3">
						<input type="hidden" name="attr_vision_points" value="0" step="5">
					</div>
					<div class="sheet-cell sheet-col4">
						<button class="sheet-roll-button" type="roll" name="attr_Vision_roll" value="!attr @{character_id} Vision [[@{vision} + @{modifier}]]"></button>
					</div>
				</div>
				<div class="sheet-row sheet-row-perception">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Hearing</div>
						<span class="sheet-tooltip">
							Audio Perception
							<br />
							Based on Perception
							<br />
							2pts/level
							<br />
							Unmodified: <span name="attr_hearing_base"></span>
						</span>
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">
						<input name="attr_hearing" value="10" readonly="readonly" />
					</div>
					<div class="sheet-cell sheet-col2">
						<input type="number" name="attr_hearing_mod" value="0" step="1" />
					</div>
					<div class="sheet-cell sheet-col3">
						<input type="hidden" name="attr_hearing_points" value="0" step="5">
					</div>
					<div class="sheet-cell sheet-col4">
						<button class="sheet-roll-button" type="roll" name="attr_Hearing_roll" value="!attr @{character_id} Hearing  [[@{hearing} + @{modifier}]]"></button>
					</div>
				</div>
				<div class="sheet-row sheet-row-perception">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Taste & Smell</div>
						<span class="sheet-tooltip">
							Taste & Smell Perception
							<br />
							Based on Perception
							<br />
							2pts/level
							<br />
							Unmodified: <span name="attr_taste_smell_base"></span>
						</span>
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">
						<input name="attr_taste_smell" value="10" readonly="readonly" />
					</div>
					<div class="sheet-cell sheet-col2">
						<input type="number" name="attr_taste_smell_mod" value="0" step="1" />
					</div>
					<div class="sheet-cell sheet-col3">
						<input type="hidden" name="attr_taste_smell_points" value="0" step="5">
					</div>
					<div class="sheet-cell sheet-col4">
						<button class="sheet-roll-button" type="roll" name="attr_TasteSmell" value="!attr @{character_id} Taste_Smell [[@{taste_smell} + @{modifier}]]"></button>
					</div>
				</div>
				<div class="sheet-row sheet-row-perception">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Touch</div>
						<span class="sheet-tooltip">
							Touch Perception
							<br />
							Based on Perception
							<br />
							2pts/level
							<br />
							Unmodified: <span name="attr_touch_base"></span>
						</span>
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">
						<input name="attr_touch" value="10" readonly="readonly" />
					</div>
					<div class="sheet-cell sheet-col2">
						<input type="number" name="attr_touch_mod" value="0" step="1" />
					</div>
					<div class="sheet-cell sheet-col3">
						<input type="hidden" name="attr_touch_points" value="0" step="5">
					</div>
					<div class="sheet-cell sheet-col4">
						<button class="sheet-roll-button" type="roll" name="attr_Touch_roll" value="!attr @{character_id} Touch [[@{touch} + @{modifier}]]"></button>
					</div>
				</div>
				<div class="sheet-row sheet-row-dodge">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Dodge</div>
						<span class="sheet-tooltip">
							Dodge
							<br />
							Based on Basic Speed
							<br />
							Unmodified: <span name="attr_dodge_base"></span>
						</span>
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">
						<input name="attr_dodge" value="0" readonly="readonly" />
					</div>
					<div class="sheet-cell sheet-col2">
						<input type="number" name="attr_dodge_mod" value="0" step="1" />
					</div>
				</div> <!-- .sheet-row -->
				<div class="sheet-row sheet-row-lift-st sheet-hr">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Lifting ST</div>
						<span class="sheet-tooltip">
							Lifting Strength
							<br />
							Based on Strength
							<br />
							3pts/level
							<br />
							Unmodified: <span name="attr_lift_st_base"></span>
						</span>
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">
						<input name="attr_lift_st" value="0" readonly="readonly" />
					</div>
					<div class="sheet-cell sheet-col2">
						<input type="number" name="attr_lift_st_mod" value="0" step="1" />
					</div>
					<div class="sheet-cell sheet-col3">
						&nbsp;
					</div>
				</div> <!-- .sheet-row -->
				<div class="sheet-row sheet-row-strike-st">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Striking ST</div>
						<span class="sheet-tooltip">
							Striking Strength
							<br />
							Based on Strength
							<br />
							5pts/level
							<br />
							Unmodified: <span name="attr_striking_st_base"></span>
						</span>
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">
						<input name="attr_striking_st" value="0" readonly="readonly" />
					</div>
					<div class="sheet-cell sheet-col2">
						<input type="number" name="attr_striking_st_mod" value="0" step="1" />
					</div>
					<div class="sheet-cell sheet-col3">
						&nbsp;
					</div>
				</div> <!-- .sheet-row -->
				<div class="sheet-row sheet-row-basic-damage sheet-hr">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">thr:</div>
						<span class="sheet-tooltip">
							<strong>Thrust Damage</strong>
							<br />
							<div>See page 16 for the complete table.</div>
							<table>
								<thead>
									<tr>
										<th>Strength</th>
										<th>Thrust</th>
									</tr>
								</thead>
								<tbody>
									<tr>
										<td>1</td>
										<td>1d6-6</td>
									</tr>
									<tr>
										<td>2</td>
										<td>1d6-6</td>
									</tr>
									<tr>
										<td>3</td>
										<td>1d6-5</td>
									</tr>
									<tr>
										<td>4</td>
										<td>1d6-5</td>
									</tr>
									<tr>
										<td>5</td>
										<td>1d6-4</td>
									</tr>
									<tr>
										<td>6</td>
										<td>1d6-4</td>
									</tr>
									<tr>
										<td>7</td>
										<td>1d6-3</td>
									</tr>
									<tr>
										<td>8</td>
										<td>1d6-3</td>
									</tr>
									<tr>
										<td>9</td>
										<td>1d6-2</td>
									</tr>
									<tr>
										<td>10</td>
										<td>1d6-2</td>
									</tr>
									<tr>
										<td>11</td>
										<td>1d6-1</td>
									</tr>
									<tr>
										<td>12</td>
										<td>1d6-1</td>
									</tr>
									<tr>
										<td>13</td>
										<td>1d6</td>
									</tr>
								</tbody>
							</table>
							<table>
								<thead>
									<tr>
										<th>Strength</th>
										<th>Thrust</th>
									</tr>
								</thead>
								<tbody>
									<tr>
										<td>14</td>
										<td>1d6</td>
									</tr>
									<tr>
										<td>15</td>
										<td>1d6+1</td>
									</tr>
									<tr>
										<td>16</td>
										<td>1d6+1</td>
									</tr>
									<tr>
										<td>17</td>
										<td>1d6+2</td>
									</tr>
									<tr>
										<td>18</td>
										<td>1d6+2</td>
									</tr>
									<tr>
										<td>19</td>
										<td>2d6-1</td>
									</tr>
									<tr>
										<td>20</td>
										<td>2d6-1</td>
									</tr>
									<tr>
										<td>21</td>
										<td>2d6</td>
									</tr>
									<tr>
										<td>22</td>
										<td>2d6</td>
									</tr>
									<tr>
										<td>23</td>
										<td>2d6+1</td>
									</tr>
									<tr>
										<td>24</td>
										<td>2d6+1</td>
									</tr>
									<tr>
										<td>25</td>
										<td>2d6+2</td>
									</tr>
									<tr>
										<td>26</td>
										<td>2d6+2</td>
									</tr>
								</tbody>
							</table>
						</span>
					</div>
					<div class="sheet-cell sheet-col1">
						<input type="text" name="attr_thrust" value="1d6-2" />
					</div>
					<div class="sheet-cell sheet-col2">
						<button class="sheet-roll-button" type="roll" value="&{template:GURPSBASIC} {{charactername=@{character_name}}} {{roll_type=Thrust}} {{roll=[[@{thrust}]]}}" name="roll_Damage_Thrust" ></button>
					</div>
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">sw:</div>
						<span class="sheet-tooltip">
							<strong>Swing Damage</strong>
							<br />
							<div>See page 16 for the complete table.</div>
							<table>
								<thead>
									<tr>
										<th>Strength</th>
										<th>Swing</th>
									</tr>
								</thead>
								<tbody>
									<tr>
										<td>1</td>
										<td>1d6-5</td>
									</tr>
									<tr>
										<td>2</td>
										<td>1d6-5</td>
									</tr>
									<tr>
										<td>3</td>
										<td>1d6-4</td>
									</tr>
									<tr>
										<td>4</td>
										<td>1d6-4</td>
									</tr>
									<tr>
										<td>5</td>
										<td>1d6-3</td>
									</tr>
									<tr>
										<td>6</td>
										<td>1d6-3</td>
									</tr>
									<tr>
										<td>7</td>
										<td>1d6-2</td>
									</tr>
									<tr>
										<td>8</td>
										<td>1d6-2</td>
									</tr>
									<tr>
										<td>9</td>
										<td>1d6-1</td>
									</tr>
									<tr>
										<td>10</td>
										<td>1d6</td>
									</tr>
									<tr>
										<td>11</td>
										<td>1d6+1</td>
									</tr>
									<tr>
										<td>12</td>
										<td>1d6+2</td>
									</tr>
									<tr>
										<td>13</td>
										<td>2d6-1</td>
									</tr>
								</tbody>
							</table>
							<table>
								<thead>
									<tr>
										<th>Strength</th>
										<th>Swing</th>
									</tr>
								</thead>
								<tbody>
									<tr>
										<td>14</td>
										<td>2d6</td>
									</tr>
									<tr>
										<td>15</td>
										<td>2d6+1</td>
									</tr>
									<tr>
										<td>16</td>
										<td>2d6+2</td>
									</tr>
									<tr>
										<td>17</td>
										<td>3d6-1</td>
									</tr>
									<tr>
										<td>18</td>
										<td>3d6</td>
									</tr>
									<tr>
										<td>19</td>
										<td>3d6+1</td>
									</tr>
									<tr>
										<td>20</td>
										<td>3d6+2</td>
									</tr>
									<tr>
										<td>21</td>
										<td>4d6-1</td>
									</tr>
									<tr>
										<td>22</td>
										<td>4d6</td>
									</tr>
									<tr>
										<td>23</td>
										<td>4d6+1</td>
									</tr>
									<tr>
										<td>24</td>
										<td>4d6+2</td>
									</tr>
									<tr>
										<td>25</td>
										<td>5d6-1</td>
									</tr>
									<tr>
										<td>26</td>
										<td>5d6</td>
									</tr>
								</tbody>
							</table>
						</span>
					</div>
					<div class="sheet-cell sheet-col1">
						<input type="text" name="attr_swing" value="1d6" />
					</div>
					<div class="sheet-cell sheet-col2"><button class="sheet-roll-button" type="roll" value="&{template:GURPSBASIC} {{charactername=@{character_name}}} {{roll_type=Swing}} {{roll=[[@{swing}]]}}" name="roll_Damage_Swing" ></button>
					</div>
				</div> <!-- .sheet-row -->
			</div> <!-- .sheet-table -->
		</div> <!-- .sheet-box .sheet-attributes -->
		<!-- _____ _____ LIFTING BOX _____ _____ -->
		<div class="sheet-box sheet-lifting-new">
			<div class="sheet-table">
				<input type="hidden" value="0" name="attr_encumbrance_level" class="sheet-overweight" />
				<div class="sheet-header sheet-header-lifting-new">
					<div class="sheet-cell sheet-col0">Encumbrance, Move & Dodge
					</div>
				</div>
				<div class="sheet-header sheet-header-lifting-new">
					<div class="sheet-cell sheet-col1">Level</div>
					<div class="sheet-cell sheet-col2">Max Load</div>
					<div class="sheet-cell sheet-col3">Move</div>
					<div class="sheet-cell sheet-col3">Fly</div>
					<div class="sheet-cell sheet-col3">Swim</div>
					<div class="sheet-cell sheet-col4">Dodge</div>
				</div>
				<div class="sheet-row sheet-row-lifting-none">
					<div class="sheet-cell sheet-col1">None (0)</div>
					<div class="sheet-cell sheet-col2 sheet-readonly"><span name="attr_lift_0" ></span><span name="attr_lift0unit"></span></div>
					<div class="sheet-cell sheet-col3 sheet-readonly"><span name="attr_move_0" ></span></div>
					<div class="sheet-cell sheet-col3 sheet-readonly"><span name="attr_air_0" ></span></div>
					<div class="sheet-cell sheet-col3 sheet-readonly"><span name="attr_water_0" ></span></div>
					<div class="sheet-cell sheet-col4 sheet-readonly"><span name="attr_dodge_0" ></span></div>
				</div>
				<div class="sheet-row sheet-row-lifting-light">
					<div class="sheet-cell sheet-col1">Light (1)</div>
					<div class="sheet-cell sheet-col2 sheet-readonly"><span name="attr_lift_1" ></span><span name="attr_lift1unit"></span></div>
					<div class="sheet-cell sheet-col3 sheet-readonly"><span name="attr_move_1" ></span></div>
					<div class="sheet-cell sheet-col3 sheet-readonly"><span name="attr_air_1" ></span></div>
					<div class="sheet-cell sheet-col3 sheet-readonly"><span name="attr_water_1" ></span></div>
					<div class="sheet-cell sheet-col4 sheet-readonly"><span name="attr_dodge_1" ></span></div>
				</div>
				<div class="sheet-row sheet-row-lifting-medium">
					<div class="sheet-cell sheet-col1">Medium (2)</div>
					<div class="sheet-cell sheet-col2 sheet-readonly"><span name="attr_lift_2" ></span><span name="attr_lift2unit"></span></div>
					<div class="sheet-cell sheet-col3 sheet-readonly"><span name="attr_move_2" ></span></div>
					<div class="sheet-cell sheet-col3 sheet-readonly"><span name="attr_air_2" ></span></div>
					<div class="sheet-cell sheet-col3 sheet-readonly"><span name="attr_water_2" ></span></div>
					<div class="sheet-cell sheet-col4 sheet-readonly"><span name="attr_dodge_2" ></span></div>
				</div>
				<div class="sheet-row sheet-row-lifting-heavy">
					<div class="sheet-cell sheet-col1">Heavy (3)</div>
					<div class="sheet-cell sheet-col2 sheet-readonly"><span name="attr_lift_3" ></span><span name="attr_lift3unit"></span></div>
					<div class="sheet-cell sheet-col3 sheet-readonly"><span name="attr_move_3" ></span></div>
					<div class="sheet-cell sheet-col3 sheet-readonly"><span name="attr_air_3" ></span></div>
					<div class="sheet-cell sheet-col3 sheet-readonly"><span name="attr_water_3" ></span></div>
					<div class="sheet-cell sheet-col4 sheet-readonly"><span name="attr_dodge_3" ></span></div>
				</div>
				<div class="sheet-row sheet-row-lifting-xhvy">
					<div class="sheet-cell sheet-col1">X-Heavy (4)</div>
					<div class="sheet-cell sheet-col2 sheet-readonly"><span name="attr_lift_4" ></span><span name="attr_lift4unit"></span></div>
					<div class="sheet-cell sheet-col3 sheet-readonly"><span name="attr_move_4" ></span></div>
					<div class="sheet-cell sheet-col3 sheet-readonly"><span name="attr_air_4" ></span></div>
					<div class="sheet-cell sheet-col3 sheet-readonly"><span name="attr_water_4" ></span></div>
					<div class="sheet-cell sheet-col4 sheet-readonly"><span name="attr_dodge_4" ></span></div>
				</div>
				<div class="sheet-row sheet-row-current-load">
					<div class="sheet-cell sheet-col0">Current Load:</div>
					<div class="sheet-cell sheet-col1 sheet-readonly"><span name="attr_total_weight" ></span><span name="attr_total_weight_unit"></span>
					</div>
					<div class="sheet-cell sheet-col2">Encumbrance Level:</div>
					<div class="sheet-cell sheet-col3 sheet-readonly"><span name="attr_encumbrance_level" class="sheet-overweight" ></span>
					</div>
				</div>
			</div>
		</div>
		<div class="sheet-box sheet-lifting-new">
			<div class="sheet-table">
				<div class="sheet-header sheet-header-moving">
					<div class="sheet-cell sheet-col0">Lifting & Moving Things
					</div>
				</div>
				<div class="sheet-row sheet-row-moving">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Basic Lift:</div><span class="sheet-tooltip">How much you can lift with one
							hand in one second.</span>
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly"><span name="attr_lift_0" ></span><span name="attr_lift0unit"></span>
					</div>
				</div>
				<div class="sheet-row sheet-row-moving">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">One-Handed Lift:</div><span class="sheet-tooltip">One-Handed Lift: takes two
							seconds.</span>
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly"><span name="attr_one_hand_lift" ></span><span name="attr_lift1unit"></span>
					</div>
				</div>
				<div class="sheet-row sheet-row-moving">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Two-Handed Lift:</div><span class="sheet-tooltip">The weight the character can
							lift overhead<br>with both hands in four
							seconds.</span>
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly"><span name="attr_two_hand_lift" ></span><span name="attr_twoHandunit"></span>
					</div>
				</div>
				<div class="sheet-row sheet-row-moving">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Shove &amp; Knock Over:</div>
						<span class="sheet-tooltip">The weight of an object the
							character can shove<br>and knock over.</span>
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly"><span name="attr_shove_lift" ></span><span name="attr_shoveunit"></span>
					</div>
				</div>
				<div class="sheet-row sheet-row-moving">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Running Shove &amp; Knock Over:
						</div><span class="sheet-tooltip">The weight of an
							object the character can shove<br>and knock over
							with a running start.</span>
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly"><span name="attr_run_shove_lift" ></span><span name="attr_shove2unit"></span></div>
				</div>
				<div class="sheet-row sheet-row-moving">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Carry On Back:</div><span class="sheet-tooltip">The weight the character can
							carry slung over his/her back.<br />but every second
							that your encumbrance is over 10x BL (that
							is,<br />Extra-Heavy encumbrance), you lose 1
							FP.</span>
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly"><span name="attr_carry_back_lift" ></span><span name="attr_carryunit"></span></div>
				</div>
				<div class="sheet-row sheet-row-moving">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Shift Slightly:</div><span class="sheet-tooltip">The weight of an object that
							the character<br>can shift slightly on a
							floor.</span>
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly"><span name="attr_shift_lift" ></span><span name="attr_shiftunit"></span>
					</div>
				</div>
			</div>
		</div>
		<div class="box movement-feats">
		    <div class="table">
    		    <div class="header">
    		        <div class="title">Movement Feats</div>
    		    </div>
		    </div>
		    <div class="container-feats">
		        
		        <!-- Flying Feat -->
		        <div class="container-flying feats-child">
    		        <div class="sheet-row sheet-row-flight-advantage">
    				    <div class="column-header">Flying</div>
    				    <div class="sheet-cell sheet-col0 sheet-label">
    						<div class="popup">Flight</div>
    						<div class="tooltip">
    						    Check the box to add Flight (B56) to the character. <br />
    						    This will update the Air movement column for the encumbrance table.<br />
    						    Use the text box to enter the numbrer of character points used for Flight<br />
    						</div>
    					</div>
    					<div class="sheet-cell sheet-col1">
    					    <input type="checkbox" name="attr_flight_checked" value="1" class="sheet-boolean" title="Macro name: flight_checked" />
    					</div>
    					<div class="sheet-cell sheet-col2">
    						&nbsp;
    					</div>
    					<div class="sheet-cell sheet-col3">
    						<input type="number" name="attr_flight_points" value="0" class="editable" title="Macro name: flight_points" />
    					</div>
    				</div> <!-- .sheet-row -->
    				<div class="sheet-row sheet-row-basic-move">
    					<div class="sheet-cell sheet-col0 sheet-label">
    						<div class="sheet-popup">Air Mv</div>
    						<span class="sheet-tooltip">
    							Base Air Move = Basic Speed * 2 = <input class="sheet-inline" type="number" name="attr_basic_air_move_unmodified" readonly="readonly">
    							<br />
    							2pts/level, you can use up and down arrows
    						</span>
    					</div>
    					<div class="sheet-cell sheet-col1">
    						<input type="number" name="attr_basic_air_move" value="0" readonly="readonly" title="Macro name: basic_air_move" />
    					</div>
    					<div class="sheet-cell sheet-col2">
    						<input type="number" name="attr_basic_air_move_mod" value="0" step="1" class="editable" title="Macro name: basic_air_move_mod" />
    					</div>
    					<div class="sheet-cell sheet-col3">
    						<input type="number" name="attr_basic_air_move_points" value="0" step="2" class="editable" title="Macro name: basic_air_move_points" />
    					</div>
    				</div> <!-- .sheet-row -->
    				<div class="sheet-row margin-bottom sheet-row-enhanced-air">
    					<div class="sheet-cell sheet-col0 sheet-label">
    						<div class="sheet-popup">Enhncd</div>
    						<span class="sheet-tooltip">
    							Enhanced Air Move<br />
    							Modifier box: steps of .5, you can use up and down arrows.<br />
    							Points box: 10 points per half-level, you can use up and down arrows.<br />
    							Each level doubles top air move. Half-level is a multiple of 1.5.<br />
    							Level: <span name="attr_enhanced_air_move_level" value="0"></span>
    						</span>
    					</div>
    					<div class="sheet-cell sheet-col1">
    						<input type="number" name="attr_enhanced_air_move" value="0" readonly="readonly" title="Macro name: enhanced_air_move" />
    					</div>
    					<div class="sheet-cell sheet-col2">
    					    <input type="number" name="attr_enhanced_air_level" value="0" step=".5" class="editable" title="Macro name: enhanced_air_level" />
    					</div>
    					<div class="sheet-cell sheet-col3">
    						<input type="number" name="attr_enhanced_air_move_points" value="0" step="10" class="editable" title="Macro name: enhanced_air_move_points" />
    					</div>
    				</div> <!-- .sheet-row -->
				</div> <!-- .container-swimming -->
				
				<!-- Swimming Feat -->
				<div class="container-swimming feats-child">
    				<div class="sheet-row sheet-row-flight-advantage">
    				    <div class="column-header">Swimming</div>
    				    <div class="sheet-cell sheet-col0 sheet-label">
    						<div class="sheet-popup">Amphib</div>
    						<div class="tooltip">
    						    Amphibious: Check the box to apply Amphibious (B40) to character<br />
    						    This will update the swimming movement on the encumbrance table.<br />
    						</div>
    					</div>
    					<div class="sheet-cell sheet-col1">
    					    <input type="checkbox" name="attr_amphibious_checked" value="1" class="sheet-boolean" title="Macro name: amphibious_checked" />
    					</div>
    					<div class="sheet-cell sheet-col2">
    						&nbsp;
    					</div>
    					<div class="sheet-cell sheet-col3">
    						<input type="number" name="attr_amphibious_points" value="0" class="editable" title="Macro name: amphibious_points" />
    					</div>
    				</div> <!-- .sheet-row -->
    				<div class="sheet-row sheet-row-basic-move">
    					<div class="sheet-cell sheet-col0 sheet-label">
    						<div class="sheet-popup">Wtr Mv</div>
    						<span class="sheet-tooltip">
    							Basic Move = <input class="sheet-inline" type="number" name="attr_basic_water_move_unmodified" readonly="readonly" /><br />
    							Formula = Basic Move / 5 or Basic Move if amphibious.<br />
    							5pts/level, you can use up and down arrows.<br />
    							NOTE: Max +2 water move if you have swimming skill.<br />
    						</span>
    					</div>
    					<div class="sheet-cell sheet-col1">
    						<input type="number" name="attr_basic_water_move" value="0" readonly="readonly" title="Macro name: basic_water_move" />
    					</div>
    					<div class="sheet-cell sheet-col2">
    						<input type="number" name="attr_basic_water_move_mod" value="0" step="1" class="editable" title="Macro name: basic_water_move_mod" />
    					</div>
    					<div class="sheet-cell sheet-col3">
    						<input type="number" name="attr_basic_water_move_points" value="0" step="5" class="editable" title="Macro name: basic_water_move_points" />
    					</div>
    				</div> <!-- .sheet-row -->
    				<div class="sheet-row margin-bottom sheet-row-enhanced-water">
    					<div class="sheet-cell sheet-col0 sheet-label">
    						<div class="sheet-popup">Enhncd</div>
    						<span class="sheet-tooltip">
    							Enhanced Water Move<br />
    							Modifier box: steps of .5, you can use up and down arrows.<br />
    							Points box: 10 points per half-level, you can use up and down arrows.<br />
    							Each level doubles top water move. Half-level is a multiple of 1.5.<br />
    							Level: <span name="attr_enhanced_water_move_level" value="0"></span>
    						</span>
    					</div>
    					<div class="sheet-cell sheet-col1">
    						<input type="number" name="attr_enhanced_water_move" value="0" readonly="readonly" title="Macro name: enhanced_water_move" />
    					</div>
    					<div class="sheet-cell sheet-col2">
    					    <input type="number" name="attr_enhanced_water_level" value="0" step=".5" class="editable" title="Macro name: enhanced_water_level" />
    					</div>
    					<div class="sheet-cell sheet-col3">
    						<input type="number" name="attr_enhanced_water_move_points" value="0" step="10" class="editable" title="Macro name: enhanced_water_move_points" />
    					</div>
    				</div> <!-- .sheet-row -->
				</div> <!-- .container-swimming -->
				
				<!-- Jumping Feat -->
		        <div class="container-jumping feats-child">
		            
		            <div class="sheet-row sheet-row-flight-advantage">
    				    <div class="column-header">Jumping</div>
    				    <div class="sheet-cell sheet-col0 sheet-label">
    						<div class="sheet-popup">Skill</div>
    						<span class="sheet-tooltip">
								Jump Skill: If entered, automatically calculates using Jump Skill/2 (rounded down) instead of Basic Move to calculate jumping distances. B352
    						</span>
    					</div>
    					<div class="sheet-cell sheet-col1">
    					    <input type="text" name="attr_jump_skill" value="" class="editable" title="Macro name: jump_skill" />
    					</div>
    					<div class="sheet-cell sheet-col2">
    						&nbsp;
    					</div>
    					<div class="sheet-cell sheet-col3">
    					    &nbsp;
    					</div>
    				</div> <!-- .sheet-row -->
    				<div class="sheet-row sheet-row-basic-move">
    					<div class="sheet-cell sheet-col0 sheet-label">
    						<div class="sheet-popup">Use ST</div>
    						<span class="sheet-tooltip">
    							Check this box if using this <strong>Optional Rule</strong> B352.
								<br />
								If Basic Lift (<input type="text" name="attr_display_jump_basic_lift" value="@{simple_lift}" disabled="disabled" class="textInline" />) > body weight, use ST/4 instead of Move or Jump skill.
								<br />
    						</span>
    					</div>
    					<div class="sheet-cell sheet-col1">
    						<input type="checkbox" name="attr_use_st_for_jump" value="1" class="sheet-boolean" title="Macro name: use_st_for_jump" />
    					</div>
    					<div class="sheet-cell sheet-col2">
                            &nbsp;
    					</div>
    					<div class="sheet-cell sheet-col3">
    						&nbsp;
    					</div>
    				</div> <!-- .sheet-row -->
    				<div class="sheet-row sheet-row-enhanced-air">
    					<div class="sheet-cell sheet-col0 sheet-label">
    						<div class="sheet-popup">Super</div>
    						<span class="sheet-tooltip">
    							Super Jump: use this if you have the Super Jump as an Advantage. B89<br />
								<strong>1st column</strong> will show your modifier based on the entries for the 2nd and 3rd columns. <br />
								<strong>2nd column</strong> is the Modifier box: steps of 1, you can use the up and down arrows to change the value. <br />
								<strong>3rd column</strong> is the Points box: 10points per level, you can use the up and down arrows to change the value. Each level doubles the jump distance. <br />
    						</span>
    					</div>
    					<div class="sheet-cell sheet-col1">
    						<input type="number" name="attr_super_jump_level" value="0" readonly="readonly" title="Macro name: super_jump_level" />
    					</div>
    					<div class="sheet-cell sheet-col2">
    					    <input type="number" name="attr_super_jump_entered_level" value="0" step="1" class="editable" title="Macro name: super_jump_entered_level" />
    					</div>
    					<div class="sheet-cell sheet-col3">
    						<input type="number" name="attr_super_jump_points" value="0" step="10" class="editable" title="Macro name: super_jump_points" />
    					</div>
    				</div> <!-- .sheet-row -->
    				<div class="sheet-row sheet-row-basic-move">
    					<div class="sheet-cell sheet-col0 sheet-label">
    						<div class="sheet-popup">Enc</div>
    						<span class="sheet-tooltip">
    						    Apply encumbrance penalty. See B352<br />
    						    1 for None, 0.8 for Light, 0.6 for Medium, 0.4 for Heavy, and 0.2 for Extra-Heavy.
    						</span>
    					</div>
    					<div class="sheet-cell sheet-col1">
    						<input type="checkbox" name="attr_jump_encumbrance" value="1" class="sheet-boolean" />
    					</div>
    					<div class="sheet-cell sheet-col2 title">&nbsp;</div>
    					<div class="sheet-cell sheet-col3 title">&nbsp;</div>
    				</div> <!-- .sheet-row -->
    				<div class="sheet-row sheet-row-basic-move">
    					<div class="sheet-cell sheet-col0 sheet-label">
    						<div class="sheet-popup">Prep</div>
    						<span class="sheet-tooltip">
								Check this box if you took 2 consecutive Concentration maneuvers to prepare. <br />
								Leave unchecked otherwise, in which case you will halve all jump distances. B352
    						</span>
    					</div>
    					<div class="sheet-cell sheet-col1">
    						<input type="checkbox" name="attr_jump_concentration" value="1" class="sheet-boolean" title="Macro name: jump_concentration" />
    					</div>
    					<div class="sheet-cell sheet-col2 title">
                            feet
    					</div>
    					<div class="sheet-cell sheet-col3 title">
    						yards
    					</div>
    				</div> <!-- .sheet-row -->
    				<div class="sheet-row sheet-row-basic-move">
    					<div class="sheet-cell sheet-col0 sheet-label">
    						<div class="sheet-popup">Broad</div>
    						<span class="sheet-tooltip">
    							Standing Broad Jump Distance. B352<br />
								<strong>1st column</strong> will either show be (2 x Stat to use) – 3 feet or your Jump Skill/2 (rounded down). <br />
								<strong>2nd column</strong> shows you how many feet you may jump. <br />
								<strong>3rd column</strong> shows you how many yards you jump. <br />
    							Formula = (2 x Stat To use) - 3 feet<br />
    					 		Stat to use: <input type="text" name="attr_standing_broad_jump_stat_to_use" value="" readonly="readonly" class="textInline width-wide" /><br />
    						</span>
    					</div>
    					<div class="sheet-cell sheet-col1">
    						<input type="text" name="attr_broad_jump_base" value="0" readonly="readonly" title="Macro name: broad_jump_base" />
    					</div>
    					<div class="sheet-cell sheet-col2">
    						<input type="text" name="attr_broad_jump_distance_feet" value="0" readonly="readonly" title="Macro name: broad_jump_distance_feet" />
    					</div>
    					<div class="sheet-cell sheet-col3">
                        	<input type="text" name="attr_broad_jump_distance_yards" value="0" readonly="readonly" title="Macro name: broad_jump_distance_yards" />
    					</div>
    				</div> <!-- .sheet-row -->
    				<div class="sheet-row sheet-row-basic-move">
    					<div class="sheet-cell sheet-col0 sheet-label">
    						<div class="sheet-popup">Run</div>
    						<span class="sheet-tooltip">
    							Running Broad Jump Distance, under Broad Jump decryption. B352 <br />
								<strong>1st column</strong> enter in your (2 x Stat to use) plus how may yards you ran this turn. <br />
								<strong>2nd column</strong> shows you how many feet you may jump. <br />
								<strong>3rd column</strong> shows you how many yard you jump. <br />
    							Formula = (2 x Stat To use) - 3 feet<br />
    					 		Stat to use: <input type="text" name="attr_running_broad_jump_stat_to_use" value="" readonly="readonly" class="textInline width-wide" /><br />
    							Max running broad jump distance is twice standing broad jump distance.<br />
    						</span>
    					</div>
    					<div class="sheet-cell sheet-col1">
    						<input type="number" step="1" name="attr_running_jump_yards_moved" value="0" class="editable" title="Macro name: running_jump_yards_moved" />
    					</div>
    					<div class="sheet-cell sheet-col2">
    						<input type="text" name="attr_running_jump_distance_feet" value="0" readonly="readonly" title="Macro name: running_jump_distance_feet" />
    					</div>
    					<div class="sheet-cell sheet-col3">
                        	<input type="text" name="attr_running_jump_distance_yards" value="0" readonly="readonly" title="Macro name: running_jump_distance_yards" />
    					</div>
    				</div> <!-- .sheet-row -->
    				<div class="sheet-row sheet-row-basic-move">
    					<div class="sheet-cell sheet-col0 sheet-label">
    						<div class="sheet-popup">High</div>
    						<span class="sheet-tooltip">
    							High Jump Distance. B352<br />
    							<strong>1st column</strong> will either be (6 x Stat to use) – 10 inches or your Jump Skill/2 (rounded down). <br />
								<strong>2nd column</strong> shows you how many feet you may jump. <br />
								<strong>3rd column</strong> shows you how many yard you jump. <br />
    							Formula = (6 x Stat To use) - 10 inches<br />
    					 		Stat to use: <input type="text" name="attr_standing_high_jump_stat_to_use" value="" readonly="readonly" class="textInline width-wide" />
    						</span>
    					</div>
    					<div class="sheet-cell sheet-col1">
    						<input type="text" name="attr_high_jump_base" value="0" readonly="readonly" title="Macro name: high_jump_base" />
    					</div>
    					<div class="sheet-cell sheet-col2">
    						<input type="text" name="attr_high_jump_distance_feet" value="0" readonly="readonly" title="Macro name: high_jump_distance_feet" />
    					</div>
    					<div class="sheet-cell sheet-col3">
                        	<input type="text" name="attr_high_jump_distance_yards" value="0" readonly="readonly" title="Macro name: high_jump_distance_yards" />
    					</div>
    				</div> <!-- .sheet-row -->
    				<div class="sheet-row sheet-row-basic-move">
    					<div class="sheet-cell sheet-col0 sheet-label">
    						<div class="sheet-popup">Run</div>
    						<span class="sheet-tooltip">
    							Running High Jump Distance, under High Jump. B352.<br />
								<strong>1st column</strong> enter in your (6 x Stat To use) plus how may yards you ran this turn. <br />
								<strong>2nd column</strong> shows how many feet you may jump straight up. <br />
								<strong>3rd column</strong> shows how many yards you jump straight up. <br />
    							Formula = (6 x Stat To use) - 10 inches<br />
    					 		Stat to use: <input type="text" name="attr_running_high_jump_stat_to_use" value="" readonly="readonly" class="textInline width-wide" /><br />
    							Max running high jump distance is twice standing high jump distance.<br />
    						</span>
    					</div>
    					<div class="sheet-cell sheet-col1">
    						<input type="number" step="1" name="attr_running_high_jump_yards_moved" value="0" class="editable" title="Macro name: running_high_jump_yards_moved" />
    					</div>
    					<div class="sheet-cell sheet-col2">
    						<input type="text" name="attr_running_high_jump_distance_feet" value="0" readonly="readonly" title="Macro name: running_high_jump_distance_feet" />
    					</div>
    					<div class="sheet-cell sheet-col3">
                        	<input type="text" name="attr_running_high_jump_distance_yards" value="0" readonly="readonly" title="Macro name: running_high_jump_distance_yards" />
    					</div>
    				</div> <!-- .sheet-row -->
    				<div class="sheet-row margin-bottom sheet-row-jump-move">
    					<div class="sheet-cell sheet-col0 sheet-label">
    						<div class="sheet-popup">JMP MV</div>
    						<span class="sheet-tooltip">
    							Jump move. This is actually the ‘Super Jump’ value for that Advantage. See B89<br />
    							Greater of Broad Jump Yards / 5 OR Normal Ground Move.<br />
    						</span>
    					</div>
    					<div class="sheet-cell sheet-col1">
    						<input type="text" name="attr_jump_move_speed" value="0" readonly="readonly" title="Macro name: jump_move_speed" />
    					</div>
    					<div class="sheet-cell sheet-col2">
                        	&nbsp;
    					</div>
    					<div class="sheet-cell sheet-col3">
    						&nbsp;
    					</div>
    				</div> <!-- .sheet-row -->
		            
		        </div> <!-- .container-jumping -->
		        
		    </div>
		</div>


		<div class="sheet-box sheet-stats">
			<div class="sheet-table">
				<div class="sheet-header sheet-header-stats">
					<div class="sheet-cell sheet-col0">FP /HP</div>
					<div class="sheet-cell sheet-col1">Value</div>
					<div class="sheet-cell sheet-col2">Mod</div>
					<div class="sheet-cell sheet-col3">Pts</div>
					<div class="sheet-cell sheet-col4">&nbsp;</div>
				</div> <!-- .sheet-header -->
				<div class="sheet-row sheet-row-current-fatigue-points">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Current FP:</div>
						<span class="sheet-tooltip"><strong>Current Fatigue Points</strong><br />When your fatigue points are low you take penalties.<br />See Page
							426.</span>
					</div>
					<div class="sheet-cell sheet-col1">
						<input type="number" name="attr_fatigue_points" value="10" />
					</div>
				</div>
				<div class="sheet-row sheet-row-fatigue-points">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Basic FP:</div><span class="sheet-tooltip"><strong>Fatigue Points</strong><br />Based on Health 3pts/level<br />was Maximum Fatigue Points</span>
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">
						<input name="attr_fatigue_points_max" value="10" readonly="readonly" />
					</div>
					<div class="sheet-cell sheet-col2">
						<input type="number" name="attr_fatigue_points_mod" value="0" step="1" />
					</div>
					<div class="sheet-cell sheet-col3">
						<input type="number" name="attr_fatigue_points_points" value="0" step="3" />
					</div>
				</div> <!-- .sheet-row -->
				<div class="sheet-row sheet-row-thresholds">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Tired:</div><span class="sheet-tooltip">You are very tired. Halve your Move, Dodge,<br />and ST (round up). This does not affect ST<br />based quantities, such as HP and damage.</span>
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">
						<span name="attr_fp_tired" ></span><input type="hidden" name="attr_fatigue_tired" value=""/>
					</div>
				</div>
				<div class="sheet-row sheet-row-thresholds">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Collapse:</div><span class="sheet-tooltip">0 FP or less – You are on the verge of collapse. If<br />you suffer further fatigue, each FP you lose also<br />causes 1 HP of injury. To do anything besides talk<br />or rest, you must make a Will roll; in combat, roll<br />before each maneuver other than Do Nothing.<br />On a success, you can act normally.</span>
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">
						<span name="attr_fp_collapse" ></span>
					</div>
					<div class="sheet-cell sheet-col2">&nbsp;</div>
					<div class="sheet-cell sheet-col3">&nbsp;</div>
					<div class="sheet-cell sheet-col4">
						<button class="sheet-roll-button" type="roll" name="attr_Will" value="!attr @{character_id} Willpower [[@{willpower} + @{modifier}]]"></button>
					</div>
				</div>
				<div class="sheet-row sheet-row-thresholds">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Unconscious:</div><span class="sheet-tooltip">You fall unconscious. While unconscious, you<br />recover lost FP at the same rate as for normal rest.</span>
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">
						<span name="attr_fp_uncons" ></span><input type="hidden" name="attr_fatigue_unconscious" value=""/>
					</div>
				</div>
				<div class="sheet-row sheet-row-current-hit-points sheet-hr">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Current HP:</div>
						<span class="sheet-tooltip"><strong>Current Hit Points</strong><br />When you're hit points are low,<br />you take penalties. See B419.</span>
					</div>
					<div class="sheet-cell sheet-col1">
						<input type="number" name="attr_hit_points" value="10" />
					</div>
				</div> <!-- .sheet-row -->
				<div class="sheet-row sheet-row-hit-points">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Basic HP:</div>
						<span class="sheet-tooltip"><strong>Hit Points</strong><br />Based on Strength 2pts/level<br />was Maximum Hit Points</span>
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">
						<input name="attr_hit_points_max" value="10" readonly="readonly" />
					</div>
					<div class="sheet-cell sheet-col2">
						<input type="number" name="attr_hit_points_mod" value="0" step="1" />
					</div>
					<div class="sheet-cell sheet-col3">
						<input type="number" name="attr_hit_points_points" value="0" step="2" />
					</div>
				</div> <!-- .sheet-row -->
				<div class="sheet-row sheet-row-thresholds">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Reeling:</div>
						<span class="sheet-tooltip"><strong>Less than 1/3 of your HP remaining.</strong><br />Halve your Basic Speed and Move (round up),<br /> which also reduces your Dodge.</span>
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">
						<span name="attr_reeling_threshold" ></span>
					</div>
				</div>
				<div class="sheet-row sheet-row-thresholds">
					<div class="sheet-cell sheet-col0">
						Collapse:
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">
						<span name="attr_hp_collapse" ></span>
					</div>
				</div>
				<div class="sheet-row sheet-row-thresholds">
					<div class="sheet-cell sheet-col0">
						Check #1:
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">
						<span name="attr_hp_check1" ></span>
					</div>
				</div>
				<div class="sheet-row sheet-row-thresholds">
					<div class="sheet-cell sheet-col0">
						Check #2:
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">
						<span name="attr_hp_check2" ></span>
					</div>
				</div>
				<div class="sheet-row sheet-row-thresholds">
					<div class="sheet-cell sheet-col0">
						Check #3:
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">
						<span name="attr_hp_check3" ></span>
					</div>
				</div>
				<div class="sheet-row sheet-row-thresholds">
					<div class="sheet-cell sheet-col0">
						Check #4:
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">
						<span name="attr_hp_check4" ></span>
					</div>
				</div>
				<div class="sheet-row sheet-row-thresholds">
					<div class="sheet-cell sheet-col0">
						Dead:
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">
						<span name="attr_dead" ></span>
					</div>
				</div>
				<div class="sheet-row sheet-row-thresholds">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Stun</div>
						<span class="sheet-tooltip">
							<strong>Stun check:</strong> recover from physical stun, based on Health.<br />
							High Pain Threshold +3 to check<br />
							Low Pain Threshold -4 to check<br />
							see B420.
						</span>
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">
						<input type="number" name="attr_stun_check" value="10" readonly="readonly" >
					</div>
					<div class="sheet-cell sheet-col2">
						<input type="number" name="attr_stun_check_mod" value="0" step="1" />
					</div>
					<div class="sheet-cell sheet-col3">
						&nbsp;
					</div>
					<div class="sheet-cell sheet-col4">
						<button class="sheet-roll-button" type="roll" name="attr_stun_roll" value="!attr @{character_id} Stun-Check [[@{stun_check} + @{modifier}]]"></button>
					</div>
				</div>
				<div class="sheet-row sheet-row-thresholds">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Knock Down</div>
						<span class="sheet-tooltip">
							<strong>Knockdown Check:</strong> based on Health.<br />
							Roll on Major wound, <i>vitals</i> or <i>head</i> strike.<br />
							-5 for major wound, -10 if <i>skull</i> or <i>eye</i>.<br />
							+3 High Pain Threshold<br />
							-4 Low Pain Threshold<br />
							Fail means stunned. If fail by 5 or more, unconscious.<br />
							see B420
						</span>
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">
						<input type="number" name="attr_knockdown_check" value="10" readonly="readonly" >
					</div>
					<div class="sheet-cell sheet-col2">
						<input type="number" name="attr_knockdown_check_mod" value="0" step="1" />
					</div>
					<div class="sheet-cell sheet-col3">
						&nbsp;
					</div>
					<div class="sheet-cell sheet-col4">
						<button class="sheet-roll-button" type="roll" name="attr_knockdown_roll" value="!attr @{character_id} Knockdown-Check [[@{knockdown_check} + @{modifier}]]"></button>
					</div>
				</div>
				<div class="sheet-row sheet-row-thresholds">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Unconscious</div>
						<span class="sheet-tooltip">
							<strong>Unconscious Check:</strong> based on Health<br />
							If HP or FP less than zero, roll per turn.<br />
							Hard/Easy to Subdue plus or minus pts/level. Plus or minus one to Unconscious Check per level.<br />
						</span>
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">
						<input type="number" name="attr_unconscious_check" value="10" readonly="readonly" >
					</div>
					<div class="sheet-cell sheet-col2">
						<input type="number" name="attr_unconscious_check_mod" value="0" step="1" />
					</div>
					<div class="sheet-cell sheet-col3">
						&nbsp;
					</div>
					<div class="sheet-cell sheet-col4">
						<button class="sheet-roll-button" type="roll" name="attr_unconscious_roll" value="!attr @{character_id} Consciousness-Check [[@{unconscious_check} + @{modifier}]]"></button>
					</div>
				</div>
				<div class="sheet-row sheet-row-thresholds">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Death</div>
						<span class="sheet-tooltip">
							<strong>Death Check:</strong> based on Health.<br />
							On damage taken, Roll if -HP. Another roll for each multiple of -HP.<br />
							Immediate Death at -5xHP<br />
							Hard/Easy to Kill plus or minus 2 pts/level. Plus or minus one to Death Check per level<br />
							Fit +1 to Death Check . Very Fit +2 to Death Check<br />
						</span>
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">
						<input type="number" name="attr_death_check" value="10" readonly="readonly" >
					</div>
					<div class="sheet-cell sheet-col2">
						<input type="number" name="attr_death_check_mod" value="0" step="1" />
					</div>
					<div class="sheet-cell sheet-col3">
						&nbsp;
					</div>
					<div class="sheet-cell sheet-col4">
						<button class="sheet-roll-button" type="roll" name="attr_death_roll" value="!attr @{character_id} Death-Check [[@{death_check} + @{modifier}]]"></button>
					</div>
				</div>
				<!-- .sheet-row -->
			</div>
		</div>
	</div> <!-- .sheet-tab1 -->
	<!-- ===== ===== ===== ===== TRAITS TAB ===== ===== ===== ===== -->
	<div class="sheet-tab2">
		<div class="sheet-box sheet-traits">
			<!-- Adv -->
			<div class="sheet-table">
				<div class="sheet-header">
					<div class="sheet-cell sheet-col0">Advantages & Perks</div>
					<div class="sheet-cell sheet-col1">
						<div class="sheet-popup">CR</div>
						<span class="sheet-tooltip">
							Control Rating
							<br />
							<table>
								<tbody>
									<tr>
										<td>Quite rarely (6-)</td>
										<td>1/2x</td>
									</tr>
									<tr>
										<td>Fairly often (9-)</td>
										<td>1x</td>
									</tr>
									<tr>
										<td>Quite often (12-)</td>
										<td>2x</td>
									</tr>
									<tr>
										<td>Almost all the time (15-)</td>
										<td>3x</td>
									</tr>
									<tr>
										<td>Constant (No roll required)</td>
										<td>4x</td>
									</tr>
								</tbody>
							</table>
						</span>
					</div>
					<div class="sheet-cell sheet-col2">Pts</div>
					<div class="sheet-cell sheet-col3">Ref</div>
				</div> <!-- .sheet-header -->
				<fieldset class="repeating_traits">
					<input class="sheet-toggle" type="checkbox" />
					<span class="sheet-checkbox"></span>
					<div class="sheet-row sheet-row-stats">
						<div class="sheet-cell sheet-col0">
							<button class="sheet-roll-button" type="roll" name="attr_CR_roll" value="!adv @{character_id} @{rowid} [[@{control_rating} + @{modifier} + @{temp_SC_mod}]] [[@{notes_onoff}]] advantages"></button>
						</div>
						<div class="sheet-cell sheet-col1">
							<input type="text" name="attr_name" placeholder="Advantage Name" />
						</div>
						<div class="sheet-cell sheet-col2">
							<input type="number" name="attr_control_rating" value="0" placeholder="0" />
						</div>
						<div class="sheet-cell sheet-col3">
							<input type="number" name="attr_points" value="0" placeholder="0" />
						</div>
						<div class="sheet-cell sheet-col4">
							<input type="text" name="attr_ref" placeholder="ref" />
						</div>
					</div> <!-- .sheet-row -->
					<div class="sheet-row sheet-row-details">
						<div class="sheet-cell sheet-col0">
							<div class="sheet-popup"><input type="checkbox" class="sheet-boolean" name="attr_notes_onoff" value="1" />
							</div><span class="sheet-tooltip">Check to display notes in rolls</span>
						</div>
						<div class="sheet-cell sheet-col1">
							<textarea name="attr_notes" placeholder="notes"></textarea>
						</div>
					</div>
					<div class="sheet-row sheet-row-details-rowid">
						<div class="sheet-cell sheet-col2">
							RowID For Macros:
						</div>
						<div class="sheet-cell sheet-col3">
							<input class="text" name="attr_rowid" value="" readonly="readonly"/>
						</div>
					</div>
				</fieldset>
				<div class="sheet-header">
					<div class="sheet-cell sheet-col0">Disadvantages</div>
					<div class="sheet-cell sheet-col1">
						<div class="sheet-popup">CR</div>
						<span class="sheet-tooltip">
							Control Rating
							<br />
							<table>
								<tbody>
									<tr>
										<td>Quite rarely (6-)</td>
										<td>1/2x</td>
									</tr>
									<tr>
										<td>Fairly often (9-)</td>
										<td>1x</td>
									</tr>
									<tr>
										<td>Quite often (12-)</td>
										<td>2x</td>
									</tr>
									<tr>
										<td>Almost all the time (15-)</td>
										<td>3x</td>
									</tr>
									<tr>
										<td>Constant (No roll required)</td>
										<td>4x</td>
									</tr>
								</tbody>
							</table>
						</span>
					</div>
					<div class="sheet-cell sheet-col2">Pts</div>
					<div class="sheet-cell sheet-col3">Ref</div>
				</div> <!-- .sheet-header -->
				<fieldset class="repeating_disadvantages">
					<input class="sheet-toggle" type="checkbox" />
					<span class="sheet-checkbox"></span>
					<div class="sheet-row sheet-row-stats">
						<input class="hidden" name="attr_rowid" value="" />
						<div class="sheet-cell sheet-col0"><button class="sheet-roll-button" type="roll" name="attr_CR_roll" value="!disad @{character_id} @{rowid} [[@{control_rating} + @{modifier} + @{temp_SC_mod}]] [[@{notes_onoff}]] disadvantages"></button>
						</div>
						<div class="sheet-cell sheet-col1">
							<input type="text" name="attr_name" placeholder="Disadvantage Name" />
						</div>
						<div class="sheet-cell sheet-col2">
							<input type="number" name="attr_control_rating" value="0" placeholder="0" />
						</div>
						<div class="sheet-cell sheet-col3">
							<input type="number" name="attr_points" value="0" placeholder="0" />
						</div>
						<div class="sheet-cell sheet-col4">
							<input type="text" name="attr_ref" placeholder="ref" />
						</div>
					</div> <!-- .sheet-row -->
					<div class="sheet-row sheet-row-details">
						<div class="sheet-cell sheet-col0">
							<div class="sheet-popup"><input type="checkbox" class="sheet-boolean" name="attr_notes_onoff" value="1" />
							</div><span class="sheet-tooltip">Check to display notes in rolls</span>
						</div>
						<div class="sheet-cell sheet-col1">
							<textarea name="attr_notes" placeholder="notes"></textarea>
						</div>
					</div>
					<div class="sheet-row sheet-row-details-rowid">
						<div class="sheet-cell sheet-col2">
							RowID For Macros:
						</div>
						<div class="sheet-cell sheet-col3">
							<input name="attr_rowid" value="" readonly="readonly" />
						</div>
					</div>
				</fieldset>
				<div class="sheet-header">
					<div class="sheet-cell sheet-col0">Quirks</div>
					<div class="sheet-cell sheet-col1">
						<div class="sheet-popup">CR</div>
						<span class="sheet-tooltip">
							Control Rating
							<br />
							<table>
								<tbody>
									<tr>
										<td>Quite rarely (6-)</td>
										<td>1/2x</td>
									</tr>
									<tr>
										<td>Fairly often (9-)</td>
										<td>1x</td>
									</tr>
									<tr>
										<td>Quite often (12-)</td>
										<td>2x</td>
									</tr>
									<tr>
										<td>Almost all the time (15-)</td>
										<td>3x</td>
									</tr>
									<tr>
										<td>Constant (No roll required)</td>
										<td>4x</td>
									</tr>
								</tbody>
							</table>
						</span>
					</div>
					<div class="sheet-cell sheet-col2">Pts</div>
					<div class="sheet-cell sheet-col3">Ref</div>
				</div> <!-- .sheet-header -->
				<fieldset class="repeating_quirks">
					<input class="sheet-toggle" type="checkbox" />
					<span class="sheet-checkbox"></span>
					<div class="sheet-row sheet-row-stats">
						<div class="sheet-cell sheet-col0">
							<button class="sheet-roll-button" type="roll" name="attr_CR_roll" value="!quirk @{character_id} @{rowid} [[@{control_rating} + @{modifier} @{temp_SC_mod}]] [[@{notes_onoff}]] quirks"></button>
							<input class="hidden" name="attr_rowid" value="" />
						</div>
						<div class="sheet-cell sheet-col1">
							<input type="text" name="attr_name" placeholder="Quirk Name" />
						</div>
						<div class="sheet-cell sheet-col2">
							<input type="number" name="attr_control_rating" value="0" placeholder="0" />
						</div>
						<div class="sheet-cell sheet-col3">
							<input type="number" name="attr_points" value="0" placeholder="0" />
						</div>
						<div class="sheet-cell sheet-col4">
							<input type="text" name="attr_ref" placeholder="ref" />
						</div>
					</div> <!-- .sheet-row -->
					<div class="sheet-row sheet-row-details">
						<div class="sheet-cell sheet-col0">
							<div class="sheet-popup"><input type="checkbox" class="sheet-boolean" name="attr_notes_onoff" value="1" />
							</div><span class="sheet-tooltip">Check to display notes in rolls</span>
						</div>
						<div class="sheet-cell sheet-col1">
							<textarea name="attr_notes" placeholder="notes"></textarea>
						</div>
					</div>
					<div class="sheet-row sheet-row-details-rowid">
						<div class="sheet-cell sheet-col2">
							RowID For Macros:
						</div>
						<div class="sheet-cell sheet-col3">
							<input name="attr_rowid" value="" readonly="readonly" />
						</div>
					</div>
				</fieldset>
				<div class="sheet-header">
					<div class="sheet-cell sheet-col0">Template Traits</div>
					<div class="sheet-cell sheet-col1">
						<div class="sheet-popup">CR</div>
						<span class="sheet-tooltip">
							Control Rating
							<br />
							<table>
								<tbody>
									<tr>
										<td>Quite rarely (6-)</td>
										<td>1/2x</td>
									</tr>
									<tr>
										<td>Fairly often (9-)</td>
										<td>1x</td>
									</tr>
									<tr>
										<td>Quite often (12-)</td>
										<td>2x</td>
									</tr>
									<tr>
										<td>Almost all the time (15-)</td>
										<td>3x</td>
									</tr>
									<tr>
										<td>Constant (No roll required)</td>
										<td>4x</td>
									</tr>
								</tbody>
							</table>
						</span>
					</div>
					<div class="sheet-cell sheet-col2">Pts</div>
					<div class="sheet-cell sheet-col3">Ref</div>
				</div> <!-- .sheet-header -->
				<fieldset class="repeating_racial">
					<input class="sheet-toggle" type="checkbox" />
					<span class="sheet-checkbox"></span>
					<div class="sheet-row sheet-row-stats">
						<div class="sheet-cell sheet-col0">
							<button class="sheet-roll-button" type="roll" name="attr_CR_roll" value="!race @{character_id} @{rowid} [[@{control_rating} + @{modifier}]] [[@{notes_onoff}]] racial"></button>
							<input class="hidden" name="attr_rowid" value="" />
						</div>
						<div class="sheet-cell sheet-col1">
							<input type="text" name="attr_name" placeholder="Template Trait" />
						</div>
						<div class="sheet-cell sheet-col2">
							<input type="number" name="attr_control_rating" value="0" placeholder="0" />
						</div>
						<div class="sheet-cell sheet-col3">
							<input type="number" name="attr_points" value="0" placeholder="0" />
						</div>
						<div class="sheet-cell sheet-col4">
							<input type="text" name="attr_ref" placeholder="ref" />
						</div>
					</div> <!-- .sheet-row -->
					<div class="sheet-row sheet-row-details">
						<div class="sheet-cell sheet-col0">
							<div class="sheet-popup"><input type="checkbox" class="sheet-boolean" name="attr_notes_onoff" value="1" />
							</div><span class="sheet-tooltip">Check to display notes in rolls</span>
						</div>
						<div class="sheet-cell sheet-col1">
							<textarea name="attr_notes" placeholder="notes"></textarea>
						</div>
					</div>
					<div class="sheet-row sheet-row-details-rowid">
						<div class="sheet-cell sheet-col2">
							RowID For Macros:
						</div>
						<div class="sheet-cell sheet-col3">
							<input name="attr_rowid" value="" readonly="readonly" />
						</div>
					</div>
				</fieldset> <!-- .repeating_racial -->
			</div> <!-- .sheet-table -->
		</div> <!-- .sheet-box .sheet-traits -->
	</div> <!-- .sheet-tab2 -->
	<!-- ===== ===== ===== ===== SKILLS TAB ===== ===== ===== ===== -->
	<div class="sheet-tab3">
		<!-- _____ _____ SKILLS BOX _____ _____ -->

		<div class="sheet-box sheet-skills">
			<div class="sheet-table">
				<div class="sheet-header sheet-header-skills">
					<div class="sheet-cell sheet-col0">Skills</div>
					<div class="sheet-cell sheet-col1">SL</div>
					<div class="sheet-cell sheet-col1">Attr</div>
					<div class="sheet-cell sheet-col1">Diff</div>
					<div class="sheet-cell sheet-col1">Bonus</div>
					<div class="sheet-cell sheet-col1">Pts</div>
					<div class="sheet-cell sheet-col2">Ref</div>
				</div> <!-- .sheet-header -->
				<fieldset class="repeating_skills">
					<input class="sheet-toggle" type="checkbox" />
					<span class="sheet-checkbox"></span>
					<div class="sheet-row sheet-row-skills">
						<div class="sheet-cell sheet-col0">
							<input type="hidden" name="attr_rowid" value="" />
							<button class="sheet-roll-button" type="roll" name="attr_Skill_roll" value="!skill @{character_id} @{rowid} [[@{level} + @{modifier} + @{skillRoll_mod}]] [[@{notes_onoff}]] skills" ></button>
						</div>
						<div class="sheet-cell sheet-col1">
							<input type="text" name="attr_skillname" placeholder="Skill Name" readonly="readonly" />
						</div>
						<div class="sheet-cell sheet-col2">
							<input type="text" name="attr_level" disabled="disabled" value="[[@{difficulty}*1]]" />
						</div>
						<div class="sheet-cell sheet-col2">
							<select name="attr_base">
								<option value="@{strength}">ST</option>
								<option value="@{dexterity}">DX</option>
								<option value="@{intelligence}">IQ</option>
								<option value="@{health}">HT</option>
								<option value="@{willpower}">Will</option>
								<option value="@{perception}">Per</option>
								<option value="10">10</option>
							</select>
						</div>
						<div class="sheet-cell sheet-col2">
							<select name="attr_difficulty">
								<option value="-1 + @{base} + @{bonus} + @{enc} + (floor((@{points} * 0.25) + 2) * ceil( ( ( @{points} - 2 ) + abs( @{points} - 2) ) / 256 ) + @{points} * abs( ceil( ( ( @{points} - 2 ) + abs( @{points} - 2) ) / 256 ) - 1 ) * abs( ceil( ( ( @{points} - 2 ) + abs( @{points} - 2) ) / 256 ) - 1 ))">
									E</option>
								<option value="-2 + @{base} + @{bonus} + @{enc} + (floor((@{points} * 0.25) + 2) * ceil( ( ( @{points} - 2 ) + abs( @{points} - 2) ) / 256 ) + @{points} * abs( ceil( ( ( @{points} - 2 ) + abs( @{points} - 2) ) / 256 ) - 1 ) * abs( ceil( ( ( @{points} - 2 ) + abs( @{points} - 2) ) / 256 ) - 1 ))">
									A</option>
								<option value="-3 + @{base} + @{bonus} + @{enc} + (floor((@{points} * 0.25) + 2) * ceil( ( ( @{points} - 2 ) + abs( @{points} - 2) ) / 256 ) + @{points} * abs( ceil( ( ( @{points} - 2 ) + abs( @{points} - 2) ) / 256 ) - 1 ) * abs( ceil( ( ( @{points} - 2 ) + abs( @{points} - 2) ) / 256 ) - 1 ))">
									H</option>
								<option value="-4 + @{base} + @{bonus} + @{enc} + (floor((@{points} * 0.25) + 2) * ceil( ( ( @{points} - 2 ) + abs( @{points} - 2) ) / 256 ) + @{points} * abs( ceil( ( ( @{points} - 2 ) + abs( @{points} - 2) ) / 256 ) - 1 ) * abs( ceil( ( ( @{points} - 2 ) + abs( @{points} - 2) ) / 256 ) - 1 ))">
									VH</option>
								<option value="-4 + @{base} + @{bonus} + @{enc} + (floor( (floor( @{points} / 3) * 0.25) + 2) * ceil( ( ( floor( @{points} / 3) - 2 ) + abs( floor( @{points} / 3) - 2) ) / 256 ) + floor( @{points} / 3) * abs( ceil( ( ( floor( @{points} / 3) - 2 ) + abs( floor( @{points} / 3) - 2) ) / 256 ) - 1 ) * abs( ceil( ( ( floor( @{points} / 3) - 2 ) + abs( floor( @{points} / 3) - 2) ) / 256 ) - 1 ))">
									WC</option> <!-- rebuild as sheetworker -->
							</select>
						</div>
						<div class="sheet-cell sheet-col2">
							<input type="number" name="attr_bonus" value="0" placeholder="0" />
						</div>
						<div class="sheet-cell sheet-col2">
							<input type="number" name="attr_points" value="0" placeholder="0" />
						</div>
						<div class="sheet-cell sheet-col3">
							<input type="text" name="attr_ref" placeholder="ref" />
						</div>
					</div> <!-- .sheet-row -->
					<div class="sheet-row sheet-row-subrow">
						<div class="sheet-cell sheet-skillname">Name</div>
						<div class="sheet-cell sheet-skillname-input"> <input type="text"name="attr_skillname"/></div>
						<div class="sheet-cell sheet-specialization">Specialization</div>
						<div class="sheet-cell sheet-specialization-input"><input type="text"name="attr_specialization"/></div>
						<div class="sheet-cell sheet-techlevel">Tech Level</div>
						<div class="sheet-cell sheet-tlcheckbox"><input type="checkbox" class="sheet-boolean" name="attr_skill_tl_onoff" value="1" /></div>
						<div class="sheet-cell sheet-tlinput"><input type="text" name="attr_skill_tl" /></div>
					</div>
					<div class="sheet-row sheet-row-subrow">
				        <div class="sheet-cell sheet-skillencumbrancelabel">Encumbrance</div>
				        <div class="sheet-cell sheet-skillencumbrance-select"><select name="attr_skill_enc">
				            <option value="0">No penalty due to encumbrance</option>
				            <option value="-1">Penalty equal to the current encumbrance level</option>
				            <option value="-2">Penalty equal to 2 times the current encumbrance level</option>
				            <option value="-3">Penalty equal to 3 times the current encumbrance level</option>
				            <option value="-4">Penalty equal to 4 times the current encumbrance level</option>
				            <option value="-5">Penalty equal to 5 times the current encumbrance level</option>
				            <option value="-6">Penalty equal to 6 times the current encumbrance level</option>
				            <option value="-7">Penalty equal to 7 times the current encumbrance level</option>
				            <option value="-8">Penalty equal to 8 times the current encumbrance level</option>
				            <option value="-9">Penalty equal to 9 times the current encumbrance level</option>
				            </select>
				        </div>
				        <div class="sheet-cell sheet-category">Categories</div>
				        <div class="sheet-cell sheet-category-input"> <input type="text"name="attr_categories" /></div>
				    </div>
				    <div class="sheet-row sheet-row-subrow">
						<div class="sheet-cell sheet-col0">
							<div class="sheet-popup"><input type="checkbox" class="sheet-boolean" name="attr_notes_onoff" value="1"/>
							</div><span class="sheet-tooltip">Check to dislay notes in rolls</span>
						</div>
						<div class="sheet-cell sheet-col1">Notes</div>
						<div class="sheet-cell sheet-col2">
							<div class="sheet-auto-expand">
								<span name="attr_notes"></span>
								<textarea name="attr_notes"></textarea>
							</div>
						</div>
					</div>
					<div class="sheet-row sheet-row-subrow">
						<div class="sheet-cell sheet-difficulty">Difficulty</div>
						<div class="sheet-cell sheet-base"><select name="attr_base"> <!-- Base needs two properties eg. ST.value & ST.name -->
				            <option value="ST">ST</option> 
				            <option value="DX">DX</option>
				            <option value="IQ">IQ</option>
				            <option value="HT">HT</option>
				            <option value="Will">Will</option>
				            <option value="Per">Per</option>
				            <option value="Ten">10</option>
				            </select>
				        </div>
				        <div class="sheet-cell sheet-diffdivider">/</div>
				        <div class="sheet-cell sheet-base">
				            <select name="attr_difficulty">
				            <option value="E">E</option>
				            <option value="A">A</option>
				            <option value="H">H</option>
				            <option value="V">VH</option>
				            <option value="W">WC</option>
				            </select>
				        </div>
			            <div class="sheet-cell sheet-points">Points</div>
			            <div class="sheet-cell sheet-skillpoints"><input type="number" name="attr_points"/></div>
			            <div class="sheet-cell sheet-skilllevel">Level</div>
			            <div class="sheet-cell sheet-baselevel"><input type="text" name="attr_level"/></div>
			            <div class="sheet-cell sheet-pageref">Page Reference</div>
			            <div class="sheet-cell sheet-pagerefinput"><input type="text" name="attr_ref"></div>
			            <div class="sheet-cell sheet-skillmod">Modifier</div>
			            <div class="sheet-cell sheet-skillmodinput"><input type="number" name="attr_modifier" /></div>
			            <div class="sheet-cell sheet-rowid">RowID</div>
			            <div class="sheet-cell sheet-rowidoutput"><input name="attr_rowid" value="" readonly="readonly" /></div>
			            <input type="hidden" name="attr_enc_penalty" value="0" readonly="readonly" />
							<input type="hidden" name="attr_base" value="0" readonly="readonly" />
				    </div>
				</fieldset>
				<div class="sheet-header sheet-header-techniques">
					<div class="sheet-cell sheet-col0">Technique</div>
					<div class="sheet-cell sheet-col1">Parent Skill</div>
					<div class="sheet-cell sheet-col2">Default</div>
					<div class="sheet-cell sheet-col2">Level</div>
					<div class="sheet-cell sheet-col2">Mx. Lvl</div>
					<div class="sheet-cell sheet-col2">Diff</div>
					<div class="sheet-cell sheet-col2">Bonus</div>
					<div class="sheet-cell sheet-col2">Pts</div>
					<div class="sheet-cell sheet-col3">Ref</div>
				</div> <!-- .sheet-header -->
				<fieldset class="repeating_techniques">
					<input class="sheet-toggle" type="checkbox" />
					<span class="sheet-checkbox"></span>
					<div class="sheet-row sheet-row-techniques">
						<div class="sheet-cell sheet-col0">
							<input type="hidden" name="attr_rowid" value="" />
							<button class="sheet-roll-button" type="roll" name="attr_Techn_roll" value="!tech @{character_id} @{rowid} [[@{level} + @{modifier} + @{skillRoll_mod}]] [[@{notes_onoff}]] techniques" ></button>
						</div>
						<div class="sheet-cell sheet-col1">
							<input type="text" name="attr_skillname" placeholder="Technique Name" />
						</div>
						<div class="sheet-cell sheet-col2">
							<input type="text" name="attr_parent_name" placeholder="Parent Skill Name" />
						</div>
						<div class="sheet-cell sheet-col3">
							<input type="number" name="attr_defaultlvl" value="0" />
						</div>
						<div class="sheet-cell sheet-col3">
							<input name="attr_level" readonly="readonly" />
						</div>
						<div class="sheet-cell sheet-col3">
							<input type="number" name="attr_mlevel" value="0" />
						</div>
						<div class="sheet-cell sheet-col3">
							<select name="attr_difficulty">
								<option value="0">A</option>
								<option value="-1">H</option>
							</select>
						</div>
						<div class="sheet-cell sheet-col3">
							<input type="number" name="attr_bonus" value="0" />
						</div>
						<div class="sheet-cell sheet-col3">
							<input type="number" name="attr_points" value="0" />
						</div>
						<div class="sheet-cell sheet-col4">
							<input type="text" name="attr_ref" placeholder="ref" />
						</div>
					</div> <!-- .sheet-row -->
					<div class="sheet-row sheet-row-details">
						<div class="sheet-cell sheet-col0">
							<div class="sheet-popup"><input type="checkbox" class="sheet-boolean" name="attr_notes_onoff" value="1"/>
							</div><span class="sheet-tooltip">Check to dislay notes in rolls</span>
						</div>
						<div class="sheet-cell sheet-col1">
							<textarea name="attr_notes" placeholder="notes"></textarea>
						</div>
					</div>
					<div class="sheet-row sheet-row-details-rowid">
						<div class="sheet-cell sheet-col2">
							RowID For Macros:
						</div>
						<div class="sheet-cell sheet-col3">
							<input name="attr_rowid" value="" readonly="readonly" />
						</div>
					</div>
				</fieldset>
			</div>
		</div>
	</div>
	<!-- ===== ===== ===== ===== COMBAT TAB ===== ===== ===== ===== -->
	<div class="sheet-tab4">
		<!-- _____ _____ PERMANENT MODIFIERS BOX _____ _____ -->
		<div class="sheet-box sheet-combat">
			<div class="sheet-table">
				<div class="sheet-header sheet-header-perm-modifiers">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">PERMANENT COMBAT MODIFIERS OR SETTINGS:
						</div><span class="sheet-tooltip">Several advantages or disadvantages give<br />a permanent modifier to certain combat<br />modifier calculations. These are listed<br />here since they effect Defense, Melee,<br />and Ranged combat calculations.</span>
					</div>
				</div>
				<div class="sheet-header sheet-header-perm-modifiers">
					<div class="sheet-cell sheet-col0-0">
						<div class="sheet-popup">Combat Reflexes:</div><span class="sheet-tooltip"><strong>Combat Reflexes</strong><br />You get +1 to all active defense rolls (see<br />Defending, p. 374), +1 to Fast-Draw skill,<br />and +2 to Fright Checks (see Fright<br />Checks, p. 360). You never “freeze” in a<br />surprise situation, and get +6 on all IQ<br />rolls to wake up, or to recover from<br />surprise or mental “stun.”<br />Your side gets +1 on initiative rolls to<br />avoid a surprise attack – +2 if you are<br />the leader. For details, see Surprise<br />Attacks and Initiative (p. 393).<br />B43</span>
					</div>
					<div class="sheet-cell sheet-col0-1">
						<input type="checkbox" class="sheet-boolean" name="attr_combat_reflexes" value="1" />
					</div>
					<div class="sheet-cell sheet-col0-2">
						<div class="sheet-popup">Trained by a Master:</div><span class="sheet-tooltip"><strong>Trained by a Master</strong><br />You have half the usual penalty to<br />make a Rapid Strike (see Melee Attack<br />Options, p. 370), or to parry more than<br />once per turn (see Parrying, p. 376).<br />These benefits apply to all your<br />unarmed combat skills (Judo, Karate,<br />etc.) and Melee Weapon skills.<br />B93</span>
					</div>
					<div class="sheet-cell sheet-col0-3">
						<input type="checkbox" class="sheet-boolean" name="attr_trained_by_master" value="1" />
					</div>
					<div class="sheet-cell sheet-col0-4">
						<div class="sheet-popup">Weapon Master:</div><span class="sheet-tooltip"><strong>Weapon Master</strong><br />When using a suitable weapon, add +1<br />per die to basic thrust or swing damage if<br />you know the relevant weapon skill at<br />DX+1. Add +2 per die if you know that<br />skill at DX+2 or better.<br />You also have half the usual penalty to<br />make a Rapid Strike (see Melee Attack<br />Options, p. 369), or to parry more than<br />once per turn (see Parrying, p. 376).<br />None of these benefits apply to default use.<br />B99</span>
					</div>
					<div class="sheet-cell sheet-col0-5">
						<input type="checkbox" class="sheet-boolean" name="attr_weapon_master" value="1" />
					</div>
					<div class="sheet-cell sheet-col0-6">
						<div class="sheet-popup">Ambidextrous:</div><span class="sheet-tooltip"><strong>Ambidextrous</strong><br />You can fight or otherwise act<br />equally well with either hand,<br />and never suffer the -4 DX<br />penalty for using the “off” hand<br />B39</span>
					</div>
					<div class="sheet-cell sheet-col0-5">
						<input type="checkbox" class="sheet-boolean" name="attr_ambidextrous" value="1" />
					</div>
					<div class="sheet-cell sheet-hipain">
						High Pain Threshold:
					</div>
					<div class="sheet-cell sheet-col0-5">
						<input type="checkbox" class="sheet-boolean" name="attr_hipain" value="2" />
					</div>
					<div class="sheet-cell sheet-lopain">
						Low Pain Threshold:
					</div>
					<div class="sheet-cell sheet-col0-5">
						<input type="checkbox" class="sheet-boolean" name="attr_lopain" value="2" />
					</div>
				</div>
			</div>
		</div>
		
		<!-- _____ _____ MANUEVER BOX _____ _____ -->
		<div class="sheet-box sheet-combat">
			<div class="sheet-table">
				<div class="sheet-header sheet-manuever-header">
					<div class="sheet-cell sheet-col0">
						<div class="sheet-popup">Manuever</div><span class="sheet-tooltip"><strong>Manuevers:</strong><br />A “maneuver” is an action that you can take<br />on your turn. Each turn, you must choose one.<br />
							<br />Your choice determines what you can do on<br />your turn, and sets your options for active<br />defense and movement. B363</span>
					</div>
					<div class="sheet-cell sheet-col1">
						<div class="sheet-popup">Defense</div><span class="sheet-tooltip"><strong>Active Defense:</strong><br />For the purpose of active defenses, your<br />maneuver is considered to be in effect<br /> until you select another maneuver on<br />your next turn.</span>
					</div>
					<div class="sheet-cell sheet-col2">
						Move
					</div>
					<div class="sheet-cell sheet-col3">
						<div class="sheet-popup">Posture</div><span class="sheet-tooltip">Your bodily profile in combat.<br />B364</span>
					</div>
				</div>
				<div class="sheet-row sheet-row-manuever">
					<div class="sheet-cell sheet-col0">
						<select name="attr_manuever">
							<optgroup label="Basic Maneuvers B324">
								<option value="Aim">Aim</option>
								<option value="Atk">Attack</option>
								<option value="CP">Change Posture</option>
								<option value="Conc">Concentrate</option>
								<option value="DN" selected="selected">Do Nothing</option>
								<option value="Eval">Evaluate</option>
								<option value="Move">Move</option>
								<option value="Fnt">Feint</option>
								<option value="MA">Move and Attack</option>
								<option value="Rdy">Ready</option>
								<option value="Wait">Wait</option>
								<optgroup label="All-Out-Maneuvers">
								<option value="AoAMDT">AoA: Melee (Determined)</option>
								<option value="AoAMDD">AoA: Melee (Double)</option>
								<option value="AoAMF">AoA: Melee (Feint)</option>
								<option value="AoAMS">AoA: Melee (Strong)</option>
								<option value="AoARD">AoA: Ranged (Determined)</option>								
								<option value="AoARS">AoA: Ranged (Suppression Fire)</option>
								<option value="AoDID">AoD: Increased</option>
								<option value="AoDDD">AoD: Double Defense</option>
								</optgroup>
							</optgroup>
							<optgroup label="Advanced Maneuvers MA97">
								<option value="FMB">Feint: Beat</option>
								<option value="FMDF">Feint: Defensive</option>
								<option value="FMR">Feint: Ruse</option>
								<option value="AoAML">AoA: Melee (Long)</option>
								<option value="AoDMD">AoD: Mental Defense</option>
								<option value="CAMD">Committed Attack: Melee (Determined)</option>
								<option value="CAMS">Committed Attack: Melee (Strong)</option>
								<option value="DAtk">Defensive Attack</option>
							</optgroup>
						</select>
					</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">
						<span name="attr_man_active_defense"></span>
					</div>
					<div class="sheet-cell sheet-col2 sheet-readonly">
						<span name="attr_man_movement"></span>
					</div>
					<div class="sheet-cell sheet-col3">
						<select name="attr_posture">
							<option value="0" selected="selected">Standing</option>
							<option value="1">Crouching</option>
							<option value="2">Kneeling</option>
							<option value="3">Crawling</option>
							<option value="4">Sitting</option>
							<option value="5">Lying Down</option>
						</select>
						<input type="hidden" name="attr_posture_name" value="" />
						<input type="hidden" name="attr_posture_attack" value="" />
						<input type="hidden" name="attr_posture_defend" value="" />
						<input type="hidden" name="attr_posture_target" value="" />
						<input type="hidden" name="attr_posture_move" value="" />
					</div>
				</div>
				<div class="sheet-row sheet-row-manuever2">
					<div class="sheet-cell sheet-col0 sheet-readonly">
						<span name="attr_man_description"></span>
					</div>
				</div>
				<div class="sheet-row sheet-row-manuever2">
					<div class="sheet-cell sheet-col0 sheet-readonly">
						<span name="attr_man_notes"></span>
					</div>
				</div>
			</div>
		</div>
		
		<input type="radio" name="attr_modtab" value="50" class="sheet-modtab sheet-modtab50" checked="checked" /><span>Damage</span>
		<input type="radio" name="attr_modtab" value="51" class="sheet-modtab sheet-modtab51" /><span>Defense</span>
		<input type="radio" name="attr_modtab" value="52" class="sheet-modtab sheet-modtab52" /><span>Melee</span>
		<input type="radio" name="attr_modtab" value="53" class="sheet-modtab sheet-modtab53" /><span>Ranged</span>
		<input type="radio" name="attr_modtab" value="54" class="sheet-modtab sheet-modtab54" /><span>Vehicle Combat</span>
		<input type="radio" name="attr_modtab" value="55" class="sheet-modtab sheet-modtab55" /><span>Combat Tools</span>
		
		<!-- _____ _____ DAMAGE SUB TAB _____ _____ -->
		<div class="sheet-section sheet-section-damage">
		
		<!-- _____ _____ WOUNDS BOX _____ _____ -->
			<div class="sheet-box sheet-conditions-box">
				<div class="sheet-table">	
					<div class="sheet-header sheet-header-conditions">
						<div class="sheet-cell sheet-col0"><div class="sheet-popup">AFFLICTIONS</div><span class="sheet-tooltip">An “affliction” is a harmful effect other than<br />direct injury or fatigue, usually the result of an<br />attack, hazard, illness, magic spell, or toxin.<br />
							B428
							</span>
						</div>
						<div class="sheet-cell sheet-col1">
							<div class="sheet-popup"><button type="action" name="act_condition_reset" class="reset">Reset</button></div><span class="sheet-tooltip">Reset Conditions</span>
						</div>
					</div>
					<div class="sheet-row sheet-row-temporary">
						<div class="sheet-cell sheet-stunned">
							<div class="sheet-popup">Stunned:</div>
							<span class="sheet-tooltip">You are -4 to active defenses and<br />cannot retreat, and must Do Nothing<br />on your next turn. At the <i>end</i> of your<br />turn, attempt a HT roll to recover. If you<br />fail, you’re still stunned and must Do<br />Nothing for another turn. And so on..<br />
							B420
							</span>
						</div>
						<div class="sheet-cell sheet-col0">
							<input type="checkbox" class="sheet-boolean" name="attr_stunned" value="1"/>
						</div>
						<div class="sheet-cell sheet-shock">
							<div class="sheet-popup">Shock:</div>
							<span class="sheet-tooltip">Any injury that causes a loss of HP also<br />causes “shock.” Shock is a penalty to DX,<br />IQ, and skills based on those attributes <i>on<br />your next turn (only)</i>. This is -1 per HP lost<br />unless you have 20 or more HP, in which<br />case it is -1 per (HP/10) lost, rounded<br />down. The shock penalty cannot exceed -4,<br />no matter how much injury you suffer.<br />
							B419
							</span>
						</div>
						<div class="sheet-cell sheet-col0">
							<div class="sheet-popup"><input type="radio" name="attr_shock" value="0" checked="checked"/></div>
							<span class="sheet-tooltip"><strong>No Shock</strong></span>
						</div>
						<div class="sheet-cell sheet-col0">
							<div class="sheet-popup"><input type="radio" name="attr_shock" value="1"/></div>
							<span class="sheet-tooltip"><strong>Shock -1</strong></span>
						</div>
						<div class="sheet-cell sheet-col0">
							<div class="sheet-popup"><input type="radio" name="attr_shock" value="2"/></div>
							<span class="sheet-tooltip"><strong>Shock -2</strong></span>
						</div>
						<div class="sheet-cell sheet-col0">	
							<div class="sheet-popup"><input type="radio" name="attr_shock" value="3"/></div>
							<span class="sheet-tooltip"><strong>Shock -3</strong></span>
						</div>
						<div class="sheet-cell sheet-col0">	
							<div class="sheet-popup"><input type="radio" name="attr_shock" value="4"/></div>
							<span class="sheet-tooltip"><strong>Shock -4</strong></span>
						</div>
						<div class="sheet-cell sheet-mstunned">
							<div class="sheet-popup">Mentally Stunned:</div>
							<span class="sheet-tooltip">You are at -4 to active defenses and<br />cannot retreat. You must Do Nothing<br />on your next turn. At the end of your<br />turn, attempt an IQ roll to recover.<br /><br />On a success, you recover at the <i>end</i><br />of this turn – that is, you Do Nothing<br />this turn, but may act normally next turn.<br />
							B420
							</span>
						</div>
						<div class="sheet-cell sheet-col0">
							<input type="checkbox" class="sheet-boolean" name="attr_mentally_stunned" value="1"/>
						</div>
						<div class="sheet-cell sheet-bleeding">
							<div class="sheet-popup">Bleeding:</div>
							<span class="sheet-tooltip"><strong>Optional</strong><br />If you are injured, you may continue<br />to lose HP to bleeding.<br />
							B420
							</span>
						</div>
						<div class="sheet-cell sheet-col0">
							<input type="checkbox" class="sheet-boolean" name="attr_bleeding" value="1"/>
						</div>
						<div class="sheet-cell sheet-reeling">
							<div class="sheet-popup">Reeling:</div>
							<span class="sheet-tooltip">you are reeling from your wounds. Halve<br />your Basic Speed and Move (round up),<br />which also reduces your Dodge.<br />
							B419
							</span>
						</div>
						<div class="sheet-cell sheet-col0">
							<input type="checkbox" class="sheet-boolean" name="attr_reeling" value="1"/>
						</div>
						<div class="sheet-cell sheet-mortal">
							<div class="sheet-popup">Mortally Wounded:</div>
							<span class="sheet-tooltip">You are mortally wounded, you are<br />instantly incapacitated. You may or<br />may not be conscious (GM’s decision).<br />If you suffer further injury and must<br />make another HT roll to avoid death,<br />any failure kills you.<br />
							B423
							</span>
							</div>
						<div class="sheet-cell sheet-col0">
							<input type="checkbox" class="sheet-boolean" name="attr_mortally_wounded" value="1"/>
						</div>
						<div class="sheet-cell sheet-tired">
							<div class="sheet-popup">Tired:</div>
							<span class="sheet-tooltip">You are very tired. Halve your Move,<br />Dodge, and ST (round up). Thisdoes not<br />affect ST-based quantities, such as HP and damage.<br />
							B426
							</span>
							</div>
						<div class="sheet-cell sheet-col0">
							<input type="checkbox" class="sheet-boolean" name="attr_tired" value="1"/>
						</div>
					</div>
					<div class="sheet-row sheet-subheader-irritating">
						<div class="sheet-cell sheet-irritate">Irritating Conditions</div>
					</div>
					<div class="sheet-row sheet-row-irritating">
						<div class="sheet-cell sheet-coughing">
							<div class="sheet-popup">Coughing or Sneezing:</div>
							<span class="sheet-tooltip"><strong>Coughing or Sneezing:</strong><br />You are at -3 to DX and -1 to<br />IQ, and cannot use Stealth.<br />
							B428
							</span>
						</div>
						<div class="sheet-cell sheet-col0">
							<input type="checkbox" class="sheet-boolean" name="attr_coughing" value="1"/>
						</div>
						<div class="sheet-cell sheet-drowsy">
							<div class="sheet-popup">Drowsy:</div>
							<span class="sheet-tooltip"><strong>Drowsy:</strong><br />You are on the verge of falling asleep.<br />Make a Will roll every two hours you<br />spend inactive. On a failure, you fall<br />asleep, and sleep until you are awakened or get a full night’s sleep. On<br />a success, you have -2 to DX, IQ, and<br />self-control rolls.<br />
							B428
							</span>
						</div>
						<div class="sheet-cell sheet-col0">
							<input type="checkbox" class="sheet-boolean" name="attr_drowsy" value="1"/>
						</div>
						<div class="sheet-cell sheet-drunk">
							<div class="sheet-popup">Drunk:</div>
							<span class="sheet-tooltip"><strong>Drunk:</strong><br />You are highly intoxicated: -2 to DX and<br />IQ, and -4 to self-control rolls except<br />those to resist Cowardice. Reduce<br />Shyness by two levels, if you have it.<br />
							B428
							</span>
						</div>
						<div class="sheet-cell sheet-col0">
							<input type="checkbox" class="sheet-boolean" name="attr_drunk" value="1"/>
						</div>
						<div class="sheet-cell sheet-euphoria">
							<div class="sheet-popup">Euphoria:</div>
							<span class="sheet-tooltip"><strong>Euphoria:</strong><br />You have a -3 penalty to all DX,<br />IQ, skill, and self-control rolls.<br />
							B428
							</span>
						</div>
						<div class="sheet-cell sheet-col0">
							<input type="checkbox" class="sheet-boolean" name="attr_euphoria" value="1"/>
						</div>
						<div class="sheet-cell sheet-nauseated">
							<div class="sheet-popup">Nauseated:</div>
							<span class="sheet-tooltip"><strong>Nauseated:</strong><br />-2 to all attribute and skill rolls, and -1 to<br />active defenses. As well, roll vs. HT after<br />you eat, are exposed to a foul odor, fail<br />a Fright Check, or are stunned, and<br />every hour in free fall or in any situation<br />where you might suffer motion sickness.<br />A rich meal in the past hour gives -2;<br />anti-nausea remedies give +2. On a<br />failure, you vomit for <span name="attr_retchingtime"></span> seconds<br /> – treat as Retching, below.<br />
							B428
							</span>
						</div>
						<div class="sheet-cell sheet-col0">
							<input type="checkbox" class="sheet-boolean" name="attr_nauseated" value="1"/>
						</div>
						<div class="sheet-cell sheet-pain">
							<div class="sheet-popup">Pain:</div>
							<span class="sheet-tooltip"><strong>Pain:</strong><br />You have a penalty to all<br />DX, IQ, skill, and self-control rolls. This is<br />-2 for Moderate Pain,<br />-4 for Severe Pain, and<br />-6 for Terrible Pain.<br />High Pain Threshold halves these penalties;<br />Low Pain Threshold doubles them.<br />
							B428
							</span>
						</div>
						<div class="sheet-cell sheet-col0">
							<div class="sheet-popup"><input type="checkbox" name="attr_moderate_pain" class="sheet-boolean" value="-2"/></div>
							<span class="sheet-tooltip"><strong>Moderate Pain</strong></span>
						</div>
						<div class="sheet-cell sheet-col0">
							<div class="sheet-popup"><input type="checkbox" name="attr_severe_pain" class="sheet-boolean" value="-4"/></div>
							<span class="sheet-tooltip"><strong>Severe Pain</strong></span>
						</div>
						<div class="sheet-cell sheet-col0">
							<div class="sheet-popup"><input type="checkbox" name="attr_terrible_pain" class="sheet-boolean" value="-6"/></div>
							<span class="sheet-tooltip"><strong>Terrible Pain</strong></span>
						</div>
						<div class="sheet-cell sheet-typsy">
							<div class="sheet-popup">Tipsy:</div>
							<span class="sheet-tooltip"><strong>Tipsy:</strong><br />You are slightly intoxicated: -1 to DX and<br />IQ, and -2 to self-control rolls except<br />those to resist Cowardice. Reduce<br />Shyness by one level, if you have it.<br />
							B428
							</span>
						</div>
						<div class="sheet-cell sheet-col0">
							<input type="checkbox" class="sheet-boolean" name="attr_typsy" value="1"/>
						</div>
					</div>
					<div class="sheet-row sheet-subheader-incapaciting">
						<div class="sheet-cell sheet-incapaciting"><div class="sheet-popup">Incapacitating Conditions</div>
							<span class="sheet-tooltip"><i>All</i> of these afflictions prevent you<br />from taking voluntary action for the<br />duration. In addition to their other<br />effects, you’re effectively stunned (-4<br />to active defenses). In combat, you<br />must Do Nothing on your turn. If an<br />affliction lets you <i>drop</i>, you can sit,<br />kneel, go prone, etc. if standing, or go<br />prone if kneeling or sitting. If it<br />lets you <i>stagger</i>, you can drop, change<br />facing, or step or crawl one yard. In all<br />cases, you are still effectively stunned.<br />
							B428
							</span>
						</div>
					</div>
					<div class="sheet-row sheet-row-incapaciting">
						<div class="sheet-cell sheet-agony">
							<div class="sheet-popup">Agony:</div>
							<span class="sheet-tooltip"><strong>Agony:</strong><br />You are conscious but in such<br />terrible pain that you can do nothing<br />but moan or scream. If standing or<br />sitting, you fall down. While the<br />affliction endures, you lose 1 FP per<br />minute or fraction thereof.<br />
							B428
							</span>
						</div>
						<div class="sheet-cell sheet-col0">
							<input type="checkbox" class="sheet-boolean" name="attr_agony" value="1"/>
						</div>
						<div class="sheet-cell sheet-choking">
							<div class="sheet-popup">Choking:</div>
							<span class="sheet-tooltip"><strong>Choking:</strong><br />You are unable to breathe or speak.<br />You may do nothing but drop.<br />While the choking endures, you<br />suffer the effects of suffocation<br />(see Suffocation, p. 436).<br />
							B428
							</span>
						</div>
						<div class="sheet-cell sheet-col0">
							<input type="checkbox" class="sheet-boolean" name="attr_choking" value="1"/>
						</div>
						<div class="sheet-cell sheet-daze">
							<div class="sheet-popup">Daze:</div>
							<span class="sheet-tooltip"><strong>Daze:</strong><br />You are conscious – if you are standing,<br />you remain upright – but you can do<br />nothing. If you are struck, slapped, or<br />shaken, you recover on your next turn.<br />
							B428
							</span>
						</div>
						<div class="sheet-cell sheet-col0">
							<input type="checkbox" class="sheet-boolean" name="attr_dazed" value="1"/>
						</div>
						<div class="sheet-cell sheet-ecstasy">
							<div class="sheet-popup">Ecstasy:</div>
							<span class="sheet-tooltip"><strong>Ecstasy:</strong><br />You’re incapacitated with overwhelming<br />pleasure. Treat as Agony, but neither Low<br />Pain Threshold nor High Pain Threshold<br />has any effect – and instead of a bonus<br />for torture, someone offering to continue<br />the pleasure gets +3 to any Influence roll!<br />If you have Killjoy, you’re immune.<br />
							B428
							</span>
						</div>
						<div class="sheet-cell sheet-col0">
							<input type="checkbox" class="sheet-boolean" name="attr_ecstasy" value="1"/>
						</div>
						<div class="sheet-cell sheet-hallucinating">
							<div class="sheet-popup">Hallucinating:</div>
							<span class="sheet-tooltip"><strong>Hallucinating:</strong><br />You can try to act, but you must roll vs.<br />Will before each success roll. On a<br />success, you merely suffer 2d seconds of<br />disorientation. This gives -2 on success<br />rolls. On a failure, you actually hallucinate<br />for 1d minutes. In this case, the penalty is<br />-5. The GM is free to specify the details of<br />your hallucinations, which need not be<br />visual. On a critical failure, you “freak<br />out” for 3d minutes. You might do<br />anything! The GM rolls 3d: the higher the roll,<br />the more dangerous your action.<br />
							B429
							</span>
						</div>
						<div class="sheet-cell sheet-col0">
							<input type="checkbox" class="sheet-boolean" name="attr_hallucinating" value="1"/>
						</div>
						<div class="sheet-cell sheet-paralysis">
							<div class="sheet-popup">Paralysis:</div>
							<span class="sheet-tooltip"><strong>Paralysis:</strong><br />You cannot move any voluntary muscles,<br />and fall over if you are not in a balanced<br />position. You remain conscious, and can<br />still use advantages or spells that require<br />neither speech nor movement.<br />
							B429
							</span>
						</div>
						<div class="sheet-cell sheet-col0">
							<input type="checkbox" class="sheet-boolean" name="attr_paralyzed" value="1"/>
						</div>
						<div class="sheet-cell sheet-retching">
							<div class="sheet-popup">Retching:</div>
							<span class="sheet-tooltip"><strong>Retching:</strong><br />You are conscious but vomiting (or<br />suffering dry heaves). You can try to<br />act, but you will be at -5 to DX, IQ,<br />and Per, and automatically fail at any<br />action that requires a Concentrate<br />maneuver. At the end of the retching<br />spell, you lose 1 FP. You gain no<br />benefit from recent meals or oral<br />medication – you’ve thrown it up.<br />
							B429
							</span>
						</div>
						<div class="sheet-cell sheet-col0">
							<input type="checkbox" class="sheet-boolean" name="attr_retching" value="1"/>
						</div>
						<div class="sheet-cell sheet-seizure">
							<div class="sheet-popup">Seizure:</div>
							<span class="sheet-tooltip"><strong>Seizure:</strong><br />You suffer a fit of some kind. Your<br />limbs tremble uncontrollably, you<br />fall down if standing, and you<br />cannot speak or think clearly. You<br />can do <i>nothing.</i> At the end of the<br />seizure, you lose 1d FP.<br />
							B429
							</span>
						</div>
						<div class="sheet-cell sheet-col0">
							<input type="checkbox" class="sheet-boolean" name="attr_seizure" value="1"/>
						</div>
						<div class="sheet-cell sheet-unconsciousness">
							<div class="sheet-popup">Unconsciousness:</div>
							<span class="sheet-tooltip"><strong>Unconsciousness:</strong><br />You are knocked out, just as<br />if you had suffered injury.<br />
							B429
							</span>
						</div>
						<div class="sheet-cell sheet-col0">
							<input type="checkbox" class="sheet-boolean" name="attr_unconscious" value="1"/>
						</div>
					</div>
					<div class="sheet-row sheet-subheader-mortalconditions">
						<div class="sheet-cell sheet-mortalconditions">Mortal Conditions</div>
					</div>
					<div class="sheet-row sheet-row-mortalconditions">
						<div class="sheet-cell sheet-coma"><div class="sheet-popup">Coma:</div>
							<span class="sheet-tooltip"><strong>Coma:</strong><br />You collapse just as if you had been<br />wounded to -1xHP or below and<br />passed out; see <i>Recovering from<br />Unconsciousness</i> (p. 423). You get a<br />single HT roll to awaken after 12<br />hours. On a failure, you won’ recover<br />without medical treatment. Until you<br />receive treatment, roll vs. HT every 12<br />hours. On any failure, you <i>die.</i><br />
							B429
							</span>
						</div>
						<div class="sheet-cell sheet-col0">
							<input type="checkbox" class="sheet-boolean" name="attr_coma" value="1"/>
						</div>
						<div class="sheet-cell sheet-heartattack"><div class="sheet-popup">Heart Attack:</div>
							<span class="sheet-tooltip"><strong>Heart Attack:</strong><br />Your heart stops functioning<br />(“cardiac arrest”). You immediately<br />drop to -1xFP. Regardless of your<br />current HP, you will die in HT/3<br />minutes unless resuscitated – see<br /><i>Resuscitation</i> (p. 425).<br />
							B429
							</span>
						</div>
						<div class="sheet-cell sheet-col0">
							<input type="checkbox" class="sheet-boolean" name="attr_heart_attack" value="1"/>
						</div>
					</div>
				</div>
			</div>
			
			<!--========= WOUNDS BOX ==================-->

			<div class="sheet-box sheet-wounds-box">
				<div class="sheet-table">
					<div class="sheet-header">
						<div class="sheet-cell sheet-col0">Wounds</div>
					</div>
					<div class="sheet-subheader sheet-subheader-tablehead">
						<div class="sheet-cell sheet-woundlocation">
							Loc.
						</div>
						<div class="sheet-cell sheet-hpmax">
							<div class="sheet-popup">HP Max.</div><span class="sheet-tooltip">Maximum HP by location<br />Cripple<br />HP threshold to cripple location if applicable<br />B420</span>
						</div>
						<div class="sheet-cell sheet-hpcur">
							<div class="sheet-popup">HP Cur.</div><span class="sheet-tooltip">Current HP by location</span>
						</div>
						<div class="sheet-cell sheet-woundnotes">
							<div class="sheet-popup">Notes</div><span class="sheet-tooltip">Notes, eg. Major Wound.</span>
						</div>
					</div>
					<div class="sheet-row sheet-row-hit_location">
						<div class="sheet-cell sheet-woundlocation">
							Eye
						</div>
						<div class="sheet-cell sheet-hpmax">
							<input type="number" name="attr_ehp" value="0" readonly="readonly"/>
						</div>
						<div class="sheet-cell sheet-hpcur">
							<div class="sheet-cell sheet-split">
								<input type="number"  name="attr_lefteye_hit_points" value="1"/>
							</div>
							<div class="sheet-cell sheet-split">
								<input type="number" class="sheet-split" name="attr_righteye_hit_points" value="1"/>
							</div>
						</div>
						<div class="sheet-cell sheet-woundnotes">
							<input type="text" name="attr_eye_hit_points_notes" value="" placeholder="notes"/>
						</div>
					</div>	
					<div class="sheet-row sheet-row-hit_location">
						<div class="sheet-cell sheet-woundlocation">
							Skull
						</div>
						<div class="sheet-cell sheet-hpmax">
							<input type="number" name="attr_hit_points_max" value="10" readonly="readonly"/>
						</div>
						<div class="sheet-cell sheet-hpcur">
							<input type="number" name="attr_skull_hit_points" value="10"/>
						</div>
						<div class="sheet-cell sheet-woundnotes">
							<input type="text" name="attr_skull_hit_points_notes" value="" placeholder="notes"/>
						</div>
					</div>	
					<div class="sheet-row sheet-row-hit_location">
						<div class="sheet-cell sheet-woundlocation">
							Face
						</div>
						<div class="sheet-cell sheet-hpmax">
							<input type="number" name="attr_hit_points_max" value="10" readonly="readonly"/>
						</div>
						<div class="sheet-cell sheet-hpcur">
							<input type="number" name="attr_face_hit_points" value="10" />
						</div>
						<div class="sheet-cell sheet-woundnotes">
							<input type="text" name="attr_hit_points_notes" value="" placeholder="notes"/>
						</div>
					</div>	
					<div class="sheet-row sheet-row-hit_location">
						<div class="sheet-cell sheet-woundlocation">
							Right Leg
						</div>
						<div class="sheet-cell sheet-hpmax">
							<input type="number" name="attr_limbhp" value="10" readonly="readonly"/>
						</div>
						<div class="sheet-cell sheet-hpcur">
							<input type="number" name="attr_rightleg_hit_points" value="5"/>
						</div>
						<div class="sheet-cell sheet-woundnotes">
							<input type="text" name="attr_rightleg_hit_points_notes" value="" placeholder="notes"/>
						</div>
					</div>	
					<div class="sheet-row sheet-row-hit_location">	
						<div class="sheet-cell sheet-woundlocation">
							Right Arm
						</div>
						<div class="sheet-cell sheet-hpmax">
							<input type="number" name="attr_limbhp" value="5" readonly="readonly"/>
						</div>
						<div class="sheet-cell sheet-hpcur">
							<input type="number" name="attr_rightarm_hit_points" value="5"/>
						</div>
						<div class="sheet-cell sheet-woundnotes">
							<input type="text" name="attr_rightarm_hit_points_notes" value="" placeholder="notes"/>
						</div>
					</div>	
					<div class="sheet-row sheet-row-hit_location">
						<div class="sheet-cell sheet-woundlocation">
							Torso
						</div>
						<div class="sheet-cell sheet-hpmax">
							<input type="number" name="attr_hit_points_max" value="10" readonly="readonly"/>
						</div>
						<div class="sheet-cell sheet-hpcur">
							<input type="number" name="attr_hit_points" value="10"/>
						</div>
						<div class="sheet-cell sheet-woundnotes">
							<input type="text" name="attr_hit_points_notes" value="" placeholder="notes"/>
						</div>
					</div>
					<div class="sheet-row sheet-row-hit_location">
						<div class="sheet-cell sheet-woundlocation">
							Groin
						</div>
						<div class="sheet-cell sheet-hpmax">
							-
						</div>
						<div class="sheet-cell sheet-hpcur">
							-
						</div>
						<div class="sheet-cell sheet-woundnotes">
							<input type="text" name="attr_hit_points_notes" value="" placeholder="notes"/>
						</div>
					</div>	
					<div class="sheet-row sheet-row-hit_location">
						<div class="sheet-cell sheet-woundlocation">
							Left Arm
						</div>
						<div class="sheet-cell sheet-hpmax">
							<input type="number" name="attr_limbhp" value="5" readonly="readonly"/>
						</div>
						<div class="sheet-cell sheet-hpcur">
							<input type="number" name="attr_leftarm_hit_points" value="5"/>
						</div>
						<div class="sheet-cell sheet-woundnotes">
							<input type="text" name="attr_leftarm_hit_points_notes" value="" placeholder="notes"/>
						</div>
					</div>
					<div class="sheet-row sheet-row-hit_location">
						<div class="sheet-cell sheet-woundlocation">
							Left Leg
						</div>
						<div class="sheet-cell sheet-hpmax">
							<input type="number" name="attr_limbhp" value="5" readonly="readonly"/>
						</div>
						<div class="sheet-cell sheet-hpcur">
							<input type="number" name="attr_leftleg_hit_points" value="5"/>
						</div>
						<div class="sheet-cell sheet-woundnotes">
							<input type="text" name="attr_leftleg_hit_points_notes" value="" placeholder="notes"/>
						</div>
					</div>
					<div class="sheet-row sheet-row-hit_location">
						<div class="sheet-cell sheet-woundlocation">
							Hand
						</div>
						<div class="sheet-cell sheet-hpmax">
							<input type="number" name="attr_extremityhp" value="10" readonly="readonly"/>
						</div>
						<div class="sheet-cell sheet-hpcur">
							<div class="sheet-cell sheet-split">
								<input type="number" name="attr_lefthand_hit_points" value="3"/>
							</div>
							<div class="sheet-cell sheet-split">
								<input type="number" name="attr_righthand_hit_points" value="3"/>
							</div>
						</div>
						<div class="sheet-cell sheet-woundnotes">
							<input type="text" name="attr_hand_hit_points_notes" value="" placeholder="notes"/>
						</div>
					</div>
					<div class="sheet-row sheet-row-hit_location">
						<div class="sheet-cell sheet-woundlocation">
							Foot
						</div>
						<div class="sheet-cell sheet-hpmax">
							<input type="number" name="attr_extremityhp" value="10" readonly="readonly"/>
						</div>
						<div class="sheet-cell sheet-hpcur">
							<div class="sheet-cell sheet-split">
								<input type="number" name="attr_leftfoot_hit_points" value="3"/>
							</div>
							<div class="sheet-cell sheet-split">
								<input type="number" name="attr_rightfoot_hit_points" value="3"/>
							</div>
						</div>
						<div class="sheet-cell sheet-woundnotes">
							<input type="text" name="attr_foot_hit_points_notes" value="" placeholder="notes"/>
						</div>
					</div>
					<div class="sheet-row sheet-row-hit_location">
						<div class="sheet-cell sheet-woundlocation">
							Neck
						</div>
						<div class="sheet-cell sheet-hpmax">
							<input type="number" name="attr_hit_points_max" value="10" readonly="readonly"/>
						</div>
						<div class="sheet-cell sheet-hpcur">
							<input type="number" name="attr_neck_hit_points" value="10"/>
						</div>
						<div class="sheet-cell sheet-woundnotes">
							<input type="text" name="attr_neck_hit_points_notes" value="" placeholder="notes"/>
						</div>
					</div>
					<div class="sheet-row sheet-row-hit_location">
						<div class="sheet-cell sheet-woundlocation">
							Vitals
						</div>
						<div class="sheet-cell sheet-hpmax">
							<input type="number" name="attr_hit_points_max" value="10" readonly="readonly"/>
						</div>
						<div class="sheet-cell sheet-hpcur">
							<input type="number" name="attr_vitals_hit_points" value="10"/>
						</div>
						<div class="sheet-cell sheet-woundnotes">
							<input type="text" name="attr_vitals_hit_points_notes" value="" placeholder="notes"/>
						</div>
					</div>
					<div class="sheet-row sheet-row-hit_location">
						<div class="sheet-cell sheet-woundlocation">
							Area
						</div>
						<div class="sheet-cell sheet-hpmax">
							<input type="number" name="attr_area_hit_points_max" value="10"/>
						</div>
						<div class="sheet-cell sheet-hpcur">
							<input type="number" name="attr_area_hit_points" value="10"/>
						</div>
						<div class="sheet-cell sheet-woundnotes">
							<input type="text" name="attr_area_hit_points_notes" value="" placeholder="notes"/>
						</div>
					</div>
					<fieldset class="repeating_hitlocation">
						<div class="sheet-row sheet-row-hit_location">
							<div class="sheet-cell sheet-woundlocation">
								<input type="text" name="attr_loc_name" value="" placeholder="Where"/>
							</div>
							<div class="sheet-cell sheet-hpmax">
								<input type="number" name="attr_loc_HP_max" value="0"/>
							</div>
							<div class="sheet-cell sheet-hpcur">
								<input type="number" name="attr_loc_HP" value="0"/>
							</div>
							<div class="sheet-cell sheet-woundnotes">
								<input type="text" name="attr_loc_notes" value="" placeholder="notes"/>
							</div>
						</div>
					</fieldset>
				</div>
			</div>

		</div> <!-- _____ _____ END DAMAGE SUB TAB _____ _____ -->
		
		
		<!-- _____ _____ ACTIVE DEFENSE SUB TAB _____ _____ -->
		<div class="sheet-section sheet-section-activedefense">

			<!-- _____ _____ ACTIVE DEFENSE MODIFIERS BOX _____ _____ -->
			<div class="sheet-box sheet-AD-modifiers">
				<div class="sheet-table">
					<div class="sheet-header sheet-header-AD-modifiers">
						<div class="sheet-cell sheet-col0">
							<div class="sheet-popup">ACTIVE DEFENSE MODIFIERS:
							</div><span class="sheet-tooltip">When performing a dodge, block, or<br />parry, figure your active defense roll by:<br /><strong>1.</strong> Taking your calculated Dodge, Block,<br />or Parry score. (The Combat Reflexes<br />and Enhanced Defenses advantages<br />increase these values above their base.)<br /><strong>2.</strong> Applying the relevant conditional<br />modifiers below. All modifiers are<br />cumulative.</span>
						</div>
						<div class="sheet-cell sheet-reset">
							<button type="action" name="act_defense_reset" class="sheet-admod-reset">Reset</button>
						</div>
					</div> <!-- Row Header -->

					<div class="sheet-row sheet-row-AD-modifiers">
						<div class="sheet-cell sheet-sheilddb">
							<div class="sheet-popup">DB:</div><span class="sheet-tooltip"><strong>Shield or Cloak Defense Bonus</strong><br />DB from equipped shield<br />check box below to equip</span>
						</div>
						<div class="sheet-cell sheet-sheilddbnum sheet-readonly">
							<span name="attr_shield_defense_bonus"></span>
						</div>
						<div class="sheet-cell sheet-aboveatkr">
							<div class="sheet-popup">Above/Below:</div><span class="sheet-tooltip"><strong>Defender Above attacker</strong> + difference above attacker<br /><strong>Defender below attacker</strong> - difference below attacker<br /></span>
						</div>
						<div class="sheet-cell sheet-aboveatkrsel">
							<select name="attr_defend_verticaldiff">
								<option value="0" selected="selected">&lt;3'</option>
								<option value="1">+3'</option>
								<option value="2">+4'</option>
								<option value="3">+5'</option>
								<option value="-1">-3'</option>
								<option value="-2">-4'</option>
								<option value="-3">-5'</option>
							</select>
						</div>
						<div class="sheet-cell sheet-badfoot">
							<div class="sheet-popup">Bad footing:</div><span class="sheet-tooltip"><strong>Bad footing: </strong> -1 or more (GM’s option)</span>
						</div>
						<div class="sheet-cell sheet-badfootnum">
							<input type="number" name="attr_defend_badfoot" value="0" step="1" max="0" min="-10" />
						</div>
						<div class="sheet-cell sheet-cantseeatkr">
							<div class="sheet-popup">Can't see attacker:</div><span class="sheet-tooltip"><strong>Can't see attacker: -4</strong><br />Block or parry requires a Hearing -2 roll</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="checkbox" class="sheet-boolean" name="attr_cantseeattacker" value="-4" />
						</div>
						<div class="sheet-cell sheet-defdistract">
							<div class="sheet-popup">Distraction:</div><span class="sheet-tooltip"><strong>Distraction:</strong><br />(e.g., clothes on fire): <br />-1 or more (GM’s option)</span>
						</div>
						<div class="sheet-cell sheet-defdistractnum">
							<input type="number" name="attr_defdistracted" value="0" min="-10" max="0" step="1" />
						</div>
						<div class="sheet-cell sheet-defencumbered">
							<div class="sheet-popup">Encumbered:</div><span class="sheet-tooltip"><strong>Encumbered:</strong><br />penalty equal to encumbrance<br />level to Dodge, or to Judo,<br />Karate, or any fencing Parry<br />B17</span>
						</div>
						<div class="sheet-cell sheet-defencumberednum">
							<input type="number" name="attr_defend_encumbrance_penalty" readonly="readonly">
						</div>
						<div class="sheet-cell sheet-defmount">
							<div class="sheet-popup">Mounted:</div><span class="sheet-tooltip"><strong>Defender Mounted</strong><br />penalty equal to difference<br />between 12 and Riding skill<br />(no penalty for Riding at 12+)</span>
						</div>
						<div class="sheet-cell sheet-defmountnum">
							<input type="number" name="attr_ad_mounted" value="0" step="1" min="-10" max="0" />
						</div>
						<div class="sheet-cell sheet-multi">
							<div class="sheet-popup">Multi:</div><span class="sheet-tooltip"><strong>Multiple Parries:</strong><br />Enter number of<br />parries -4 to<br />Parry per parry after the<br />first, cumulative</span>
						</div>
						<div class="sheet-cell sheet-multiparry">
							<input type="number" name="attr_multiparry" value="0" step="1"/>
						</div>
					</div> <!-- Row -->

					<div class="sheet-subheader sheet-naturesubhead">
						<div class="sheet-cell sheet-natureofattack">
							Nature of the Attack
						</div>
					</div> <!-- Row SubHeadr -->

					<div class="sheet-row sheet-row-AD-modifiers">
						<div class="sheet-cell sheet-defendbehind">
							<div class="sheet-popup">From Behind:</div><span class="sheet-tooltip"><strong>Attacked from Behind</strong><br />No defense possible<br />w. Peripheral Vision: -2<br />B74</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="checkbox" class="sheet-boolean" name="attr_frombehind" value="-2" />
						</div>
						<div class="sheet-cell sheet-defendflank">
							<div class="sheet-popup">From Flank:</div><span class="sheet-tooltip"><strong>Attacked from the Side:</strong> -2<br />w. Peripheral Vision: -0<br />B74</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="checkbox" class="sheet-boolean" name="attr_fromside" value="-2" />
						</div>
						<div class="sheet-cell sheet-defendlaser">
							<div class="sheet-popup">Laser sight:</div><span class="sheet-tooltip"><strong>Attacker used laser sight:</strong><br />+1 to Dodge if dot is visible</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="checkbox" class="sheet-boolean" name="attr_defendlaser" value="1" />
						</div>
						<div class="sheet-cell sheet-defenddeceptive">
							<div class="sheet-popup">Deceptive Attack:</div><span class="sheet-tooltip"><strong>Deceptive Attack:</strong><br />-1 per -2 the attacker<br />took to his attack</span>
						</div>
						<div class="sheet-cell sheet-defencumberednum">
							<input type="number" min="-10" max="0" name="attr_defenddeceptive" value="0" />
						</div>
						<div class="sheet-cell sheet-defendunarmed">
							<div class="sheet-popup">Unarmed</div><span class="sheet-tooltip"><strong>Unarmed:</strong><br />Attacker is unarmed</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="checkbox" name="attr_unarmedattacker" value="1" class="sheet-boolean" />
						</div>
						<div class="sheet-cell sheet-defenddual">
							<div class="sheet-popup">Dual-Weapon:</div><span class="sheet-tooltip"><strong>Dual-Weapon Attack:</strong><br />-1 if both attacks strike<br />the same target<br />B417</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="checkbox" class="sheet-boolean" name="attr_dual" value="-1" />
						</div>

						<div class="sheet-cell sheet-defend_flail">
							<div class="sheet-popup">Flail:</div><span class="sheet-tooltip"><strong>Flail: </strong><br />-4 to Parry/-2 to Block<br />(-2/-1 vs. nunchaku);<br />fencing weapons can’t parry at all</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="checkbox" class="sheet-boolean" name="attr_defendflail" value="1" />
						</div>
						<div class="sheet-cell sheet-defendfeint">
							<div class="sheet-popup">Feint:</div><span class="sheet-tooltip"><strong>Successful feint:</strong><br />penalty equal to<br />attacker’s margin<br />of victory<br />B231, B365, MA73</span>
						</div>
						<div class="sheet-cell sheet-defendfeintnum">
							<input type="number" name="attr_defendfeint" min="-10" max="0" value="0" />
						</div>
						<div class="sheet-cell sheet-defendthrown">
							<div class="sheet-popup">Thrown:</div><span class="sheet-tooltip"><strong>Thrown weapon: </strong><br />-1 to Parry<br />or -2 to Parry if small<br />(1 lb. or less)</span>
						</div>
						<div class="sheet-cell sheet-defendthrownselect">
							<select name="attr_parrythrown">
								<option value="0">n/a</option>
								<option value="-1">&gt;1 lb</option>
								<option value="-2">&lt;=1 lb</option>
							</select>
						</div>
					</div> <!-- Row -->

					<div class="sheet-subheader sheet-defense-options-subhead">
						<div class="sheet-cell sheet-defense-options">
						Defense Options
						</div>
					</div>	<!-- Row SubHeader -->

					<div class="sheet-row sheet-row-AD-modifiers">
						<div class="sheet-cell sheet-acrododge">
							<div class="sheet-popup">Acrobatic Dodge:</div><span class="sheet-tooltip"><strong>Acrobatic Dodge:</strong><br />+2 to Dodge if Acrobatics roll succeeds, -2 if it fails</span>
						</div>
						<div class="sheet-cell sheet-acrododgena">
							<div class="sheet-popup">N/A:</div><span class="sheet-tooltip">No Acrobatics Roll</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="radio" class="sheet-modifier" name="attr_defendacrobatic" value="0" checked />
						</div>			
						<div class="sheet-cell sheet-acrododgey">
							<div class="sheet-popup">Yes:</div><span class="sheet-tooltip">Acrobatics Roll Successful</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="radio" class="sheet-modifier" name="attr_defendacrobatic" value="2" />
						</div>
							<div class="sheet-cell sheet-acrododgen">
							<div class="sheet-popup">No:</div><span class="sheet-tooltip">Acrobatics Roll Failed</span>
						</div>	
						<div class="sheet-cell sheet-checkboxbox">
							<input type="radio" class="sheet-modifier" name="attr_defendacrobatic" value="-2" />
						</div>
	
						<div class="sheet-cell sheet-feverish">
							<div class="sheet-popup">Feverish:</div><span class="sheet-tooltip"><strong>Feverish Defense:</strong><br />+2 (costs 1 FP)</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="checkbox" class="sheet-boolean" name="attr_feverish" value="2" />
						</div>
							<div class="sheet-cell sheet-crossparry">
								<div class="sheet-popup">Cross Parry:</div><span class="sheet-tooltip"><strong>Cross Parry:</strong><br />If you have two ready melee weapons, you can commit both to a single parry<br />To attempt a Cross Parry, both hands must be able to parry. Work out what your<br />Parry would be with either hand, applying all the usual modifiers<br />Your Parry is the better of the two modified scores, +2 for the extra support.<br />MA121</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="checkbox" class="sheet-boolean" name="attr_crossparry" value="2">
						</div>
						<div class="sheet-cell sheet-dodgedrop">
							<div class="sheet-popup">Drop:</div><span class="sheet-tooltip"><strong>Dodge and Drop:</strong><br />+3 to Dodge vs. ranged attack</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="checkbox" class="sheet-boolean" name="attr_dodgeanddrop" value="3" />
						</div>
						<div class="sheet-cell sheet-retreat">
							<div class="sheet-popup">Retreat:</div><span class="sheet-tooltip"><strong>Retreat:</strong><br />“Retreat” is not a separate defense, but an option you<br />may add to any active defense against a melee attack<br /><strong>Options:</strong><br />Retreat: gives +3 to Dodge, or +1 to Block or Parry.<br />Exception: a parry using Boxing, Judo, Karate, or any<br />fencing skill retreat gives +3 to Parry<br />Dive: If you’re standing or kneeling dive under an attack.<br />This leaves you prone. -1 + bonus<br />Sideslip: If standing, step aside w/o retreating to let the<br />attack pass through your former position -1 + bonus<br />Slip: close the gap between you and your foe as you<br />evade or deflect his attack -2 + bonus<br /><br />You can combine any of these options with Acrobatics<br />B377, MA123-124</span>
						</div>
						<div class="sheet-cell sheet-retreat-drop-down">
							<select name="attr_retreat">
								<option value="0" selected >No Retreat</option>
								<option value="1">Retreat</option>
								<option value="2">Dive</option>
								<option value="3">Sideslip</option>
								<option value="4">Slip</option>
							</select>
						</div>
						<div class="sheet-cell sheet-riposte">
							<div class="sheet-popup">Riposte:</div><span class="sheet-tooltip"><strong>Riposte:</strong><br />Take a penalty to your Parry (min. of 8), not<br />including modifiers. If Parry succeeds and you attack<br /> using the parrying weapon next turn, apply the<br />same penalty to your foes Parry (hand or weapon),<br />Block (shield) or Dodge (non-hand unarmed strike)<br />or half that penalty to all other defenses. You <i>can</i> retreat.<br />
							MA124</span>
						</div>
						<div class="sheet-cell sheet-ripostenum">
							<input name="attr_riposte" type="number" min="-10" max="0" value="0" step="1" />
						</div>
					</div>	<!-- Row -->

				</div> <!-- Table -->
			</div> <!-- Box -->
						
			<!-- _____ _____ ACTIVE DFENSE BOX _____ _____ -->
			<div class="sheet-box sheet-box-active-defense">
				<div class="sheet-table">
					<div class="sheet-header sheet-header-active-defense">
						<div class="sheet-cell sheet-defensename">
							<div class="sheet-popup">Active Defense</div><span class="sheet-tooltip">An active attempt to avoid an attack: a block, dodge, or parry. See p. 374.</span>
						</div>
						<div class="sheet-cell sheet-defensetype">
							<div class="sheet-popup">Type</div><span class="sheet-tooltip">There are three “active<br />defenses” that a fighter can<br />use to evade or ward off an<br />attack: Dodge (B374), Parry<br />(B376), and Block (B375).</span>
						</div>
						<div class="sheet-cell sheet-defensebonus">
							<div class="sheet-popup">Bonus</div><span class="sheet-tooltip">Enter any permanent<br />bonuses not listed above.<br />ex. Enhanced Dodge.</span>
						</div>
						<div class="sheet-cell sheet-defenselvl">
							<div class="sheet-popup">SL</div><span class="sheet-tooltip" ><strong>Skill Level:</strong><br />Your actual level in a skill,<br />as recorded on your character sheet.</span>
						</div>
						<div class="sheet-cell sheet-defensemods">
							<div class="sheet-popup">Mods</div><span class="sheet-tooltip"><strong>Modifiers:</strong><br />Applied relevant conditional modifiers.<br />All modifiers are cumulative.</span>
						</div>
						<div class="sheet-cell sheet-defenseesl">
							<div class="sheet-popup">ESL</div><span class="sheet-tooltip"><strong>Effective Skill Level:</strong><br />Your base skill plus<br />or minus any modifiers for<br />the task at hand.<br />B171</span>
						</div>
					</div> <!-- .sheet-header -->

					<div class="sheet-row sheet-row-active-defense sheet-dodge">
						<div class="sheet-cell sheet-col0">
							<button class="sheet-roll-button" type="roll" name="attr_Dodge_roll" value="!dodge @{character_id} Dodge [[@{dodge_esl} + @{modifier}]]"></button>
						</div>
						<div class="sheet-cell sheet-col1">
							Dodge
						</div>
						<div class="sheet-cell sheet-col2">
							Dodge
						</div>
						<div class="sheet-cell sheet-col3">
							<input type="number" name="attr_dodge_bonus" value="0" />
						</div>
						<div class="sheet-cell sheet-col4 sheet-readonly">
							<input name="attr_dodge" value="0" readonly="readonly" />
						</div>
						<div class="sheet-cell sheet-col4">
								<input type="number" name="attr_dodgedefense_mods" value="0" readonly="readonly" />
							</div>
						<div class="sheet-cell sheet-col5 sheet-readonly">
							<input name="attr_dodge_esl" value="0" readonly="readonly" />
						</div>
					</div> <!-- .sheet-row -->

					<fieldset class="repeating_defense">
						<input class="sheet-toggle" type="checkbox" />
						<span class="sheet-checkbox"></span>
						<div class="sheet-row sheet-row-active-defense">
							<div class="sheet-cell sheet-col0">
								<button class="sheet-roll-button" type="roll" name="attr_defense_roll" value="!def @{character_id} @{rowid} [[@{esl} + @{modifier}]] [[@{notes_onoff}]] defense"></button>
							</div>
							<div class="sheet-cell sheet-col1">
								<input type="text" name="attr_name" placeholder="Defense Name" />
							</div>
							<div class="sheet-cell sheet-col2">
								<select name="attr_adtype">
									<option value="Block">Block</option>
									<option value="Dodge">Dodge</option>
									<option value="Parry">Parry</option>
								</select>
							</div>
							<div class="sheet-cell sheet-col3">
								<input type="number" name="attr_ad_bonus" value="0" />
							</div>
							<div class="sheet-cell sheet-col4">
								<input type="number" name="attr_lvl" value="0"/>
							</div>
							<div class="sheet-cell sheet-col4">
								<input type="number" name="attr_defense_mods" value="0" readonly="readonly" />
							</div>
							<div class="sheet-cell sheet-col4 sheet-readonly">
								<input name="attr_esl" value="0" readonly="readonly" />
							</div>
						</div> <!-- .sheet-row -->
						
						<div class="sheet-row sheet-row-details">
							<div class="sheet-cell sheet-col0">
								<div class="sheet-popup"><input type="checkbox" class="sheet-boolean" name="attr_notes_onoff" value="1" checked="checked" />
								</div><span class="sheet-tooltip">Check to display notes in rolls</span>
							</div>
							<div class="sheet-cell sheet-col1">
								<textarea name="attr_notes" placeholder="notes"></textarea>
							</div>
						</div> <!-- Row Row Details -->

						<div class="sheet-row sheet-row-details-rowid">
							<div class="sheet-cell sheet-rowid">
								RowID For Macros
								<input name="attr_rowid" value="" readonly="readonly" />
							</div>
							<div class="sheet-cell sheet-fencing">
								<div class="sheet-cell sheet-subcell">
									<div class="sheet-popup">Fencing</div><span class="sheet-tooltip"><strong>Fencing Weapon:</strong><br />Check "Yes" if a fencing weapon.<br />Halves the cumulative<br />penalty (-4) for multiple<br />parries after the first.</span>
								</div>
								<div class="sheet-cell sheet-subcell">
									<div class="sheet-cell sheet-fence">
										<div class="sheet-popup"><input type="radio" name="attr_martialart" value="1" /></div><span class="sheet-tooltip"><strong>Yes</strong></span>
									</div>
									<div class="sheet-cell sheet-fence">
										<div class="sheet-popup"><input type="radio" name="attr_martialart" value="0" checked /></div><span class="sheet-tooltip"><strong>No</strong></span>
									</div>
								</div>
							</div>
							<div class="sheet-cell sheet-unarmedmartial">
								<div class="sheet-cell sheet-subcell">
									Unarmed Combat Skills
								</div>
								<div class="sheet-cell sheet-subcell">
									<div class="sheet-cell sheet-art">
										<div class="sheet-popup"><input type="radio" name="attr_martialart" value="2" /></div><span class="sheet-tooltip"><strong>Boxing</strong><br />Boxing allows you to parry two different attacks per<br />turn, one with each hand Parries -2 vs. kicks, -3 vs.<br />weapons other than thrusting attacks. Boxing also<br />gives an improved retreating bonus when you parry.<br />B182</span>
									</div>
									<div class="sheet-cell sheet-art">
										<div class="sheet-popup"><input type="radio" name="attr_martialart" value="3" /></div><span class="sheet-tooltip"><strong>Brawling</strong><br />Brawling allows you to parry two different attacks<br />per turn, one with each hand Parries are at -3 vs.<br />weapons other than thrusting attacks.<br />B182</span>
									</div>
									<div class="sheet-cell sheet-art">
										<div class="sheet-popup"><input type="radio" name="attr_martialart" value="4" /></div><span class="sheet-tooltip"><strong>Judo</strong><br />Judo allows you to parry two different attacks per<br />turn one with each hand. This parry is not at the<br />usual -3 for parrying a weapon. Also gives an<br />improved retreating bonus when you parry.<br />B203</span>
									</div>
									<div class="sheet-cell sheet-art">
										<div class="sheet-popup"><input type="radio" name="attr_martialart" value="5" /></div><span class="sheet-tooltip"><strong>Karate</strong><br />Karate allows you to parry two different attacks<br />per turn. This parry is not at the usual -3 for<br />parrying a weapon barehanded Also gives an<br />improved retreating bonus when you parry.<br />B203</span>
									</div>
									<div class="sheet-cell sheet-art">
										<div class="sheet-popup"><input type="radio" name="attr_martialart" value="6" /></div><span class="sheet-tooltip"><strong>Sumo Wrestling</strong><br />Sumo Wrestling allows you to parry once<br />per turn. You must use both hands. You<br />parry at -2 vs. kicks and -3 vs. weapons.<br />B223</span>
									</div>
									<div class="sheet-cell sheet-art">
										<div class="sheet-popup"><input type="radio" name="attr_martialart" value="7" /></div><span class="sheet-tooltip"><strong>Wrestling</strong><br />Wrestling allows you to parry once per turn. You<br />must use both hands You parry at -3 vs. weapons.<br />B228</span>
									</div>
								</div>
							</div>
							<div class="sheet-cell sheet-pwield">
								<div class="sheet-popup">Primary</div><span class="sheet-tooltip"><strong>Hand Equipped</strong><br />Check which hand<br />weilded in</span>
								<input type="radio" name="attr_wield" value="1" checked />
							</div>
							<div class="sheet-cell sheet-wield">
								Off-hand
								<input type="radio" name="attr_wield" value= "0" />
							</div>
							<div class="sheet-cell sheet-bwield">
								Both
								<input type="radio" name="attr_wield" value="2" />
							</div>
							<div class="sheet-cell sheet-weapon-type">
								<div class="sheet-cell sheet-subcell">
									Weapon Type
								</div>
								<div class="sheet-cell sheet-subcell">
									<div class="sheet-cell sheet-deftype">
										<div class="sheet-popup"><input type="radio" name="attr_defendweapontype" value="0" checked /></div><span class="sheet-tooltip" ><strong>Other</strong><br />Equipped w. weapon other<br />than, dagger, knife, kusari,<br />quaterstaff, or whip.</span>
									</div>
									<div class="sheet-cell sheet-deftype">
										<div class="sheet-popup"><input type="radio" name="attr_defendweapontype" value="-1" /></div><span class="sheet-tooltip" ><strong>Dagger</strong><br />Equipped w.<br />dagger or knife:<br />-1 to parry</span>
									</div>
									<div class="sheet-cell sheet-deftype">
										<div class="sheet-popup"><input type="radio" name="attr_defendweapontype" value="2" /></div><span class="sheet-tooltip" ><strong>Quarterstaff</strong><br />Equipped w.<br />quarterstaff:<br />+2 to parry</span>
									</div>
									<div class="sheet-cell sheet-deftype">
										<div class="sheet-popup"><input type="radio" name="attr_defendweapontype" value="-2" /></div><span class="sheet-tooltip" ><strong>Whip</strong><br />Equipped w.<br />kusari or whip:<br />-2 to parry</span>
									</div>
								</div>
							</div> <!-- Row RowID -->
							<div class="sheet-hidden">
								<input type="number" name="attr_defense_offhand" value="0" readonly="readonly" />
								<input type="number" name="attr_mpp" value="0" readonly="readonly" />
								<input type="number" name="attr_flailpenalty" value="0" readonly="readonly" />
								<input type="number" name="attr_retreatpenalty" value="0" readonly="readonly" />
								<input type="number" name="attr_unarmedparry" value="0" readonly="readonly" />
							</div>
						</div>
					</fieldset>
				</div>
			</div>

			
			<!-- _____ _____ PASSIVE DEFENSE BOX _____ _____ -->

			<div class="sheet-box sheet-damageresist-box">
				<div class="sheet-table sheet-damage_resistance">
					<div class="sheet-header">
						<div class="sheet-cell sheet-col0">Damage Resistance</div>
					</div>
					<input type="radio" class="sheet-damageresist-box sheet-drchoice_a" name="attr_damage-box" value="0" checked="checked" />
					<input type="radio" class="sheet-damageresist-box sheet-drchoice_b" name="attr_damage-box" value="1" />
					<input type="radio" class="sheet-damageresist-box sheet-drchoice_c" name="attr_damage-box" value="2" />
				<!-- SPAN DRCHOICE_A BEGIN -->
					<span class="sheet-damageresist sheet-drchoice_a">
						<!-- DR TABLE BEGIN-->
						<div class="sheet-row sheet-row-loadoutname">
							<div class="sheet-cell sheet-col0"><input type="text" name="attr_name_dr_loadout_a" value="" placeholder="Loadout 1" /></div>
						</div> <!-- .sheet-header -->
						<div class="sheet-subheader">
							<div class="sheet-cell sheet-col0">
								Roll
							</div>
							<div class="sheet-cell sheet-col1">
								Where
							</div>
							<div class="sheet-cell sheet-col2">
								-
							</div>
							<div class="sheet-cell sheet-col3">
								<div class="sheet-popup">DR</div><span class="sheet-tooltip">Split DR for <br />layered
									protection</span>
							</div>
						</div> <!-- .sheet-header -->
						<div class="sheet-row sheet-row-DR">
							<!-- Eyes -->
							<div class="sheet-cell sheet-col0">
								-
							</div>
							<div class="sheet-cell sheet-col1">
								Eye
							</div>
							<div class="sheet-cell sheet-col2">
								-9
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_eyes_a_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_eyes_a_dr" value="0"/>
							</div>						
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<!-- Skull -->
							<div class="sheet-cell sheet-col0">
								3-4
							</div>
							<div class="sheet-cell sheet-col1">
								Skull
							</div>
							<div class="sheet-cell sheet-col2">
								-7
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_skull_a_dr_max" value="2" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_skull_a_dr" value="0"/>
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<!-- Face -->
							<div class="sheet-cell sheet-col0">
								5
							</div>
							<div class="sheet-cell sheet-col1">
								Face
							</div>
							<div class="sheet-cell sheet-col2">
								-5
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_face_a_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_face_a_dr" value="0" />
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR"> 
							<!-- Right Leg -->
							<div class="sheet-cell sheet-col0">
								6-7
							</div>
							<div class="sheet-cell sheet-col1">
								Right Leg
							</div>
							<div class="sheet-cell sheet-col2">
								-2
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_rtleg_a_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_rtleg_a_dr" value="0" />
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<!-- Right Arm -->
							<div class="sheet-cell sheet-col0">
								8
							</div>
							<div class="sheet-cell sheet-col1">
								Right Arm
							</div>
							<div class="sheet-cell sheet-col2">
								-2
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_rtarm_a_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_rtarm_a_dr" value="0"/>
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<div class="sheet-cell sheet-col0">
								9-10
							</div>
							<div class="sheet-cell sheet-col1">
								Torso
							</div>
							<div class="sheet-cell sheet-col2">
								0
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_torso_a_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_torso_a_dr" value="0"/>
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<div class="sheet-cell sheet-col0">
								11
							</div>
							<div class="sheet-cell sheet-col1">
								Groin
							</div>
							<div class="sheet-cell sheet-col2">
								-3
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_groin_a_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_groin_a_dr" value="0" />
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<div class="sheet-cell sheet-col0">
								12
							</div>
							<div class="sheet-cell sheet-col1">
								Left Arm
							</div>
							<div class="sheet-cell sheet-col2">
								-2
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_ltarm_a_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_ltarm_a_dr" value="0"/>
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<div class="sheet-cell sheet-col0">
								13-14
							</div>
							<div class="sheet-cell sheet-col1">
								Left Leg
							</div>
							<div class="sheet-cell sheet-col2">
								-2
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_ltleg_a_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_ltleg_a_dr" value="0" />
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<div class="sheet-cell sheet-col0">
								15
							</div>
							<div class="sheet-cell sheet-col1">
								Hand
							</div>
							<div class="sheet-cell sheet-col2">
								-4
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_hands_a_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_hands_a_dr" value="0"/>
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<div class="sheet-cell sheet-col0">
								16
							</div>
							<div class="sheet-cell sheet-col1">
								Foot
							</div>
							<div class="sheet-cell sheet-col2">
								-4
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_feet_a_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_feet_a_dr" value="0" />
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<div class="sheet-cell sheet-col0">
								17-18
							</div>
							<div class="sheet-cell sheet-col1">
								Neck
							</div>
							<div class="sheet-cell sheet-col2">
								-5
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_neck_a_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_neck_a_dr" value="0" />
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<div class="sheet-cell sheet-col0">
								-
							</div>
							<div class="sheet-cell sheet-col1">
								Vitals
							</div>
							<div class="sheet-cell sheet-col2">
								-3
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_vitals_a_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_vitals_a_dr" value="0" />
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<div class="sheet-cell sheet-col0">
								-
							</div>
							<div class="sheet-cell sheet-col1">
								Area
							</div>
							<div class="sheet-cell sheet-col2">
								-
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_area_dr_a" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_area_dr_b" value="0" />
							</div>
						</div> <!-- .sheet-row -->
						<fieldset class="repeating_dra">
						<div class="sheet-row sheet-row-DR">
							<div class="sheet-cell sheet-col0">
								<input type="text" name="attr_roll_a" placeholder="1-2" />
							</div>
							<div class="sheet-cell sheet-col1">
								<input type="text" name="attr_name_dr_a" placeholder="Where" />
							</div>
							<div class="sheet-cell sheet-col2">
								<input type="text" name="attr_penalty_dr_a" placeholder="-2" />
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_user_dr_a" value="" placeholder="0"/>
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_user_dr_b" value="" placeholder="0"/>
							</div>
						</div> <!-- .sheet-row -->
						</fieldset>
					</span>
					<span class="sheet-damageresist sheet-drchoice_b">
						<!-- DR TABLE BEGIN-->
						<div class="sheet-row sheet-row-loadoutname">
							<div class="sheet-cell sheet-col0"><input type="text" name="attr_name_dr_loadout_b" value="" placeholder="Loadout 2" /></div>
						</div> <!-- .sheet-header -->
						<div class="sheet-subheader">
							<div class="sheet-cell sheet-col0">
								Roll
							</div>
							<div class="sheet-cell sheet-col1">
								Where
							</div>
							<div class="sheet-cell sheet-col2">
								-
							</div>
							<div class="sheet-cell sheet-col3">
								<div class="sheet-popup">DR</div><span class="sheet-tooltip">Split DR for <br />layered
									protection</span>
							</div>
						</div> <!-- .sheet-header -->
						<div class="sheet-row sheet-row-DR">
							<!-- Eyes -->
							<div class="sheet-cell sheet-col0">
								-
							</div>
							<div class="sheet-cell sheet-col1">
								Eye
							</div>
							<div class="sheet-cell sheet-col2">
								-9
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_eyes_b_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_eyes_b_dr" value="0"/>
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<!-- Skull -->
							<div class="sheet-cell sheet-col0">
								3-4
							</div>
							<div class="sheet-cell sheet-col1">
								Skull
							</div>
							<div class="sheet-cell sheet-col2">
								-7
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_skull_b_dr_max" value="2" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_skull_b_dr" value="0"/>
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<!-- Face -->
							<div class="sheet-cell sheet-col0">
								5
							</div>
							<div class="sheet-cell sheet-col1">
								Face
							</div>
							<div class="sheet-cell sheet-col2">
								-5
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_face_b_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_face_b_dr" value="0" />
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR"> 
							<!-- Right Leg -->
							<div class="sheet-cell sheet-col0">
								6-7
							</div>
							<div class="sheet-cell sheet-col1">
								Right Leg
							</div>
							<div class="sheet-cell sheet-col2">
								-2
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_rtleg_b_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_rtleg_b_dr" value="0" />
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<!-- Right Arm -->
							<div class="sheet-cell sheet-col0">
								8
							</div>
							<div class="sheet-cell sheet-col1">
								Right Arm
							</div>
							<div class="sheet-cell sheet-col2">
								-2
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_rtarm_b_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_rtarm_b_dr" value="0"/>
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<div class="sheet-cell sheet-col0">
								9-10
							</div>
							<div class="sheet-cell sheet-col1">
								Torso
							</div>
							<div class="sheet-cell sheet-col2">
								0
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_torso_b_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_torso_b_dr" value="0"/>
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<div class="sheet-cell sheet-col0">
								11
							</div>
							<div class="sheet-cell sheet-col1">
								Groin
							</div>
							<div class="sheet-cell sheet-col2">
								-3
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_groin_b_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_groin_b_dr" value="0" />
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<div class="sheet-cell sheet-col0">
								12
							</div>
							<div class="sheet-cell sheet-col1">
								Left Arm
							</div>
							<div class="sheet-cell sheet-col2">
								-2
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_ltarm_b_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_ltarm_b_dr" value="0"/>
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<div class="sheet-cell sheet-col0">
								13-14
							</div>
							<div class="sheet-cell sheet-col1">
								Left Leg
							</div>
							<div class="sheet-cell sheet-col2">
								-2
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_ltleg_b_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_ltleg_b_dr" value="0" />
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<div class="sheet-cell sheet-col0">
								15
							</div>
							<div class="sheet-cell sheet-col1">
								Hand
							</div>
							<div class="sheet-cell sheet-col2">
								-4
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_hands_b_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_hands_b_dr" value="0"/>
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<div class="sheet-cell sheet-col0">
								16
							</div>
							<div class="sheet-cell sheet-col1">
								Foot
							</div>
							<div class="sheet-cell sheet-col2">
								-4
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_feet_b_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_feet_b_dr" value="0" />
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<div class="sheet-cell sheet-col0">
								17-18
							</div>
							<div class="sheet-cell sheet-col1">
								Neck
							</div>
							<div class="sheet-cell sheet-col2">
								-5
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_neck_b_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_neck_b_dr" value="0" />
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<div class="sheet-cell sheet-col0">
								-
							</div>
							<div class="sheet-cell sheet-col1">
								Vitals
							</div>
							<div class="sheet-cell sheet-col2">
								-3
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_vitals_b_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_vitals_b_dr" value="0" />
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<div class="sheet-cell sheet-col0">
								-
							</div>
							<div class="sheet-cell sheet-col1">
								Area
							</div>
							<div class="sheet-cell sheet-col2">
								-
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_area_dr_b" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_area_dr_b" value="0" />
							</div>
						</div> <!-- .sheet-row -->
						<fieldset class="repeating_drb">
						<div class="sheet-row sheet-row-DR">
							<div class="sheet-cell sheet-col0">
								<input type="text" name="attr_roll_b" placeholder="1-2" />
							</div>
							<div class="sheet-cell sheet-col1">
								<input type="text" name="attr_name_dr_b" placeholder="Where" />
							</div>
							<div class="sheet-cell sheet-col2">
								<input type="text" name="attr_penalty_dr_b" placeholder="-2" />
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_user_dr_b" value="" placeholder="0"/>
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_user_dr_b" value="" placeholder="0"/>
							</div>
						</div> <!-- .sheet-row -->
						</fieldset>
					</span> <!-- DR Choice B -->
					<span class="sheet-damageresist sheet-drchoice_c">
						<!-- DR TABLE BEGIN-->
						<div class="sheet-row sheet-row-loadoutname">
							<div class="sheet-cell sheet-col0"><input type="text" name="attr_name_dr_loadout_c" value="" placeholder="Loadout 3" /></div>
						</div> <!-- .sheet-header -->
						<div class="sheet-subheader">
							<div class="sheet-cell sheet-col0">
								Roll
							</div>
							<div class="sheet-cell sheet-col1">
								Where
							</div>
							<div class="sheet-cell sheet-col2">
								-
							</div>
							<div class="sheet-cell sheet-col3">
								<div class="sheet-popup">DR</div><span class="sheet-tooltip">Split DR for <br />layered
									protection</span>
							</div>
						</div> <!-- .sheet-header -->
						<div class="sheet-row sheet-row-DR">
							<!-- Eyes -->
							<div class="sheet-cell sheet-col0">
								-
							</div>
							<div class="sheet-cell sheet-col1">
								Eye
							</div>
							<div class="sheet-cell sheet-col2">
								-9
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_eyes_c_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_eyes_c_dr" value="0"/>
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<!-- Skull -->
							<div class="sheet-cell sheet-col0">
								3-4
							</div>
							<div class="sheet-cell sheet-col1">
								Skull
							</div>
							<div class="sheet-cell sheet-col2">
								-7
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_skull_c_dr_max" value="2" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_skull_c_dr" value="0"/>
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<!-- Face -->
							<div class="sheet-cell sheet-col0">
								5
							</div>
							<div class="sheet-cell sheet-col1">
								Face
							</div>
							<div class="sheet-cell sheet-col2">
								-5
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_face_c_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_face_c_dr" value="0" />
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR"> 
							<!-- Right Leg -->
							<div class="sheet-cell sheet-col0">
								6-7
							</div>
							<div class="sheet-cell sheet-col1">
								Right Leg
							</div>
							<div class="sheet-cell sheet-col2">
								-2
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_rtleg_c_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_rtleg_c_dr" value="0" />
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<!-- Right Arm -->
							<div class="sheet-cell sheet-col0">
								8
							</div>
							<div class="sheet-cell sheet-col1">
								Right Arm
							</div>
							<div class="sheet-cell sheet-col2">
								-2
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_rtarm_c_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_rtarm_c_dr" value="0"/>
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<div class="sheet-cell sheet-col0">
								9-10
							</div>
							<div class="sheet-cell sheet-col1">
								Torso
							</div>
							<div class="sheet-cell sheet-col2">
								0
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_torso_c_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_torso_c_dr" value="0"/>
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<div class="sheet-cell sheet-col0">
								11
							</div>
							<div class="sheet-cell sheet-col1">
								Groin
							</div>
							<div class="sheet-cell sheet-col2">
								-3
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_groin_c_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_groin_c_dr" value="0" />
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<div class="sheet-cell sheet-col0">
								12
							</div>
							<div class="sheet-cell sheet-col1">
								Left Arm
							</div>
							<div class="sheet-cell sheet-col2">
								-2
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_ltarm_c_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_ltarm_c_dr" value="0"/>
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<div class="sheet-cell sheet-col0">
								13-14
							</div>
							<div class="sheet-cell sheet-col1">
								Left Leg
							</div>
							<div class="sheet-cell sheet-col2">
								-2
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_ltleg_c_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_ltleg_c_dr" value="0" />
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<div class="sheet-cell sheet-col0">
								15
							</div>
							<div class="sheet-cell sheet-col1">
								Hand
							</div>
							<div class="sheet-cell sheet-col2">
								-4
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_hands_c_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_hands_c_dr" value="0"/>
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<div class="sheet-cell sheet-col0">
								16
							</div>
							<div class="sheet-cell sheet-col1">
								Foot
							</div>
							<div class="sheet-cell sheet-col2">
								-4
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_feet_c_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_feet_c_dr" value="0" />
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<div class="sheet-cell sheet-col0">
								17-18
							</div>
							<div class="sheet-cell sheet-col1">
								Neck
							</div>
							<div class="sheet-cell sheet-col2">
								-5
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_neck_c_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_neck_c_dr" value="0" />
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<div class="sheet-cell sheet-col0">
								-
							</div>
							<div class="sheet-cell sheet-col1">
								Vitals
							</div>
							<div class="sheet-cell sheet-col2">
								-3
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_vitals_c_dr_max" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_vitals_c_dr" value="0" />
							</div>
						</div> <!-- .sheet-row -->
						<div class="sheet-row sheet-row-DR">
							<div class="sheet-cell sheet-col0">
								-
							</div>
							<div class="sheet-cell sheet-col1">
								Area
							</div>
							<div class="sheet-cell sheet-col2">
								-
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_area_dr_c" value="0" />
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_area_dr_c" value="0" />
							</div>
						</div> <!-- .sheet-row -->
						<fieldset class="repeating_drc">
						<div class="sheet-row sheet-row-DR">
							<div class="sheet-cell sheet-col0">
								<input type="text" name="attr_roll_c" placeholder="1-2" />
							</div>
							<div class="sheet-cell sheet-col1">
								<input type="text" name="attr_name_dr_c" placeholder="Where" />
							</div>
							<div class="sheet-cell sheet-col2">
								<input type="text" name="attr_penalty_dr_c" placeholder="-2" />
							</div>
							<div class="sheet-cell sheet-col3a">
								<input type="number" name="attr_user_dr_c" value="" placeholder="0"/>
							</div>
							<div class="sheet-cell sheet-col3b">
								<input type="number" name="attr_user_dr_c" value="" placeholder="0"/>
							</div>
						</div> <!-- .sheet-row -->
						</fieldset>
					</span> <!-- Ende DR Choice C -->
				</div> <!-- DR TABLE END-->
			</div> <!-- _____ _____ END PASSIVE DEFENSE BOX _____ _____ -->
			

			<!-- _____ _____ SHIELD BOX _____ _____ -->
			<div class="sheet-box sheet-shield">
				<div class="sheet-header sheet-header-shield">
					<div class="sheet-cell sheet-col0">
						Shield/Defense
					</div>
					<div class="sheet-cell sheet-col1">
						<div class="sheet-popup">L</div><span class="sheet-tooltip"><strong>Large: </strong>check
							box if shield is large.</span>
					</div>
					<div class="sheet-cell sheet-col1">
						<div class="sheet-popup">E</div><span class="sheet-tooltip"><strong>Equipped: </strong>check
							box if equipped.</span>
					</div>
					<div class="sheet-cell sheet-col2">
						<div class="sheet-popup">Location</div><span class="sheet-tooltip"><strong>Location: </strong>check each box that<br />applies to shield coverage</span>
					</div>
					<div class="sheet-cell sheet-col3">
						<div class="sheet-popup">DB</div><span class="sheet-tooltip"><strong>Defense Bonus:</strong><br />The bonus the shield gives to all of your active<br />defense rolls (see Defending, p. 374) against<br />attacks from the <i>front</i> or <i>shield</i> side<br />B287</span>
					</div>
					<div class="sheet-cell sheet-col4">
						<div class="sheet-popup">DR/HP</div><span class="sheet-tooltip"><strong>DR/HP: </strong>The shield’s DR<br />and HP if using the optional<br />Damage to Shields rule.<br />This DR protects the shield,<br />not the wielder.<br />B287</span>
					</div>
					<input type="hidden" name="attr_shield_defense_bonus" value="0" />
					<input type="hidden" name="attr_lgshieldpen" value="0" />
				</div>
				<fieldset class="repeating_shield">
				<div class="sheet-row sheet-row-shield">
					<div class="sheet-cell sheet-col0">
						<input type="text" name="attr_shield_name" placeholder="Defense Name" />
					</div>
					<div class="sheet-cell sheet-col1">
						<input class="sheet-boolean" type="checkbox" name="attr_shield_large" value="-2" />
					</div>
					<div class="sheet-cell sheet-col1">
						<input class="sheet-boolean" type="checkbox" name="attr_shield_ready" value="1" />
					</div>
					<div class="sheet-cell sheet-setshieldf">
						<div class="sheet-popup">
						<input type="checkbox" name="attr_setshield_front" class="sheet-boolean" value="1"></div><span class="sheet-tooltip"><strong>Front</strong></span>
					</div>
					<div class="sheet-cell sheet-setshield">
						<div class="sheet-popup">
						<input type="checkbox" name="attr_setshield_left" class="sheet-boolean" value="1"></div><span class="sheet-tooltip"><strong>Left</strong></span>
					</div>
					<div class="sheet-cell sheet-setshield">
						<div class="sheet-popup">
						<input type="checkbox" name="attr_setshield_right" class="sheet-boolean" value="1"></div><span class="sheet-tooltip"><strong>Right</strong></span>
					</div>
					<div class="sheet-cell sheet-setshieldb">
						<div class="sheet-popup">
						<input type="checkbox" name="attr_setshield_back" class="sheet-boolean" value="1"></div><span class="sheet-tooltip"><strong>Back</strong></span>
					</div>
					<div class="sheet-cell sheet-col3">
						<input type="number" name="attr_shield_db" value="0" />
					</div>
					<div class="sheet-cell sheet-col4a">
						<input type="text" name="attr_shield_dr" value="0" />
					</div>
					<div class="sheet-cell sheet-col4b">/</div>
					<div class="sheet-cell sheet-col4c">
						<input type="text" name="attr_shield_hp" value="0" />
					</div>
				</div>
				</fieldset>
			</div>
			<div class="sheet-box sheet-shieldimage">
				<div class="sheet-table">
					<div class="sheet-row sheet-shieldimagetext">
						<div class="sheet-cell sheet-imagetextfront">
							<div class="sheet-popup"><input type="number" name="attr_shieldfront_db" min="0" step="1" value="0" readonly="readonly" /></div><span class="sheet-tooltip"><strong>Front</strong></span>
						</div>
					</div>
					<div class="sheet-row sheet-shieldimagetext">
						<div class="sheet-cell sheet-imagetextfrontL">
							<div class="sheet-popup"><input type="number" name="attr_shieldfront_db" min="0" step="1" value="0" readonly="readonly" /></div><span class="sheet-tooltip"><strong>Front</strong></span>
						</div>
						<div class="sheet-cell sheet-imagetextfrontR">
							<div class="sheet-popup"><input type="number" name="attr_shieldfront_db" min="0" step="1" value="0" readonly="readonly" /></div><span class="sheet-tooltip"><strong>Front</strong></span>
						</div>
					</div>
					<div class="sheet-row sheet-shieldimagetext">
						<div class="sheet-cell sheet-imagetextbackL">
							<div class="sheet-popup"><input type="number" name="attr_shieldleft_db" min="0" step="1" value="0" readonly="readonly" /></div><span class="sheet-tooltip"><strong>Left</strong></span>
						</div>
						<div class="sheet-cell sheet-imagetextbackR">
							<div class="sheet-popup"><input type="number" name="attr_shieldright_db" min="0" step="1" value="0" readonly="readonly" /></div><span class="sheet-tooltip"><strong>Right</strong></span>
						</div>
					</div>
					<div class="sheet-row sheet-shieldimagetext">
						<div class="sheet-cell sheet-imagetextback">
							<div class="sheet-popup"><input type="number" name="attr_shieldback_db" min="0" step="1" value="0" readonly="readonly" /></div><span class="sheet-tooltip"><strong>Back</strong></span>
						</div>
					</div>
				</div>
			</div>

				
		</div> <!-- ________ END ACTIVE DEFENSE ________ -->
		
		<!-- _____ _____ MELEE COMBAT SUB TAB _____ _____ -->
		<div class="sheet-section sheet-section-meleeattacks">
		
			<div class="sheet-box sheet-box-melee-modifiers">
				<div class="sheet-table">
					<div class="sheet-row sheet-header-melee-modifiers">
						<div class="sheet-header sheet-header-melee-modifiers">
							<div class="sheet-cell sheet-col0">
								<div class="sheet-popup">MELEE ATTACK MODIFIERS:
								</div><span class="sheet-tooltip">1. Taking your base skill with the weapon or unarmed attack you are using. (In<br />some situations, another skill – e.g., Free Fall, Riding, or Environment Suit – will limit this skill.)<br />2. Applying the relevant conditional modifiers below. Modifiers are cumulative, but<br />combined visibility penalties cannot exceed -10 (-6, if used to blindness). If any modifier<br />marked with an asterisk (*) applies, adjusted skill after all modifiers cannot exceed 9.</span><input type="hidden" name="attr_total_melee_mod" value="0" />
							</div>
							<div class="sheet-cell sheet-reset">
								<button type="action" name="act_melee_reset" class="sheet-meleereset">Reset</button>
							</div>
						</div>
					</div>
					<div class="sheet-row sheet-row-melee-modifiers">
						<div class="sheet-cell sheet-badfoot">
							<div class="sheet-popup">Bad footing:</div><span class="sheet-tooltip"><strong>Bad Footing:</strong><br />-1 or more (GM’s option)</span>
						</div>
						<div class="sheet-cell sheet-badfootnum">
							<input type="number" name="attr_badfoot" value="0" />
						</div>
						<div class="sheet-cell sheet-grappled">
							<div class="sheet-popup">Grappled:</div><span class="sheet-tooltip"><strong>Grappled:</strong> <br />-4 B371</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="checkbox" class="sheet-boolean" name="attr_meleegrappled" value="-4" />
						</div>
						<div class="sheet-cell sheet-shield">
							<div class="sheet-popup">Large Shield Equipped:</div><span class="sheet-tooltip"><strong>Large Shield Equipped:</strong> -2<br />B547</span>
						</div>
						<div class="sheet-cell sheet-shieldyes sheet-readonly">
							<input type="hidden" name="attr_shieldyesno" value="" readonly="readonly" />
							<input type="hidden" name="attr_lgshieldpen" readonly="readonly" value="0" />
							<span name="attr_shieldyesno"></span>
						</div>
						<div class="sheet-cell sheet-shieldnum sheet-readonly">
							<input type="hidden" name="attr_shield_melee_penalty" readonly="readonly" />
							<span name="attr_shield_melee_penalty"></span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<div class="sheet-popup"><input type="checkbox" class="sheet-boolean" name="attr_shieldccbt" value="-1" /></div><span class="sheet-tooltip"><strong>In Close Combat</strong><br />Wearing shield<br />in close combat<br />-DB of shield B392</span>
						</div>
						<div class="sheet-cell sheet-distraction">
							<div class="sheet-popup">Distracted:</div><span class="sheet-tooltip"><strong>Minor Distraction:</strong><br />(e.g., part of clothes on fire): -2<br /><strong>Major Distraction:</strong><br />(e.g., all clothes on fire):<br />-3 or more (GM’s option)<br />B547</span>
						</div>
						<div class="sheet-cell sheet-distractionnum">
							<input type="text" name="attr_distraction" value="0" />
						</div>
						<div class="sheet-cell sheet-strikeccbt">
							<div class="sheet-popup">Striking into Close Combat:</div><span class="sheet-tooltip"><strong>Striking into Close Combat:</strong><br />-2<br />B547</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="checkbox" class="sheet-boolean" name="attr_meleestrikeccbt" value="-2" />
						</div>
						<div class="sheet-cell sheet-wildswing">
							<div class="sheet-popup">Wild Swing:</div><span class="sheet-tooltip"><strong>Wild Swing:</strong><br />-5<br />B547</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="checkbox" class="sheet-boolean" name="attr_meleewild" value="-5" />
						</div>
						<div class="sheet-cell sheet-man">
							<div class="sheet-popup">Evaluate:</div><span class="sheet-tooltip"><strong>Evaluate:</strong><br />+1 per turn (maximum +3)<br />B364</span>
						</div>
						<div class="sheet-cell sheet-mannum">
							<select name="attr_evaluate">
								<option value="0" selected >0</option>
								<option value="1">1</option>
								<option value="2">2</option>
								<option value="3">3</option>
							</select>
						</div>
					</div>
					<div class="sheet-row sheet-row-melee-modifiers">
						<div class="sheet-cell sheet-cannotseeany">
							Blind:
						</div>
						<div class="sheet-cell sheet-csana">
							N/A:
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="radio" name="attr_meleecannotsee" value="0" checked="checked" />
						</div>
						<div class="sheet-cell sheet-yesblind">
							<div class="sheet-popup">Yes:</div><span class="sheet-tooltip"><strong>Cannot See</strong><br /><i>Not</i> used to being blind</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="radio" name="attr_meleecannotsee" value="-10" />
						</div>
						<div class="sheet-cell sheet-yesblind">
							<div class="sheet-popup">Yes:</div><span class="sheet-tooltip"><strong>Cannot See</strong><br />used to being blind</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="radio" name="attr_meleecannotsee" value="-6" />
						</div>
						<div class="sheet-cell sheet-cannotseefoe">
							Can't see foe:
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<div class="sheet-popup"><input type="radio" name="attr_meleecannotsee" value="-6" /></div><span class="sheet-tooltip"><strong>Cannot See Foe</strong>
							</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<div class="sheet-popup"><input type="radio" name="attr_meleecannotsee" value="-4" /></div><span class="sheet-tooltip"><strong>Cannot See Foe</strong><br />Know where he is within 1 yd.</span>
						</div>
						<div class="sheet-cell sheet-partialvis">
							<div class="sheet-popup">Partial:</div><span class="sheet-tooltip"><strong>Partial Visibility:</strong><br />darkness, fog, smoke, etc.<br />B394</span>
						</div>
						<div class="sheet-cell sheet-partialvisnum">
							<input type="number" name="attr_visionpenalty" max="0" min="-10" value="0" />
						</div>
						<div class="sheet-cell sheet-nightvision">
							<div class="sheet-popup">Night Vision:</div><span class="sheet-tooltip"><strong>Night Vision:</strong><br />
								Regardless of level, Night Vision only works in<br />partial darkness. It has no effect on the -10 for total darkness.
								<br />B71</span>
						</div>
						<div class="sheet-cell sheet-nightvisionnum">
							<input type="number" name="attr_nightvision" min="0" max="10" value="0" />
						</div>
					</div>
					<div class="sheet-subheader sheet-subheader-melee-modifiers">
						<div class="sheet-cell sheet-targetsize">
							<div class="sheet-popup">Target Size</div><span class="sheet-tooltip"><strong>Size Modifier Table</strong><br />
							<table>
								<thead>
									<tr><th>Size</th><th>Measure</th><th>Size</th><th>Measure</th></tr>
								</thead>
								<tbody>
									<tr><td>-15</td><td>1/5"</td><td>0</td><td>2 yd.</td></tr>
									<tr><td>-14</td><td>1/3"</td><td>1</td><td>3 yd.</td></tr>
									<tr><td>-13</td><td>1/2"</td><td>2</td><td>5 yd.</td></tr>
									<tr><td>-12</td><td>2/3"</td><td>3</td><td>7 yd.</td></tr>
									<tr><td>-11</td><td>1"</td><td>4</td><td>10 yd.</td></tr>
									<tr><td>-10</td><td>1.5"</td><td>5</td><td>15 yd.</td></tr>
									<tr><td>-9</td><td>2"</td><td>6</td><td>20 yd.</td></tr>
									<tr><td>-8</td><td>3"</td><td>7</td><td>30 yd.</td></tr>
									<tr><td>-7</td><td>5"</td><td>8</td><td>50 yd.</td></tr>
									<tr><td>-6</td><td>8"</td><td>9</td><td>70 yd.</td></tr>
									<tr><td>-5</td><td>1 ft.</td><td>10</td><td>100 yd.</td></tr>
									<tr><td>-4</td><td>1.5 ft.</td><td>11</td><td>150 yd.</td></tr>
									<tr><td>-3</td><td>2 ft.</td><td>12</td><td>200 yd.</td></tr>
									<tr><td>-2</td><td>1 yd.</td><td>13</td><td>300 yd.</td></tr>
									<tr><td>-1</td><td>1.5 yd.</td><td>14</td><td>500 yd.</td></tr>
								</tbody>
							</table></span>
						</div>
						<div class="sheet-cell sheet-targetloc">
							Location
						</div>
						<div class="sheet-cell sheet-targetpen">
							Penalty
						</div>
						<div class="sheet-cell sheet-targetrestr">
							Target Restrictions
						</div>
					</div>
					<div class="sheet-row sheet-row-melee-modifiers">
						<div class="sheet-cell sheet-targetsize">
							<input type="number" step="1" value="0" name="attr_firing_size_mod" />
						</div>
						<div class="sheet-cell sheet-targetloc">
							<select name="attr_targetloc">
								<option value="random">Random Body</option>
								<option value="vehicle">Random Vehicle</option>
								<optgroup label="Body Locations">
									<optgroup label="3-4 Skull">
										<option value="skull">Skull (Front)</option>
										<option value="skullr">Skull (Back)</option>
									</optgroup>
									<optgroup label="5 Face">
										<option value="facef">Face (Front)</option>
										<option value="facer">Face (Rear)</option>
										<option value="Jaw">Jaw</option>
										<option value="Nose">Nose</option>
										<option value="Ear">Ear</option>
										<option value="Cheek">Cheek</option>
										<option value="Eye">Eye</option>
									</optgroup>
									<optgroup label="6-7 Leg (Right)">
										<option value="LegR">Leg</option>
										<option value="Shinr">Shin (Right)</option>
										<option value="Kneer">Knee (Right)</option>
										<option value="Thighr">Thigh (Right)</option>
										<option value="Veinlr">Vein/Artery, Leg (Right)</option>
									</optgroup>
									<optgroup label="8 Arm (Right)">
										<option value="ArmR">Arm</option>
										<option value="Forearmr">Forearm (Right)</option>
										<option value="Elbowr">Elbow (Right)</option>
										<option value="Upperr">Upper Arm (Right)</option>
										<option value="Shoulderr">Shoulder (Right)</option>
										<option value="Veinra">Vein/Artery, Arm (Right)</option>						
									</optgroup>
									<optgroup label="9-10 Chest">
										<option value="Chest" selected>Chest (Default)</option>
										<option value="Vitalsc">Vitals, Chest (Front)</option>
										<option value="Spinec">Spine, Chest (Rear)</option>
										<option value="Heart">Heart, Chest (Front)</option>
									</optgroup>
									<optgroup label="11 Abdomen">
										<option value="Abdomen">Abdomen</option>
										<option value="Vitalsa">Vitals, Abdomen </option>
										<option value="Digest">Digestive Tract</option>
										<option value="Pelvis">Pelvis</option>
										<option value="116">Groin</option>
									</optgroup>
									<optgroup label="12 Arm (Left)">
										<option value="ArmL">Arm (Left)</option>
										<option value="Forearml">Forearm (Left)</option>
										<option value="Elbowl">Elbow (Left)</option>
										<option value="Upperl">Upper Arm (Left)</option>
										<option value="Shoulderl">Shoulder (Left)</option>
										<option value="Veinla">Vein/Artery, Arm (Left)</option>
									</optgroup>
									<optgroup label="13-14 Leg (Left)">
										<option value="LegL">Leg (Left)</option>
										<option value="Shinl">Shin (Left)</option>
										<option value="Kneel">Knee (Left)</option>
										<option value="Thighl">Thigh (Left)</option>
										<option value="Veinll">Vein/Artery, Leg (Left)</option>
									</optgroup>
									<optgroup label="15 Hand">
										<option value="Hand">Hand</option>
										<option value="HJoint">Hand (Joint)</option>
									</optgroup>
									<optgroup label="16 Foot">
										<option value="Foot">Foot</option>
										<option value="FJoint">Foot (Joint)</option>
									</optgroup>
									<optgroup label="17-18 Neck">
										<option value="Neck">Neck</option>
										<option value="Veeinn">Vein/Artery, Neck</option>
										<option value="Spinen">Spine, Neck (Rear)</option>
									</optgroup>
								</optgroup>
								<optgroup label="Armor Chinks">
									<option value="ChinksT">Chinks (Torso)</option>
									<option value="ChinksO">Chinks (Other)</option>
								</optgroup>
								<optgroup label="Harsh Realism Armor Gaps">
									<option value="ArmpitR">Right Armpit</option>
									<option value="ArmpitL">Left Armpit</option>
									<option value="BoKR">Back of Right Knee</option>
									<option value="BoKL">Back of Left Knee</option>
									<option value="Eyeslit">Eyeslit(s)</option>
									<option value="Cod">Codpiece</option>
									<option value="InsideER">Inside Right Elbow</option>
									<option value="InsideEL">Inside Left Elbow</option>
									<option value="InsideTR">Inside Right Thigh</option>
									<option value="InsideTL">Inside Left Thigh</option>
									<option value="NeckAG">Neck Armor Gap</option>
									<option value="Palm">Open Palm</option>
								</optgroup>
								<optgroup label="Weapons and Equipment">
									<option value="ReachC">Reach C Weapon</option>
									<option value="Reach1">Reach 1 Weapon</option>
									<option value="Reach2">Reach 2 Weapon</option>
								</optgroup>
								<optgroup label="Vehicle Locations">
									<option value="g">Small Glass Window [g]</option>
									<option value="g">Exposed Weapon Mount [X]</option>
									<option value="s">Small Superstructure* [s]</option>
									<option value="s">Independent Turret [t]</option>
									<option value="C">Caterpillar Track [C]</option>
									<option value="C">Draft Animal** [D]</option>
									<option value="C">Helicopter Rotor [H]</option>
									<option value="C">Mast [M]</option>
									<option value="C">Wing [Wi]</option>
									<option value="A">Arm [A]</option>
									<option value="A">Large Superstructure* [S]</option>
									<option value="A">Main Turret* [T]</option>
									<option value="B">Body*</option>
									<option value="BE">Exposed Rider [E]</option>
									<option value="G">Large Glass Window [G]</option>
									<option value="G">Open Cabin [O]</option>
									<option value="R">Runner or Skid [R]</option>
									<option value="R">Wheel [W]</option>
									<option value="V">Vital Area</option>
								</optgroup>
							</select>
						</div>
						<div class="sheet-cell sheet-targetpen sheet-readonly">
							<span name="attr_targetpenalty"></span>
						</div>
						<div class="sheet-cell sheet-targetrestr sheet-readonly">
							<span name="attr_targetrestr"></span>
						</div>
					</div>
					<div class="sheet-subheader sheet-subheader-melee-modifiers">
						<div class="sheet-cell sheet-targeteffects">
							Target Effects
						</div>
					</div>
					<div class="sheet-row sheet-row-melee-targeteffects">
						<div class="sheet-cell sheet-targeteffects sheet-readonly">
							<span name="attr_targeteffects"></span>
						</div>
					</div>
				</div> <!-- END TABLE -->
			</div> <!-- END BOX -->
				
			<!-- _____ _____ MELEE COMBAT BOX _____ _____ -->
			<div class="sheet-box sheet-box-melee">
				<div class="sheet-table">
					<div class="sheet-header sheet-header-melee">
						<div class="sheet-cell sheet-col1">Melee Weapons</div>
						<div class="sheet-cell sheet-col2">Usage</div>
						<div class="sheet-cell sheet-col3">
							<div class="sheet-popup">Lvl</div><span class="sheet-tooltip">Your skill before any modifiers<br />B171.</span>
						</div>
						<div class="sheet-cell sheet-mods">
							<div class="sheet-popup">Mods</div><span class="sheet-tooltip"><strong>Modifiers:</strong><br />Applied relevant conditional modifiers.<br />All modifiers are cumulative.</span>
						</div>
						<div class="sheet-cell sheet-col4">
							<div class="sheet-popup">ESL</div><span class="sheet-tooltip"><strong>effective skill:</strong><br />Your base skill plus<br />or minus any modifiers for<br />the task at hand.<br />B171</span>
						</div>
						<div class="sheet-cell sheet-col5">
							<div class="sheet-popup">Damage</div><span class="sheet-tooltip">Damage rolls are expressed
								as<br />number of dice, sometimes with
								a<br />modifier. High damage is expressed<br />as
								dice with a multiplier.<br />
								<table>
									<thead>
										<tr><th>Abbr</th><th>Multiplier</th><th>Name</th></tr>
									</thead>
									<tbody>
										<tr><td>cut</td><td>x1.5</td><td>Cutting</td></tr>
										<tr><td>imp</td><td>x2.0</td><td>Impaling</td></tr>
										<tr><td>cr</td><td>x1.0</td><td>Crushing</td></tr>
										<tr><td>pi-</td><td>x0.5</td><td>Small Piercing</td></tr>
										<tr><td>pi</td><td>x1.0</td><td>Piercing</td></tr>
										<tr><td>pi+</td><td>x1.5</td><td>Large Piercing</td></tr>
										<tr><td>pi++</td><td>x2.0</td><td>Huge Piercing</td></tr>
										<tr><td>aff</td><td>-</td><td>Affliction</td></tr>
										<tr><td>burn</td><td>x1.0</td><td>Burning</td></tr>
										<tr><td>bu (tb)</td><td>x1.0</td><td>Burning Tight Beam</td></tr>
										<tr><td>cor</td><td>x1.0</td><td>Corrosion</td></tr>
										<tr><td>fat</td><td>x1.0</td><td>Fatigue</td></tr>
										<tr><td>tox</td><td>x1.0</td><td>Toxic</td></tr>
										<tr><td>spec</td><td>-</td><td>Special</td></tr>
									</tbody>
								</table>
							</span>
						</div>
						<div class="sheet-cell sheet-col6">
							<div class="sheet-popup">Reach</div><span class="sheet-tooltip">This is the distance in yards at which<br />a human-sized or smaller wielder<br />can strike with the weapon</span>
						</div>
						<div class="sheet-cell sheet-col7">
							<div class="sheet-popup">ST</div><span class="sheet-tooltip">The minimum Strength required to<br />use the weapon properly.</span>
						</div>
						<div class="sheet-cell sheet-col8">
							<div class="sheet-popup">UA</div><span class="sheet-tooltip"><strong>Unarmed Attack:</strong><br />Check box if this is an unarmed attack<br />such as a bite attack!</span>
						</div>
					</div>
					<fieldset class="repeating_melee">
						<input class="sheet-toggle" type="checkbox" />
						<span class="sheet-checkbox"></span>
						<div class="sheet-row sheet-row-melee">
							<div class="sheet-cell sheet-col0">
								<button type="roll" name="attr_melee_atkroll"   value="!melee @{character_id} @{rowid} [[@{esl} + @{modifier}]] @{damage} @{type} [[@{notes_onoff}]] [[@{targetType}]]"></button>
							</div>
							<div class="sheet-cell sheet-col1">
								<input type="text" name="attr_weaponname" placeholder="Attack Name" />
							</div>
							<div class="sheet-cell sheet-col2">
								<input type="text" name="attr_usage" placeholder="usage" />
							</div>
							<div class="sheet-cell sheet-col3">
								<input type="number" name="attr_skill" value="0" placeholder="0" step="1"/>
							</div>
							<div class="sheet-cell sheet-mods">
								<input type="number" name="attr_mmods" value="0" readonly="readonly" />
							</div>
							<div class="sheet-cell sheet-col4">
								<input type="number" name="attr_esl" value="0" readonly="readonly" step="1"/>								
							</div>
							<div class="sheet-cell sheet-col5a">
								<input type="text" name="attr_damage" value="1d6" />
							</div>
							<div class="sheet-cell sheet-col5b">
								<select name="attr_type">
									<option value="cut">cut</option>
									<option value="imp">imp</option>
									<option value="cr">cr</option>
									<option value="pi-">pi-</option>
									<option value="pi">pi</option>
									<option value="pi+">pi+</option>
									<option value="pi++">pi++</option>
									<option value="burn">burn</option>
									<option value="butb">bu (tb)</option>
									<option value="cor">cor</option>
									<option value="fat">fat</option>
									<option value="aff">aff</option>
									<option value="spec">spec</option>
									<option value="tox">tox</option>
								</select>
							</div>
							<div class="sheet-cell sheet-col6">
								<input type="text" name="attr_reach" placeholder="1" />
							</div>
							<div class="sheet-cell sheet-col7">
								<input type="number" name="attr_minst" placeholder="1" step="1"/>
							</div>
							<div class="sheet-cell sheet-col8">
								<input type="checkbox" class="sheet-boolean" name="attr_unarmed_attack" value="1" />
							</div>
						</div>
						<div class="sheet-subheader sheet-attack-options-subhead">
							<div class="sheet-cell sheet-attack-options">
							Attack Options
							</div>
						</div>
						<div class="sheet-row sheet-row-melee-attack-options">
							<div class="sheet-cell sheet-deceptive-attack">
								<div class="sheet-popup">Deceptive Attack:</div><span class="sheet-tooltip"><strong>Deceptive Attack:</strong><br />For every -2 you accept to your own skill,<br />your foe suffers a -1 penalty on his active<br />defenses against this attack.<br />B369</span>
							</div>
							<div class="sheet-cell sheet-deceptive-attack-drop-down">
								<select name="attr_deceptiveatk">
									<option value="0" selected >0</option>
									<option value="-2">-2</option>
									<option value="-4">-4</option>
									<option value="-6">-6</option>
									<option value="-8">-8</option>
									<option value="-10">-10</option>
								</select>
							</div>
							<div class="sheet-cell sheet-dual-weapon">
							<div class="sheet-popup">Dual-Weapon Attack:</div><span class="sheet-tooltip"><strong>Dual Weapon Attack:</strong><br />If you have at least two hands, you can strike<br />with two hands at once using an Attack maneuver<br />-4/-8 with primary/off hand<br />(-4/-4 w.Ambidexterity)<br />B417</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="checkbox" class="sheet-boolean" name="attr_dualweapon" value="-4" />
						</div>
							<div class="sheet-cell sheet-rapid-strike">
								<div class="sheet-popup">Rapid Strike:</div><span class="sheet-tooltip"><strong>Rapid Strike:</strong><br />-6 on both attacks<br />(-3 w. Trained By A Master<br />or Weapon Master)<br />B370</span>
							</div>
							<div class="sheet-cell sheet-checkboxbox">
								<input type="checkbox" class="sheet-boolean" name="attr_rapidstrike" value="-6" />
							</div>
							<div class="sheet-cell sheet-telegraph">
								<div class="sheet-popup">Telegraphic Attack:</div><span class="sheet-tooltip"><strong>Telegraphic Attack</strong><br />Carefully line up an attack<br />gaining the +4 for routine skill use<br />all active defenses against a<br />Telegraphic Attack are at +2!<br />MA113</span>
							</div>
							<div class="sheet-cell sheet-checkboxbox">
								<input type="checkbox" class="sheet-boolean" name="attr_telegraph" value="4"/>
							</div>
						</div>	
						<div class="sheet-row sheet-row-details">
							<div class="sheet-cell sheet-col0">
								<div class="sheet-popup"><input type="checkbox" class="sheet-boolean" name="attr_notes_onoff" value="1" checked="checked" />
								</div><span class="sheet-tooltip">Check to display notes in rolls</span>
							</div>
							<div class="sheet-cell sheet-col1">
								<textarea name="attr_notes" placeholder="notes"></textarea>
							</div>
						</div>
						<div class="sheet-row sheet-row-details-rowid">
							<div class="sheet-cell sheet-col2">
								RowID For Macros
								<input name="attr_rowid" value="" readonly="readonly" />
							</div>
							<div class="sheet-cell sheet-pwield">
								Primary
								<input type="radio" name="attr_wield" value="1" checked />
							</div>
							<div class="sheet-cell sheet-wield">
								Off-hand
								<input type="radio" name="attr_wield" value="0" />
							</div>
							<div class="sheet-cell sheet-bwield">
								Both
								<input type="radio" name="attr_wield" value="2" />
							</div>
							<div class="sheet-hidden">
								<input type="number" name="attr_offhand" value="0" readonly="readonly" />
								<input type="number" name="attr_stdeficit" value="0" readonly="readonly" />
								<input type="number" name="attr_rsp" value="0" readonly="readonly" />
								<input type="number" name="attr_visionpenalty" value="0" readonly="readonly" />
								<input type="number" name="attr_dwpen" value="0" />
							</div>
						</div>
					</fieldset>
				</div>
			</div>
				
		</div> <!-- END SECTION -->
		
		<!-- _____ _____ RANGED COMBAT SUB TAB _____ _____ -->
		<div class="sheet-section sheet-section-rangedattacks">
		
			<div class="sheet-box sheet-box-ranged-modifiers">
				<div class="sheet-table">
					<div class="sheet-row sheet-header-ranged-modifiers">
						<div class="sheet-header sheet-header-ranged-modifiers">
							<div class="sheet-cell sheet-col0">
								<div class="sheet-popup">RANGED ATTACK MODIFIERS:  
								</div><span class="sheet-tooltip">1. Taking your base skill with the weapon or unarmed attack you are using. (In<br />some situations, another skill – e.g., Free Fall, Riding, or Environment Suit – will limit this skill.)<br />2. Applying the relevant conditional modifiers below. Modifiers are cumulative, but<br />combined visibility penalties cannot exceed -10 (-6, if used to blindness). If any modifier<br />marked with an asterisk (*) applies, adjusted skill after all modifiers cannot exceed 9.</span><input type="hidden" name="attr_total_ranged_mod" value="0" />
							</div>
							<div class="sheet-cell sheet-targetreset">
						        <div class="sheet-popup"><button type="action" name="act_ranged_reset" class="reset">Reset</button></div><span class="sheet-tooltip">Reset the modifiers</span>
						    </div>
						</div>
					</div>
					<div class="sheet-row sheet-row-ranged-modifiers">
						<div class="sheet-cell sheet-badfoot">
							<div class="sheet-popup">Bad footing:</div><span class="sheet-tooltip"><strong>Bad footing:</strong><br />-1 or more (GM’s option)</span>
						</div>
						<div class="sheet-cell sheet-badfootnum">
							<input type="number" name="attr_badfoot" value="0" step="1" />
						</div>
						<div class="sheet-cell sheet-ccbt">
							<div class="sheet-popup">CCBT:</div><span class="sheet-tooltip"><strong>Close Combat:</strong><br />Check box to apply a penalty equal to the weapon’s Bulk statistic<br />(see Weapons for Close Combat, p. 391)</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="checkbox" class="sheet-boolean" name="attr_rangedccbt" value="1" />
						</div>
						<div class="sheet-cell sheet-damweapon">
							<div class="sheet-popup">Damaged Weapon:</div><span class="sheet-tooltip"><strong>Damaged weapon:</strong><br />-HP of injury received last turn (maximum -4)</span>
						</div>
						<div class="sheet-cell sheet-damweaponnum">
							<input type="number" name="attr_damagedweapon" value="0" min="-4" max="0"/>
						</div>
						<div class="sheet-cell sheet-distraction">
							<div class="sheet-popup">Distraction:</div><span class="sheet-tooltip"><strong>Minor Distraction:</strong><br />(e.g., part of clothes on fire): -2<br /><strong>Major Distraction:</strong><br />(e.g., all clothes on fire):<br />-3 or more (GM’s option)<br />B547</span>
						</div>
						<div class="sheet-cell sheet-distractnum">
							<div class="sheet-popup"><input type="number" name="attr_distraction" value="0" /></div><span class="sheet-tooltip"><strong>Major Distraction:</strong><br />(e.g., all clothes on fire):<br />-3 or more (GM’s option) B547</span>
						</div>
						<div class="sheet-cell sheet-extraim">
							<div class="sheet-popup">Extra Aim:</div><span class="sheet-tooltip"><strong>Extra Aim:</strong><br />If you Aim for more than one second,<br />you receive an additional bonus</span>
						</div>
						<div class="sheet-cell sheet-extraselect">
							<select name="attr_extraaim">
								<option value="0">None</option>
								<option value="1">2 sec</option>
								<option value="2">3+ sec</option>
							</select>
						</div>
						
						<div class="sheet-cell sheet-popupattack">
							<div class="sheet-popup">Pop-up Attack:</div><span class="sheet-tooltip"><strong>Pop-up Attack:</strong><br />a special Attack maneuver in which you emerge<br />from cover, move no more than one hex, make<br />a ranged attack, and return to cover</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="checkbox" class="sheet-boolean" name="attr_popup" value="-2" />
						</div>
						
						<div class="sheet-cell sheet-unfam">
							<div class="sheet-popup">Unfamiliar:</div><span class="sheet-tooltip"><strong>Unfamiliar weapon or targeting system:</strong> -2<br />B522</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="checkbox" class="sheet-boolean" name="attr_unfam" value="-2" />
						</div>
						<div class="sheet-cell sheet-rapidfire">
								<div class="sheet-popup">Rapid fire:</div><span class="sheet-tooltip"><strong>Rapid Fire:</strong><br />You must decide how many shots (up to RoF) you wish to fire before you make your attack roll.<br />Firing a large number of shots per attack gives a bonus to hit</span>
							</div>
							<div class="sheet-cell sheet-rapidnum">
								<input type="number" name="attr_rapidfire" step="1" value="0" />
							</div>
							<div class="sheet-hidden">
								
							</div>
					</div>
					<div class="sheet-row sheet-row-ranged-modifiers">
						<div class="sheet-cell sheet-oppfire">
							<div class="sheet-popup">Opp. Fire:</div><span class="sheet-tooltip">If you have a ranged weapon, you<br />may watch a specified area and attack<br />as soon as a target presents itself.</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="checkbox" class="sheet-boolean" name="attr_oppfireon" value="1" />
						</div>
						<div class="sheet-cell sheet-checktgt">
							<div class="sheet-popup">Check:</div><span class="sheet-tooltip"><strong>Target Discrimination:</strong><br />
								Normally, when you take opportunity fire,<br />you must attack the first target that<br />appears in the designated area – friend<br />or foe! You are free to specify that you<br />are not attacking automatically, usually to<br />avoid shooting a friend.
								<br />B390</span>
						</div>
						<div class="sheet-cell sheet-oppfirena">
							Yes:
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<div class="sheet-popup"><input type="radio" name="attr_oppfire" value="-2" /></div><span class="sheet-tooltip"><strong>Yes:</strong><br />additional -2<br />B390</span>
						</div>
						<div class="sheet-cell sheet-oppfireno">
							No:
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<div class="sheet-popup"><input type="radio" name="attr_oppfire" value="0" /></div><span class="sheet-tooltip"><strong>No:</strong><br />No additional penalty<br />B390</span>
						</div>
						<div class="sheet-cell sheet-opphexes">
							<div class="sheet-popup">Hexes:</div><span class="sheet-tooltip">
								<table>
								<thead>
									<tr><th>Hexes</th><th>Penalty</th></tr>
								</thead>
								<tbody>
									<tr><td>1</td><td>0</td></tr>
									<tr><td>2</td><td>-1</td></tr>
									<tr><td>3-4</td><td>-2</td></tr>
									<tr><td>5-6</td><td>-3</td></tr>
									<tr><td>7-10</td><td>-4</td></tr>
									<tr><td>11+</td><td>-5</td></tr>
									<tr><td>Line</td><td>-2</td></tr>
								</tbody>
							</table>
						</span>
						</div>
						<div class="sheet-cell sheet-hexselect">
							<select name="attr_hexes">
								<option value="0" selected>1</option>
								<option value="-1">2</option>
								<option value="-2">3-4</option>
								<option value="-3">5-6</option>
								<option value="-4">7-10</option>
								<option value="-5">11+</option>
								<option value="-2">line</option>
							</select>
						</div>
						<div class="sheet-cell sheet-cannotseeany">
							Blind:
						</div>
						<div class="sheet-cell sheet-csana">
							N/A:
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="radio" name="attr_rangedcannotsee" value="0" checked />
						</div>
						<div class="sheet-cell sheet-yesblind">
							<div class="sheet-popup">Yes:</div><span class="sheet-tooltip"><strong>Cannot See</strong><br /><i>Not</i> used to being blind</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="radio" name="attr_rangedcannotsee" value="-10" />
						</div>
						<div class="sheet-cell sheet-yesblind">
							<div class="sheet-popup">Yes:</div><span class="sheet-tooltip"><strong>Cannot See</strong><br />used to being blind</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="radio" name="attr_rangedcannotsee" value="-6" />
						</div>
						<div class="sheet-cell sheet-cannotseefoe">
							Can't see foe:
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<div class="sheet-popup"><input type="radio" name="attr_rangedcannotsee" value="-6" /></div><span class="sheet-tooltip"><strong>Cannot See Foe</strong>
							</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<div class="sheet-popup"><input type="radio" name="attr_rangedcannotsee" value="-4" /></div><span class="sheet-tooltip"><strong>Cannot See Foe</strong><br />Know where he is within 1 yd.</span>
						</div>
						<div class="sheet-cell sheet-partialvis">
							<div class="sheet-popup">Partial:</div><span class="sheet-tooltip"><strong>Partial Visibility:</strong><br />darkness, fog, smoke, etc.<br />B394</span>
						</div>
						<div class="sheet-cell sheet-partialvisnum">
							<input type="number" name="attr_visionpenalty" max="0" min="-10" value="0" />
						</div>
						<div class="sheet-cell sheet-nightvision">
							<div class="sheet-popup">Night Vision:</div><span class="sheet-tooltip"><strong>Night Vision:</strong><br />
								Regardless of level, Night Vision only works in<br />partial darkness. It has no effect on the -10 for total darkness.
								<br />B71</span>
						</div>
						<div class="sheet-cell sheet-nightvisionnum">
							<input type="number" name="attr_nightvision" min="0" max="9" value="0" />
						</div>
					</div>
					<div class="sheet-subheader sheet-subheader-ranged-modifiers">
						<div class="sheet-cell sheet-targetsize">
							<div class="sheet-popup">Target Size</div><span class="sheet-tooltip"><strong>Size Modifier Table</strong><br />
							<table>
								<thead>
									<tr><th>Size</th><th>Measure</th><th>Size</th><th>Measure</th></tr>
								</thead>
								<tbody>
									<tr><td>-15</td><td>1/5"</td><td>0</td><td>2 yd.</td></tr>
									<tr><td>-14</td><td>1/3"</td><td>1</td><td>3 yd.</td></tr>
									<tr><td>-13</td><td>1/2"</td><td>2</td><td>5 yd.</td></tr>
									<tr><td>-12</td><td>2/3"</td><td>3</td><td>7 yd.</td></tr>
									<tr><td>-11</td><td>1"</td><td>4</td><td>10 yd.</td></tr>
									<tr><td>-10</td><td>1.5"</td><td>5</td><td>15 yd.</td></tr>
									<tr><td>-9</td><td>2"</td><td>6</td><td>20 yd.</td></tr>
									<tr><td>-8</td><td>3"</td><td>7</td><td>30 yd.</td></tr>
									<tr><td>-7</td><td>5"</td><td>8</td><td>50 yd.</td></tr>
									<tr><td>-6</td><td>8"</td><td>9</td><td>70 yd.</td></tr>
									<tr><td>-5</td><td>1 ft.</td><td>10</td><td>100 yd.</td></tr>
									<tr><td>-4</td><td>1.5 ft.</td><td>11</td><td>150 yd.</td></tr>
									<tr><td>-3</td><td>2 ft.</td><td>12</td><td>200 yd.</td></tr>
									<tr><td>-2</td><td>1 yd.</td><td>13</td><td>300 yd.</td></tr>
									<tr><td>-1</td><td>1.5 yd.</td><td>14</td><td>500 yd.</td></tr>
								</tbody>
							</table></span>
						</div>
						<div class="sheet-cell sheet-targetspeed">
							<div class="sheet-popup">Target Speed</div><span class="sheet-tooltip">Fast targets – includes anything that requires the High-Speed Movement rules (p. 394)<br />GM may rule that speed is important enough to consider. In that case,<br />add speed in yards/second (2 mph = 1 yard/second)<br />If the speed falls between two values, use the higher</span>
						</div>
						<div class="sheet-cell sheet-targetrange">
							<div class="sheet-popup">Target Range</div><span class="sheet-tooltip">Note that there is no modifier at ranges of 2 yards or less – shooting a close<br />target is no easier (and no harder) than attacking it in melee combat!<br />If the range falls between two values, use the higher</span>
						</div>
						<div class="sheet-cell sheet-targetdir">
							<div class="popup">Direction</div><span class="tooltip">
						   Ignore up/down for beam type weapons like lasers.</span>
						</div>
						<div class="sheet-cell sheet-targetelev">
							<div class="sheet-popup">Elevation</div><span class="sheet-tooltip">Elevation: elevation is up if you are below your target.<br />Elevation is down if you above your target.</span>
						</div>
						<div class="sheet-cell sheet-targetreset">
							&nbsp;
						</div>
						<div class="sheet-cell sheet-targetcover">
							Target Cover
						</div>
					</div>
					<div class="sheet-row sheet-row-ranged-modifiers">
						<div class="sheet-cell sheet-targetsize">
							<input type="number" step="1" value="0" name="attr_firing_size_mod" />
						</div>
						<div class="sheet-cell sheet-targetspeed">
							<input type="number" step="1" value="0" min="0" name="attr_firing_speed_difference" />
						</div>
						<div class="sheet-cell sheet-targetrange">
							<input type="number" step="1" value="0" min="0" name="attr_firing_distance" />
						</div>
						<div class="sheet-cell sheet-targetdir">
    					    <select name="attr_firing_direction">
    					        <option value="linear">Normal</option>
    					        <option value="up">Elev. Up</option>
    					        <option value="dn">Elev. Down</option>
    					    </select>
    					</div>
    				    <div class="sheet-cell sheet-targetelev">
    					    <input type="number" step="1" value="0" min="0" name="attr_firing_up_dwn_distance" />
    					</div>
    					<div class="sheet-hidden">
    					    <input type="number" step="1" value="0" min="0" name="attr_firing_new_range" readonly="readonly" />
    					    <input type="number" value="0" name="attr_rangedspeedrangesize" readonly="readonly" />
    					    <input type="number" name="attr_rapidfirerounds" value="0" readonly="readonly" />
    						<input type="number" name="attr_rapidfirebonus" value="0" readonly="readonly" />
    						<input type="number" name="attr_oppfirepenalty" value="0" readonly="readonly" />
    					</div>
						<div class="sheet-cell sheet-lightcover">
							<div class="sheet-popup">Light Cover:</div><span class="sheet-tooltip"><strong>Shooting through light cover:</strong> -2<br />B408</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="checkbox" class="sheet-boolean" name="attr_lightcover" value="-2" />
						</div>
						<div class="sheet-cell sheet-targetbehind">
							<div class="sheet-popup">Behind Someone:</div><span class="sheet-tooltip"><strong>Target behind someone else:</strong> -4 per intervening figure.<br />B522</span>
						</div>
						<div class="sheet-cell sheet-targetbehindnum">
							<div class="sheet-popup"><input type="number" name="attr_targetbehind" value="0" step="1" /></div><span class="sheet-tooltip"><strong>Enter number of figures:</strong></span>
						</div>
						<div class="sheet-cell sheet-posture">
							<div class="sheet-popup">Posture:</div><span class="sheet-tooltip"><strong>Target Posture:</strong><br />Target crouching, kneeling, sitting, or lying down: an extra -2 to hit torso, groin, or legs<br />B522</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="checkbox" class="sheet-boolean" name="attr_targetposture" value="-2" />
						</div>
						<div class="sheet-cell sheet-partialcover">
							<div class="sheet-popup">Partial Cover:</div><span class="sheet-tooltip"><strong>Target only partly exposed:</strong> -2<br />B522</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="checkbox" class="sheet-boolean" name="attr_targetpartialcover" value="-2" />
						</div>
					</div>
					<div class="sheet-subheader sheet-subheader-ranged-modifiers">
						<div class="sheet-cell sheet-targetloc">
							Location
						</div>
						<div class="sheet-cell sheet-targetpen">
							Penalty
						</div>
						<div class="sheet-cell sheet-targetrestr">
							Target Restrictions
						</div>
					</div>
					<div class="sheet-row sheet-row-ranged-modifiers">	
						<div class="sheet-cell sheet-targetloc">
							<select name="attr_targetloc">
								<option value="random">Random Body</option>
								<option value="vehicle">Random Vehicle</option>
								<optgroup label="Body Locations">
									<optgroup label="3-4 Skull">
										<option value="skull">Skull (Front)</option>
										<option value="skullr">Skull (Back)</option>
									</optgroup>
									<optgroup label="5 Face">
										<option value="facef">Face (Front)</option>
										<option value="facer">Face (Rear)</option>
										<option value="Jaw">Jaw</option>
										<option value="Nose">Nose</option>
										<option value="Ear">Ear</option>
										<option value="Cheek">Cheek</option>
										<option value="Eye">Eye</option>
									</optgroup>
									<optgroup label="6-7 Leg (Right)">
										<option value="LegR">Leg</option>
										<option value="Shinr">Shin (Right)</option>
										<option value="Kneer">Knee (Right)</option>
										<option value="Thighr">Thigh (Right)</option>
										<option value="Veinlr">Vein/Artery, Leg (Right)</option>
									</optgroup>
									<optgroup label="8 Arm (Right)">
										<option value="ArmR">Arm</option>
										<option value="Forearmr">Forearm (Right)</option>
										<option value="Elbowr">Elbow (Right)</option>
										<option value="Upperr">Upper Arm (Right)</option>
										<option value="Shoulderr">Shoulder (Right)</option>
										<option value="Veinra">Vein/Artery, Arm (Right)</option>						
									</optgroup>
									<optgroup label="9-10 Chest">
										<option value="Chest" selected>Chest (Default)</option>
										<option value="Vitalsc">Vitals, Chest (Front)</option>
										<option value="Spinec">Spine, Chest (Rear)</option>
										<option value="Heart">Heart, Chest (Front)</option>
									</optgroup>
									<optgroup label="11 Abdomen">
										<option value="Abdomen">Abdomen</option>
										<option value="Vitalsa">Vitals, Abdomen </option>
										<option value="Digest">Digestive Tract</option>
										<option value="Pelvis">Pelvis</option>
										<option value="116">Groin</option>
									</optgroup>
									<optgroup label="12 Arm (Left)">
										<option value="ArmL">Arm (Left)</option>
										<option value="Forearml">Forearm (Left)</option>
										<option value="Elbowl">Elbow (Left)</option>
										<option value="Upperl">Upper Arm (Left)</option>
										<option value="Shoulderl">Shoulder (Left)</option>
										<option value="Veinla">Vein/Artery, Arm (Left)</option>
									</optgroup>
									<optgroup label="13-14 Leg (Left)">
										<option value="LegL">Leg (Left)</option>
										<option value="Shinl">Shin (Left)</option>
										<option value="Kneel">Knee (Left)</option>
										<option value="Thighl">Thigh (Left)</option>
										<option value="Veinll">Vein/Artery, Leg (Left)</option>
									</optgroup>
									<optgroup label="15 Hand">
										<option value="Hand">Hand</option>
										<option value="HJoint">Hand (Joint)</option>
									</optgroup>
									<optgroup label="16 Foot">
										<option value="Foot">Foot</option>
										<option value="FJoint">Foot (Joint)</option>
									</optgroup>
									<optgroup label="17-18 Neck">
										<option value="Neck">Neck</option>
										<option value="Veeinn">Vein/Artery, Neck</option>
										<option value="Spinen">Spine, Neck (Rear)</option>
									</optgroup>
								</optgroup>
								<optgroup label="Armor Chinks">
									<option value="ChinksT">Chinks (Torso)</option>
									<option value="ChinksO">Chinks (Other)</option>
								</optgroup>
								<optgroup label="Harsh Realism Armor Gaps">
									<option value="ArmpitR">Right Armpit</option>
									<option value="ArmpitL">Left Armpit</option>
									<option value="BoKR">Back of Right Knee</option>
									<option value="BoKL">Back of Left Knee</option>
									<option value="Eyeslit">Eyeslit(s)</option>
									<option value="Cod">Codpiece</option>
									<option value="InsideER">Inside Right Elbow</option>
									<option value="InsideEL">Inside Left Elbow</option>
									<option value="InsideTR">Inside Right Thigh</option>
									<option value="InsideTL">Inside Left Thigh</option>
									<option value="NeckAG">Neck Armor Gap</option>
									<option value="Palm">Open Palm</option>
								</optgroup>
								<optgroup label="Weapons and Equipment">
									<option value="ReachC">Reach C Weapon</option>
									<option value="Reach1">Reach 1 Weapon</option>
									<option value="Reach2">Reach 2 Weapon</option>
								</optgroup>
								<optgroup label="Vehicle Locations">
									<option value="g">Small Glass Window [g]</option>
									<option value="g">Exposed Weapon Mount [X]</option>
									<option value="s">Small Superstructure* [s]</option>
									<option value="s">Independent Turret [t]</option>
									<option value="C">Caterpillar Track [C]</option>
									<option value="C">Draft Animal** [D]</option>
									<option value="C">Helicopter Rotor [H]</option>
									<option value="C">Mast [M]</option>
									<option value="C">Wing [Wi]</option>
									<option value="A">Arm [A]</option>
									<option value="A">Large Superstructure* [S]</option>
									<option value="A">Main Turret* [T]</option>
									<option value="B">Body*</option>
									<option value="BE">Exposed Rider [E]</option>
									<option value="G">Large Glass Window [G]</option>
									<option value="G">Open Cabin [O]</option>
									<option value="R">Runner or Skid [R]</option>
									<option value="R">Wheel [W]</option>
									<option value="V">Vital Area</option>
								</optgroup>
							</select>
						</div>
						<div class="sheet-cell sheet-targetpen sheet-readonly">
							<span name="attr_targetpenalty"></span>
						</div>
						<div class="sheet-cell sheet-targetrestr sheet-readonly">
							<span name="attr_targetrestr"></span>
						</div>
					</div>
					<div class="sheet-subheader sheet-subheader-ranged-modifiers">
						<div class="sheet-cell sheet-targeteffects">
							Target Effects
						</div>
					</div>
					<div class="sheet-row sheet-row-ranged-targeteffects">
						<div class="sheet-cell sheet-targeteffects sheet-readonly">
							<span name="attr_targeteffects"></span>
						</div>
					</div>
				</div> <!-- END TABLE -->
			</div> <!-- END BOX -->		
		
			<div class="sheet-box sheet-box-ranged">
				<div class="sheet-table">
					<div class="sheet-header sheet-ranged-header">
						<div class="sheet-cell sheet-weaponname">
							Ranged Weapons
						</div>
						<div class="sheet-cell sheet-usage">
							Usage
						</div>
						<div class="sheet-cell sheet-lvl">
							<div class="sheet-popup">Lvl</div><span class="sheet-tooltip">Your skill before any modifiers<br />B171.</span>
						</div>
						<div class="sheet-cell sheet-mods">
							<div class="sheet-popup">Mods</div><span class="sheet-tooltip"><strong>Modifiers:</strong><br />Applied relevant conditional modifiers.<br />All modifiers are cumulative.</span>
						</div>
						<div class="sheet-cell sheet-esl">
							<div class="sheet-popup">ESL</div><span class="sheet-tooltip"><strong>effective skill:</strong><br />Your base skill plus<br />or minus any modifiers for<br />the task at hand.<br />B171</span>
						</div>
						<div class="sheet-cell sheet-acc">
							<div class="sheet-popup">Acc</div>
							<span class="sheet-tooltip"><strong>Accuracy:</strong><br /><i>Ranged weapons only.</i>	Add Accuracy to your skill of if you took an Aim maneuver<br />on the turn prior to your attack. If the weapon has a built-in<br />scope, the bonus for this appears as a separate modifier <strong>after</strong> <br />the weapon’s base Acc; e.g., “7+2.”<br />B269; Firearm Accessories see B411
							</span>
						</div>
						<div class="sheet-cell sheet-damage">
							<div class="sheet-popup">Damage</div><span class="sheet-tooltip">Damage rolls are expressed
								as<br />number of dice, sometimes with a<br />modifier. High damage is expressed<br />as
								dice with a multiplier.<br />
								<i>Armor Divisors</i>: A parenthetical number after<br />damage – e.g., (2) – is an <i>armor divisor</i>.<br />
								See Damage and Injury (p. 377) for additional rules.<br />
								<i>Explosions</i>: An “ex” after crushing or burning<br />damage indicates the attack produces an explosion.<br />
								Fragmentation damage appears in brackets. (p. 414)<br />
								<table>
									<thead>
										<tr><th>Abbr</th><th>Damage Type</th></tr>
									</thead>
									<tbody>
										<tr><td>aff</td><td>Affliction</td></tr>
										<tr><td>burn</td><td>Burning</td></tr>
										<tr><td>bu (tb)</td><td>Burning tight beam</td></tr>
										<tr><td>cor</td><td>Corrosion</td></tr>
										<tr><td>cr</td><td>Crushing</td></tr>
										<tr><td>cut</td><td>Cutting</td></tr>
										<tr><td>fat</td><td>Fatigue</td></tr>
										<tr><td>imp</td><td>Impaling</td></tr>
										<tr><td>pi-</td><td>Small Piercing</td></tr>
										<tr><td>pi</td><td>Piercing</td></tr>
										<tr><td>pi+</td><td>Large Piercing</td></tr>
										<tr><td>pi++</td><td>Huge Piercing</td></tr>
										<tr><td>spec</td><td>Special</td></tr>
										<tr><td>tox</td><td>Toxic</td></tr>
									</tbody>
								</table>								
							</span>
						</div>
						<div class="sheet-cell sheet-range">
							<div class="sheet-popup">Range</div>
								<span class="sheet-tooltip">If a weapon has only one range number,<br />this is the Maximum Range (Max) in<br />yards at which it can attack a target. If<br />two numbers appear, separated by a<br />slash, the first is Half-Damage Range<br />(1/2D) and the second is Max.<br />B269</span>
						</div>
						<div class="sheet-cell sheet-rof">
							<div class="sheet-popup">RoF</div>
							<span class="sheet-tooltip">
								<strong>Rate of Fire:</strong>B270<br />The maximum number of shots that can be fired in one turn (by a regular person).<br />
								The minimum number of shots is 1.<br /><br />
								<strong>!</strong>: means the weapon can <i>only</i> fire on “full auto,” <i>Minimum</i> RoF is 1/4 the listed RoF, rounded up.<br /><strong><i>mxn</i></strong>: fires the first number of shots, which each then split into the second number see Shotguns and Multiple Projectiles (p. 409).<br /><strong>Jet</strong>: shoots a continuous stream of fluid. See page 106.
							</span>
						</div>
						<div class="sheet-cell sheet-shots">
							<div class="sheet-popup">Shots</div>
							<span class="sheet-tooltip">The number of shots that can be fired before the weapon must be reloaded.<br />The parenthetical number indicates the number of 1 second ready maneuvers<br />required to reload the weapon.<br /><strong>T</strong>: the weapon is thrown. To "reload" it, pick it up.<br /><strong>i</strong>: you must load the shots individually. the listed time<br />is for each shot.<br />B270
							</span>
						</div>
						<div class="sheet-cell sheet-bulk">
							<div class="sheet-popup">Bulk</div>
							<span class="sheet-tooltip">A measure of the weapon’s size and handiness. Bulk<br />modifies your weapon skill when you take a<br />Move and Attack maneuver (see Move and Attack, p. 365).<br />It also serves as a penalty to Holdout skill when you<br />attempt to conceal the weapon.<br />
							B270</span>
						</div>
						<div class="sheet-cell sheet-rcl">
							<div class="sheet-popup">Rcl</div>
							<span class="sheet-tooltip">
								When firing at RoF 2+, every full multiple of
								Recoil<br />
								by which you make your attack roll means you
								score<br />
								one extra hit, to a maximum number of hits
								equal<br />
								to total shots fired. See page 373.
							</span>
						</div>
						<div class="sheet-cell sheet-minst">
							<div class="sheet-popup">ST</div>
							<span class="sheet-tooltip">
								The minimum Strength required to<br />use the weapon
								properly.
							</span>
						</div>
					</div>
					<fieldset class="repeating_ranged">
						<input class="sheet-toggle" type="checkbox" />
						<span class="sheet-checkbox"></span>
						<div class="sheet-row sheet-row-ranged">
							<div class="sheet-cell sheet-buttonbox">
								<input type="hidden" name="attr_rowid" value="" />
								<button class="sheet-roll-button" type="roll" name="attr_ranged_atkroll" value="!ranged @{character_id} @{rowid} [[@{esl} + @{modifier}]] @{damage} @{type} [[@{notes_onoff}]] [[@{targettype}]] [[@{rounds_fired}]] [[@{recoil}]]"></button>
							</div>
							<div class="sheet-cell sheet-weaponname">
								<input type="text" name="attr_weaponname" placeholder="Weapon Name" />
							</div>
							<div class="sheet-cell sheet-usage">
								<input type="text" name="attr_usage" placeholder="usage" />
							</div>
							<div class="sheet-cell sheet-lvl">
								<input type="number" name="attr_skill" value="0" />
							</div>
							<div class="sheet-cell sheet-mods">
								<input type="number" name="attr_rmods" value="0" readonly="readonly" />
							</div>
							<div class="sheet-cell sheet-esl">
								<input type="number" name="attr_esl" value="0" readonly="readonly"/>
							</div>
							<div class="sheet-cell sheet-acc">
								<input type="text" name="attr_acc" value="0" />
							</div>
							<div class="sheet-cell sheet-damage">
								<input type="text" name="attr_damage" value="1d6" />
							</div>
							<div class="sheet-cell sheet-type">
								<select name="attr_type">
									<option value="aff">aff</option>
									<option value="burn">burn</option>
									<option value="butb">bu (tb)</option>
									<option value="cor">cor</option>
									<option value="cr">cr</option>
									<option value="cut">cut</option>
									<option value="fat">fat</option>
									<option value="imp">imp</option>
									<option value="pi-">pi-</option>
									<option value="pi">pi</option>
									<option value="pi+">pi+</option>
									<option value="pi++">pi++</option>
									<option value="spec">spec</option>
									<option value="tox">tox</option>
								</select>
							</div>
							<div class="sheet-cell sheet-range">
								<input type="text" name="attr_range" value="0" />
							</div>
							<div class="sheet-cell sheet-rof">
								<input type="text" name="attr_rof" value="0" />
							</div>
							<div class="sheet-cell sheet-shots">
								<input type="text" name="attr_shots" value="0" />
							</div>
							<div class="sheet-cell sheet-bulk">
								<input type="text" name="attr_bulk" value="0" />
							</div>
							<div class="sheet-cell sheet-rcl">
								<input type="text" name="attr_recoil" value="0" />
							</div>
							<div class="sheet-cell sheet-minst">
								<input type="text" name="attr_minst" value="0" />	
							</div>
						</div> <!-- Row -->

						<div class="sheet-subheader sheet-attack-options-subhead">
							<div class="sheet-cell sheet-attack-options">
							Attack Options
							</div>
						</div> <!-- Row -->

						<div class="sheet-row sheet-row-ranged-attack-options">
							<div class="sheet-cell sheet-deceptive-attack">
								<div class="sheet-popup">Deceptive Attack:</div><span class="sheet-tooltip"><strong>Deceptive Attack:</strong><br />For every -2 you accept to your own skill,<br />your foe suffers a -1 penalty on his active<br />defenses against this attack.<br />B369</span>
							</div>
							<div class="sheet-cell sheet-deceptive-attack-drop-down">
								<select name="attr_deceptiveatk">
									<option value="0" selected >0</option>
									<option value="-2">-2</option>
									<option value="-4">-4</option>
									<option value="-6">-6</option>
									<option value="-8">-8</option>
									<option value="-10">-10</option>
								</select>
							</div>
							<div class="sheet-cell sheet-dual-weapon">
								<div class="sheet-popup">Dual-Weapon Attack:</div><span class="sheet-tooltip"><strong>Dual Weapon Attack:</strong><br />-4/-8 with primary/off hand<br />(-4/-4 w.Ambidexterity)<br />B417</span>
							</div>
							<div class="sheet-cell sheet-checkboxbox">
								<input type="checkbox" class="sheet-boolean" name="attr_dualweapon" value="-4" />
							</div>
						</div>
						<div class="sheet-row sheet-row-details">
							<div class="sheet-cell sheet-col0">
								<div class="sheet-popup"><input type="checkbox" class="sheet-boolean" name="attr_notes_onoff" checked="checked" value="1" />
								</div><span class="sheet-tooltip">Check to display notes in rolls</span>
							</div>
							<div class="sheet-cell sheet-col1">
								<textarea name="attr_notes" placeholder="notes"></textarea>
							</div>
						</div>
						<div class="sheet-row sheet-row-details-rowid">
							<div class="sheet-cell sheet-col2">
								RowID For Macros
								<input name="attr_rowid" value="" readonly="readonly" />
							</div>
							<div class="sheet-cell sheet-pwield">
								Primary
								<input type="radio" name="attr_wield" value="1" checked="checked" />
							</div>
							<div class="sheet-cell sheet-wield">
								Off-hand
								<input type="radio" name="attr_wield" value="0" />
							</div>
							<div class="sheet-cell sheet-bwield">
								Both
								<input type="radio" name="attr_wield" value="2" />
							</div>
							<div class="sheet-cell sheet-aim">
								<div class="sheet-popup">Aiming</div><span class="sheet-tooltip"><strong>Aim for one turn:</strong><br />+Accuracy of weapon.<br /><i>The sum of Acc and all extra aimed-fire bonuses can never exceed<br />twice the base Acc of the attack.</i> Combined bonus from scopes, sights,<br />and other gadgetry cannot exceed the weapon's base Accuracy<br />B372, HT155</span>
								<div class="sheet-popup"><input type="checkbox" class="sheet-boolean" name="attr_aiming" value="1"/></div><span class="sheet-tooltip">Check to aim.</span>
							</div>
							<div class="sheet-cell sheet-laser">
								<div class="sheet-popup">Laser</div><span class="sheet-tooltip"><strong>Laser Sight</strong><br />If you can see your own aiming<br />dot, you get +1 to hit, regardless of<br />whether you took an Aim maneuver.<br />B412</span>
								<div class="sheet-popup"><input type="checkbox" name="attr_laser" class="sheet-boolean" value="1" /></div><span class="sheet-tooltip">Check to use laser sight</span>
							</div>
							<div class="sheet-cell sheet-tgtsys">
								<div class="sheet-cell sheet-subcell">
									<div class="sheet-popup">Tgt. Sys.</div><span class="sheet-tooltip"><strong>Targeting Systems</strong><br />smartgun systems, fire control systems,<br />even computers The combined bonus<br />from all such gadgetry can’t exceed<br />the weapon’s base Accuracy<br />B412</span>
								</div>
								<div class="sheet-cell sheet-tgtsyssubcell">
									<input type="number" name="attr_tgtsys" value="0" step="1" />
								</div>
							</div>
							<div class="sheet-cell sheet-scope">
								<div class="sheet-cell sheet-subcell">
									<div class="sheet-popup">Scope</div><span class="sheet-tooltip"><strong>Scope</strong><br />A telescopic sight, or “scope,” gives a bonus to hit if you take an Aim maneuver.<br />Enter the combined bonus of all targeting systems<br />B420</span>
								</div>
								<div class="sheet-cell sheet-subcell">
									<div class="sheet-cell sheet-checkboxbox">
										<div class="sheet-popup"><input type="checkbox" name="attr_scopeonoff" class="sheet-boolean" value="1" /></div><span class="sheet-tooltip">Check to use scope</span>
									</div>
									<div class="sheet-cell sheet-scopebonus">
										<div class="sheet-popup"><input type="number" name="attr_scopebonus" placeholder="0" /></div><span class="sheet-tooltip">Enter Scope acc bonus</span>
									</div>
								</div>								
							</div>
							<div class="sheet-cell sheet-braced">
								<div class="sheet-popup">Braced</div><span class="sheet-tooltip"><strong>Braced</strong><br />+1 if stationary and took a turn to Aim.</span>		
								<input type="checkbox" class="sheet-boolean" name="attr_braced" value="1" />
							</div>
							<div class="sheet-hidden">
								<input type="number" name="attr_tgtsysbonus" value="0" readonly="readonly" />
								<input type="number" name="attr_aimingbonus" value="0" readonly="readonly" />
								<input type="number" name="attr_ttlaimbonus" value="0" readonly="readonly" />
								<input type="number" name="attr_offhand" value="0" readonly="readonly" />
								<input type="number" name="attr_ccbtpenalty" value="0" readonly="readonly" />
								<input type="number" name="attr_stdeficit" value="0" readonly="readonly" />
								<input type="number" name="attr_tgtbehindpen" value="0" readonly="readonly" />
								<input type="number" name="attr_visionpenalty" value="0" readonly="readonly" />
								<input type="number" name="attr_accbonus" value="0" readonly="readonly" />
							</div>
						</div>
					</fieldset> <!-- .repeating_ranged -->
				</div>
			</div>
			

		
		</div> <!-- END RANGED SUBTAB -->



		<!-- _____ _____ VEHICLE COMBAT SUBTAB _____ _____ -->
		<div class="sheet-section sheet-section-vehiclecombat">
			<div class="sheet-box sheet-vehstats">
				<div class="sheet-table">
					<div class="sheet-header sheet-header-vehstats">
						<div class="sheet-cell sheet-vehname">
							<div class="sheet-popup" >Vehicle Name</div><span class="sheet-tooltip"><strong>Vehicle Name:</strong><br />Name and/or type of vehicle.</span></div>
						<div class="sheet-cell sheet-STHP">
							<div class="sheet-popup">ST/HP</div><span class="sheet-tooltip"><strong>ST/HP:</strong><br />The vehicle’s ST and HP. These<br />are equal for a powered vehicle: the vehicle’s<br />mass determines both how powerful<br />its engine must be (ST) and how hard it is<br />to destroy (HP). For an unpowered vehicle,<br />this score is marked with a †, and represents<br />HP only; ST is 0. Unpowered vehicles<br />have Injury Tolerance (Homogenous); others<br />have the Machine meta-trait (p. 263),<br />which includes Injury Tolerance (Unliving).</span>
						</div>
						<div class="sheet-cell sheet-HndSR">
							<div class="sheet-popup">Hnd/SR</div><span class="sheet-tooltip"><strong>Hnd/SR:</strong><br />The first number is Handling; the second is Stability Rating.<br />See Control Rolls B466</span>
						</div>
						<div class="sheet-cell sheet-HT">
							<div class="sheet-popup">HT</div><span class="sheet-tooltip"><strong>HT:</strong><br />The vehicle’s HT, a measure of reliability<br />and ruggedness. Fragile vehicles have an<br />additional code: “c” for Combustible, “f” for<br />Flammable, or “x” for Explosive.</span>
						</div>
						<div class="sheet-cell sheet-move">
							<div class="sheet-popup">Move</div><span class="sheet-tooltip"><strong>Move</strong><br />The first number is Acceleration and the second is Top Speed, in<br />yards/second (double this to get mph). These statistics are<br />equivalent to a character’s<br />Move and his top speed with Enhanced Move. For ground vehicles, a * indicates a roadbound vehicle,<br />while a ‡ indicates one that must follow rails. For spacecraft,<br />divide Acceleration by 10 to find it in Earth gravities (G), and note<br />that c means the speed of light (186,000 miles/second).</span>
						</div>
						<div class="sheet-cell sheet-LWt">
							<div class="sheet-popup">LWt.</div><span class="sheet-tooltip"><strong>LWt.:</strong><br />Loaded Weight, in tons (1 ton = 2,000 lbs.), with maximum<br />payload and a full load of fuel. Actual weight is often lower.</span>
						</div>
						<div class="sheet-cell sheet-load">
							<div class="sheet-popup">Load</div><span class="sheet-tooltip"><strong>Load:</strong><br />The weight, in tons, of occupants and cargo the vehicle<br />can carry, including the operator. To find cargo capacity,<br />subtract the weight of occupants (for simplicity, assume<br />0.1 ton/person, including gear). To find “curb weight”<br />(with fuel but no other payload), subtract Load from LWt.</span>
						</div>
						<div class="sheet-cell sheet-SM">
							<div class="sheet-popup">SM</div><span class="sheet-tooltip"><strong>SM:</strong><br />The vehicle’s Size Modifier.</span>
						</div>
						<div class="sheet-cell sheet-Occ">
							<div class="sheet-popup">Occ</div><span class="sheet-tooltip"><strong>Occ.:</strong><br />The number of occupants the vehicle can carry in<br />reasonable comfort, given as “crew+passengers”; e.g.,<br />2+6 means two crew and six passengers. “A” indicates<br />a vehicle built for long-term accommodation, with<br />room to sleep, cook, etc. If the vehicle affords the<br />occupants special protection, there is an additional<br />code: “S” for Sealed (p. 82), “P” for Pressure Support<br />(p. 77), or “V” for Vacuum Support (p. 96).</span>
						</div>
						<div class="sheet-cell sheet-DR">
							<div class="sheet-popup">DR</div><span class="sheet-tooltip"><strong>DR</strong><br />The vehicle’s DR. Some vehicles have different DR on<br />various faces or locations. The table lists the two most<br />important DR scores – for ground vehicles, this is usually<br />the front DR and the average of side and rear DR.</span>
						</div>
						<div class="sheet-cell sheet-range">
							<div class="sheet-popup">Range</div><span class="sheet-tooltip"><strong>Range:</strong><br />The travel distance, in miles, before the vehicle runs out<br />of fuel. For unpowered or exotic vehicles, “–” means only<br />provisions (food and water) limit range. “F” means the FP<br />of the rowers or draft animals, and stored provisions,<br />limit range. Spacecraft either omit this statistic or use the<br />entry to give faster-than-light drive capabilities.</span>
						</div>
						<div class="sheet-cell sheet-cost">
							<div class="sheet-popup">Cost</div><span class="sheet-tooltip"><strong>Cost:</strong><br />The vehicle’s cost, in $. “K” means<br />thousands; “M” means millions.</span>
						</div>
						<div class="sheet-cell sheet-locations">
							<div class="sheet-popup">Locations</div><span class="sheet-tooltip"><strong>Locations:</strong><br />The vehicle’s hit locations, besides its body. If a<br />vehicle has multiple instances of a location, a<br />quantity precedes the abbreviation; e.g., “3M” for<br />a three-masted ship, or “14D” for 14 draft<br />animals. A vehicle’s hit locations determine both<br />how it moves (see Basic Vehicle Movement,<br />below) and what parts can be hit in combat (see<br />Vehicle Hit Location Table, p. 554). separate<br />description will detail weapons and equipment.</span>
						</div>
						<div class="sheet-cell sheet-vehnotes">
							<div class="sheet-popup">Notes</div><span class="sheet-tooltip"><strong>Notes</strong><br />See below for explanations</span>
						</div>
					</div>
					<div class="sheet-row sheet-row-vehstats">
						<div class="sheet-cell sheet-vehname">
							<input type="text" name="attr_vehname" value="" placeholder="Vehicle name"/>
						</div>
						<div class="sheet-cell sheet-STHP">
							<input type="text" name="attr_sthp" value="0" />
						</div>
						<div class="sheet-cell sheet-Hnd">
							<input type="text" name="attr_Hnd" value="0" />
						</div>
						<div class="sheet-cell sheet-slash">/</div>
						<div class="sheet-cell sheet-SR">
							<input type="text" name="attr_SR" value="0"/>
						</div>
						<div class="sheet-cell sheet-HT">
							<input type="text" name="attr_vehHT" value="0"/>
						</div>
						<div class="sheet-cell sheet-move">
							<input type="text" name="attr_vehMove" value="0" />
						</div>
						<div class="sheet-cell sheet-LWt">
							<input type="number" name="attr_LWt" value="0.00"/>
						</div>
						<div class="sheet-cell sheet-load">
							<input type="number" name="attr_vehLoad" value="0.00"/>
						</div>
						<div class="sheet-cell sheet-SM">
							<input type="number" name="attr_vehSM" value="0"/>
						</div>
						<div class="sheet-cell sheet-Occ">
							<input type="text" name="attr_Occ" value="0 + 0" />
						</div>
						<div class="sheet-cell sheet-DR">
							<input type="text" name="attr_vehDR" value="" placeholder="0" />
						</div>
						<div class="sheet-cell sheet-range">
							<input type="text" name="attr_vehRange" value="" placeholder="000" />
						</div>
						<div class="sheet-cell sheet-cost">				<input type="text" name="attr_vehCost" value="$0"/>
						</div>
						<div class="sheet-cell sheet-locations">
							<input type="text" name="attr_vehLocations" value="" placeholder="Locations" />
						</div>
						<div class="sheet-cell sheet-notes">
							<input type="text" name="attr_vehNotes" value="" placeholder="Notes" />
						</div>
					</div>
				</div>
				<div class="sheet-row sheet-row-vehstats">
					<div class="sheet-cell sheet-vehtextbox">
						<input type="text" name="attr_vehnotestext" placeholder="notes"/>
					</div>
				</div>
			</div>
			<div class="sheet-box sheet-box-vehw-modifiers">
				<div class="sheet-table">
					<div class="sheet-row sheet-header-vehw-modifiers">
						<div class="sheet-header sheet-header-vehw-modifiers">
							<div class="sheet-cell sheet-col0">
								<div class="sheet-popup">VEHICLE ATTACK MODIFIERS:  
								</div><span class="sheet-tooltip">1. Taking your base skill with the weapon or unarmed attack you are using. (In<br />some situations, another skill – e.g., Free Fall, Riding, or Environment Suit – will limit this skill.)<br />2. Applying the relevant conditional modifiers below. Modifiers are cumulative, but<br />combined visibility penalties cannot exceed -10 (-6, if used to blindness). If any modifier<br />marked with an asterisk (*) applies, adjusted skill after all modifiers cannot exceed 9.</span><input type="hidden" name="attr_vehtotal_veh_mod" value="0" />
							</div>
							<div class="sheet-cell sheet-targetreset">
						        <div class="sheet-popup"><button type="action" name="act_veh_reset" class="reset">Reset</button></div><span class="sheet-tooltip">Reset the modifiers</span>
						    </div>
						</div>
					</div>
					<div class="sheet-row sheet-row-vehw-modifiers">
						<div class="sheet-cell sheet-badfoot">
							<div class="sheet-popup">Bad footing:</div><span class="sheet-tooltip"><strong>Bad footing:</strong><br />-1 or more (GM’s option)</span>
						</div>
						<div class="sheet-cell sheet-badfootnum">
							<input type="number" name="attr_badfoot" value="0" step="1" />
						</div>
						<div class="sheet-cell sheet-ccbt">
							<div class="sheet-popup">CCBT:</div><span class="sheet-tooltip"><strong>Close Combat:</strong><br />Check box to apply a penalty equal to the weapon’s Bulk statistic<br />(see Weapons for Close Combat, p. 391)</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="checkbox" class="sheet-boolean" name="attr_rangedccbt" value="1" />
						</div>
						<div class="sheet-cell sheet-damweapon">
							<div class="sheet-popup">Damaged Weapon:</div><span class="sheet-tooltip"><strong>Damaged weapon:</strong><br />-HP of injury received last turn (maximum -4)</span>
						</div>
						<div class="sheet-cell sheet-damweaponnum">
							<input type="number" name="attr_damagedweapon" value="0" min="-4" max="0"/>
						</div>
						<div class="sheet-cell sheet-distraction">
							<div class="sheet-popup">Distraction:</div><span class="sheet-tooltip"><strong>Minor Distraction:</strong><br />(e.g., part of clothes on fire): -2<br /><strong>Major Distraction:</strong><br />(e.g., all clothes on fire):<br />-3 or more (GM’s option)<br />B547</span>
						</div>
						<div class="sheet-cell sheet-distractnum">
							<div class="sheet-popup"><input type="number" name="attr_distraction" value="0" /></div><span class="sheet-tooltip"><strong>Major Distraction:</strong><br />(e.g., all clothes on fire):<br />-3 or more (GM’s option) B547</span>
						</div>
						<div class="sheet-cell sheet-extraim">
							<div class="sheet-popup">Extra Aim:</div><span class="sheet-tooltip"><strong>Extra Aim:</strong><br />If you Aim for more than one second,<br />you receive an additional bonus</span>
						</div>
						<div class="sheet-cell sheet-extraselect">
							<select name="attr_extraaim">
								<option value="0">None</option>
								<option value="1">2 sec</option>
								<option value="2">3+ sec</option>
							</select>
						</div>
						
						<div class="sheet-cell sheet-popupattack">
							<div class="sheet-popup">Pop-up Attack:</div><span class="sheet-tooltip"><strong>Pop-up Attack:</strong><br />a special Attack maneuver in which you emerge<br />from cover, move no more than one hex, make<br />a ranged attack, and return to cover</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="checkbox" class="sheet-boolean" name="attr_popup" value="-2" />
						</div>
						
						<div class="sheet-cell sheet-unfam">
							<div class="sheet-popup">Unfamiliar:</div><span class="sheet-tooltip"><strong>Unfamiliar weapon or targeting system:</strong> -2<br />B522</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="checkbox" class="sheet-boolean" name="attr_unfam" value="-2" />
						</div>
						<div class="sheet-cell sheet-rapidfire">
								<div class="sheet-popup">Rapid fire:</div><span class="sheet-tooltip"><strong>Rapid Fire:</strong><br />You must decide how many shots (up to RoF) you wish to fire before you make your attack roll.<br />Firing a large number of shots per attack gives a bonus to hit</span>
							</div>
							<div class="sheet-cell sheet-rapidnum">
								<input type="number" name="attr_rapidfire" step="1" value="0" />
							</div>
							<div class="sheet-hidden">
								
							</div>
					</div>
					<div class="sheet-row sheet-row-vehw-modifiers">
						<div class="sheet-cell sheet-oppfire">
							<div class="sheet-popup">Opp. Fire:</div><span class="sheet-tooltip">If you have a ranged weapon, you<br />may watch a specified area and attack<br />as soon as a target presents itself.</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="checkbox" class="sheet-boolean" name="attr_oppfireon" value="1" />
						</div>
						<div class="sheet-cell sheet-checktgt">
							<div class="sheet-popup">Check:</div><span class="sheet-tooltip"><strong>Target Discrimination:</strong><br />
								Normally, when you take opportunity fire,<br />you must attack the first target that<br />appears in the designated area – friend<br />or foe! You are free to specify that you<br />are not attacking automatically, usually to<br />avoid shooting a friend.
								<br />B390</span>
						</div>
						<div class="sheet-cell sheet-oppfirena">
							Yes:
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<div class="sheet-popup"><input type="radio" name="attr_vehoppfire" value="-2" /></div><span class="sheet-tooltip"><strong>Yes:</strong><br />additional -2<br />B390</span>
						</div>
						<div class="sheet-cell sheet-oppfireno">
							No:
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<div class="sheet-popup"><input type="radio" name="attr_oppfire" value="0" /></div><span class="sheet-tooltip"><strong>No:</strong><br />No additional penalty<br />B390</span>
						</div>
						<div class="sheet-cell sheet-opphexes">
							<div class="sheet-popup">Hexes:</div><span class="sheet-tooltip">
								<table>
								<thead>
									<tr><th>Hexes</th><th>Penalty</th></tr>
								</thead>
								<tbody>
									<tr><td>1</td><td>0</td></tr>
									<tr><td>2</td><td>-1</td></tr>
									<tr><td>3-4</td><td>-2</td></tr>
									<tr><td>5-6</td><td>-3</td></tr>
									<tr><td>7-10</td><td>-4</td></tr>
									<tr><td>11+</td><td>-5</td></tr>
									<tr><td>Line</td><td>-2</td></tr>
								</tbody>
							</table>
						</span>
						</div>
						<div class="sheet-cell sheet-hexselect">
							<select name="attr_hexes">
								<option value="0" selected>1</option>
								<option value="-1">2</option>
								<option value="-2">3-4</option>
								<option value="-3">5-6</option>
								<option value="-4">7-10</option>
								<option value="-5">11+</option>
								<option value="-2">line</option>
							</select>
						</div>
						<div class="sheet-cell sheet-cannotseeany">
							Blind:
						</div>
						<div class="sheet-cell sheet-csana">
							N/A:
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="radio" name="attr_rangedcannotsee" value="0" checked />
						</div>
						<div class="sheet-cell sheet-yesblind">
							<div class="sheet-popup">Yes:</div><span class="sheet-tooltip"><strong>Cannot See</strong><br /><i>Not</i> used to being blind</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="radio" name="attr_rangedcannotsee" value="-10" />
						</div>
						<div class="sheet-cell sheet-yesblind">
							<div class="sheet-popup">Yes:</div><span class="sheet-tooltip"><strong>Cannot See</strong><br />used to being blind</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="radio" name="attr_rangedcannotsee" value="-6" />
						</div>
						<div class="sheet-cell sheet-cannotseefoe">
							Can't see foe:
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<div class="sheet-popup"><input type="radio" name="attr_rangedcannotsee" value="-6" /></div><span class="sheet-tooltip"><strong>Cannot See Foe</strong>
							</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<div class="sheet-popup"><input type="radio" name="attr_rangedcannotsee" value="-4" /></div><span class="sheet-tooltip"><strong>Cannot See Foe</strong><br />Know where he is within 1 yd.</span>
						</div>
						<div class="sheet-cell sheet-partialvis">
							<div class="sheet-popup">Partial:</div><span class="sheet-tooltip"><strong>Partial Visibility:</strong><br />darkness, fog, smoke, etc.<br />B394</span>
						</div>
						<div class="sheet-cell sheet-partialvisnum">
							<input type="number" name="attr_visionpenalty" max="0" min="-10" value="0" />
						</div>
						<div class="sheet-cell sheet-nightvision">
							<div class="sheet-popup">Night Vision:</div><span class="sheet-tooltip"><strong>Night Vision:</strong><br />
								Regardless of level, Night Vision only works in<br />partial darkness. It has no effect on the -10 for total darkness.
								<br />B71</span>
						</div>
						<div class="sheet-cell sheet-nightvisionnum">
							<input type="number" name="attr_nightvision" min="0" max="9" value="0" />
						</div>
					</div>
					<div class="sheet-row sheet-row-vehw-modifiers">
						<div class="sheet-cell sheet-terrainlabel">
							Terrain:
						</div>
						<div class="sheet-cell sheet-terrainselect">
							<select name="attr_terrain">
								<option value="1">Air</option>
								<option value="0">Space</option>
							<optgroup label="Ground">
								<option value="2">Good Road</option>
								<option value="3">Bad Road</option>
								<option value="4">Off-Road</option>
							</optgroup>
							<optgroup label="Water">
								<option value="5">Calm Water</option>
								<option value="6">Rough Water</option>
							</optgroup>
							</select>
						</div>
						<div class="sheet-cell sheet-hanging">
							Exposed rider hanging on side of vehicle/mount and shooting over/under it:
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="checkbox" class="sheet-boolean" name="attr_hangingrider" value="-6" />
						</div>
						<div class="sheet-cell sheet-failedctrl">
							<div class="sheet-popup">Failed control roll:</div><span class="sheet-tooltip"><strong>Vehicle/mount failed control roll:</strong><br />penalty equal to margin of failure. B548</span>
						</div>
						<div class="sheet-cell sheet-failedctrlinput">
							<input type="number" name="attr_failedctrl" value="0" />
						</div>
					</div>
					<div class="sheet-row sheet-row-vehw-modifiers">
						<div class="sheet-cell sheet-turnedseat">
							Turned in exposed saddle/seat of vehicle/mount firing at foe behind:
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="checkbox" class="sheet-boolean" name="attr_turnedrider" value="-4" />
						</div>
						<div class="sheet-cell sheet-vdodge">
							Vehicle/mount dodged last turn:
						</div>
						<div class="sheet-cell sheet-dodgeselect">
							<select name="attr_vehdodged">
								<option value="0" selected>No</option>
								<option value="-2">Yes & Not Operator</option>
								<option value="-4">As above & Flying</option>
							</select>
						</div>
						
					</div>
					<div class="sheet-subheader sheet-subheader-vehw-modifiers">
						<div class="sheet-cell sheet-targetsize">
							<div class="sheet-popup">Target Size</div><span class="sheet-tooltip"><strong>Size Modifier Table</strong><br />
							<table>
								<thead>
									<tr><th>Size</th><th>Measure</th><th>Size</th><th>Measure</th></tr>
								</thead>
								<tbody>
									<tr><td>-15</td><td>1/5"</td><td>0</td><td>2 yd.</td></tr>
									<tr><td>-14</td><td>1/3"</td><td>1</td><td>3 yd.</td></tr>
									<tr><td>-13</td><td>1/2"</td><td>2</td><td>5 yd.</td></tr>
									<tr><td>-12</td><td>2/3"</td><td>3</td><td>7 yd.</td></tr>
									<tr><td>-11</td><td>1"</td><td>4</td><td>10 yd.</td></tr>
									<tr><td>-10</td><td>1.5"</td><td>5</td><td>15 yd.</td></tr>
									<tr><td>-9</td><td>2"</td><td>6</td><td>20 yd.</td></tr>
									<tr><td>-8</td><td>3"</td><td>7</td><td>30 yd.</td></tr>
									<tr><td>-7</td><td>5"</td><td>8</td><td>50 yd.</td></tr>
									<tr><td>-6</td><td>8"</td><td>9</td><td>70 yd.</td></tr>
									<tr><td>-5</td><td>1 ft.</td><td>10</td><td>100 yd.</td></tr>
									<tr><td>-4</td><td>1.5 ft.</td><td>11</td><td>150 yd.</td></tr>
									<tr><td>-3</td><td>2 ft.</td><td>12</td><td>200 yd.</td></tr>
									<tr><td>-2</td><td>1 yd.</td><td>13</td><td>300 yd.</td></tr>
									<tr><td>-1</td><td>1.5 yd.</td><td>14</td><td>500 yd.</td></tr>
								</tbody>
							</table></span>
						</div>
						<div class="sheet-cell sheet-targetspeed">
							<div class="sheet-popup">Target Speed</div><span class="sheet-tooltip">Fast targets – includes anything that requires the High-Speed Movement rules (p. 394)<br />GM may rule that speed is important enough to consider. In that case,<br />add speed in yards/second (2 mph = 1 yard/second)<br />If the speed falls between two values, use the higher</span>
						</div>
						<div class="sheet-cell sheet-targetrange">
							<div class="sheet-popup">Target Range</div><span class="sheet-tooltip">Note that there is no modifier at ranges of 2 yards or less – shooting a close<br />target is no easier (and no harder) than attacking it in melee combat!<br />If the range falls between two values, use the higher</span>
						</div>
						<div class="sheet-cell sheet-targetdir">
							<div class="popup">Direction</div><span class="tooltip">
						   Ignore up/down for beam type weapons like lasers.</span>
						</div>
						<div class="sheet-cell sheet-targetelev">
							<div class="sheet-popup">Elevation</div><span class="sheet-tooltip">Elevation: elevation is up if you are below your target.<br />Elevation is down if you above your target.</span>
						</div>
						<div class="sheet-cell sheet-targetreset">
							&nbsp;
						</div>
						<div class="sheet-cell sheet-targetcover">
							Target Cover
						</div>
					</div>
					<div class="sheet-row sheet-row-vehw-modifiers">
						<div class="sheet-cell sheet-targetsize">
							<input type="number" step="1" value="0" name="attr_firing_size_mod" />
						</div>
						<div class="sheet-cell sheet-targetspeed">
							<input type="number" step="1" value="0" min="0" name="attr_firing_speed_difference" />
						</div>
						<div class="sheet-cell sheet-targetrange">
							<input type="number" step="1" value="0" min="0" name="attr_firing_distance" />
						</div>
						<div class="sheet-cell sheet-targetdir">
    					    <select name="attr_firing_direction">
    					        <option value="linear">Normal</option>
    					        <option value="up">Elev. Up</option>
    					        <option value="dn">Elev. Down</option>
    					    </select>
    					</div>
    				    <div class="sheet-cell sheet-targetelev">
    					    <input type="number" step="1" value="0" min="0" name="attr_firing_up_dwn_distance" />
    					</div>
						<div class="sheet-cell sheet-lightcover">
							<div class="sheet-popup">Light Cover:</div><span class="sheet-tooltip"><strong>Shooting through light cover:</strong> -2<br />B408</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="checkbox" class="sheet-boolean" name="attr_lightcover" value="-2" />
						</div>
						<div class="sheet-cell sheet-targetbehind">
							<div class="sheet-popup">Behind Someone:</div><span class="sheet-tooltip"><strong>Target behind someone else:</strong> -4 per intervening figure.<br />B522</span>
						</div>
						<div class="sheet-cell sheet-targetbehindnum">
							<div class="sheet-popup"><input type="number" name="attr_targetbehind" value="0" step="1" /></div><span class="sheet-tooltip"><strong>Enter number of figures:</strong></span>
						</div>
						<div class="sheet-cell sheet-posture">
							<div class="sheet-popup">Posture:</div><span class="sheet-tooltip"><strong>Target Posture:</strong><br />Target crouching, kneeling, sitting, or lying down: an extra -2 to hit torso, groin, or legs<br />B522</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="checkbox" class="sheet-boolean" name="attr_targetposture" value="-2" />
						</div>
						<div class="sheet-cell sheet-partialcover">
							<div class="sheet-popup">Partial Cover:</div><span class="sheet-tooltip"><strong>Target only partly exposed:</strong> -2<br />B522</span>
						</div>
						<div class="sheet-cell sheet-checkboxbox">
							<input type="checkbox" class="sheet-boolean" name="attr_targetpartialcover" value="-2" />
						</div>
					</div>
					<div class="sheet-subheader sheet-subheader-vehw-modifiers">
						<div class="sheet-cell sheet-targetloc">
							Location
						</div>
						<div class="sheet-cell sheet-targetpen">
							Penalty
						</div>
						<div class="sheet-cell sheet-targetrestr">
							Target Restrictions
						</div>
					</div>
					<div class="sheet-row sheet-row-vehw-modifiers">	
						<div class="sheet-cell sheet-targetloc">
							<select name="attr_targetloc">
								<option value="random">Random Body</option>
								<option value="vehicle">Random Vehicle</option>
								<optgroup label="Body Locations">
									<optgroup label="3-4 Skull">
										<option value="skull">Skull (Front)</option>
										<option value="skullr">Skull (Back)</option>
									</optgroup>
									<optgroup label="5 Face">
										<option value="facef">Face (Front)</option>
										<option value="facer">Face (Rear)</option>
										<option value="Jaw">Jaw</option>
										<option value="Nose">Nose</option>
										<option value="Ear">Ear</option>
										<option value="Cheek">Cheek</option>
										<option value="Eye">Eye</option>
									</optgroup>
									<optgroup label="6-7 Leg (Right)">
										<option value="LegR">Leg</option>
										<option value="Shinr">Shin (Right)</option>
										<option value="Kneer">Knee (Right)</option>
										<option value="Thighr">Thigh (Right)</option>
										<option value="Veinlr">Vein/Artery, Leg (Right)</option>
									</optgroup>
									<optgroup label="8 Arm (Right)">
										<option value="ArmR">Arm</option>
										<option value="Forearmr">Forearm (Right)</option>
										<option value="Elbowr">Elbow (Right)</option>
										<option value="Upperr">Upper Arm (Right)</option>
										<option value="Shoulderr">Shoulder (Right)</option>
										<option value="Veinra">Vein/Artery, Arm (Right)</option>						
									</optgroup>
									<optgroup label="9-10 Chest">
										<option value="Chest" selected>Chest (Default)</option>
										<option value="Vitalsc">Vitals, Chest (Front)</option>
										<option value="Spinec">Spine, Chest (Rear)</option>
										<option value="Heart">Heart, Chest (Front)</option>
									</optgroup>
									<optgroup label="11 Abdomen">
										<option value="Abdomen">Abdomen</option>
										<option value="Vitalsa">Vitals, Abdomen </option>
										<option value="Digest">Digestive Tract</option>
										<option value="Pelvis">Pelvis</option>
										<option value="116">Groin</option>
									</optgroup>
									<optgroup label="12 Arm (Left)">
										<option value="ArmL">Arm (Left)</option>
										<option value="Forearml">Forearm (Left)</option>
										<option value="Elbowl">Elbow (Left)</option>
										<option value="Upperl">Upper Arm (Left)</option>
										<option value="Shoulderl">Shoulder (Left)</option>
										<option value="Veinla">Vein/Artery, Arm (Left)</option>
									</optgroup>
									<optgroup label="13-14 Leg (Left)">
										<option value="LegL">Leg (Left)</option>
										<option value="Shinl">Shin (Left)</option>
										<option value="Kneel">Knee (Left)</option>
										<option value="Thighl">Thigh (Left)</option>
										<option value="Veinll">Vein/Artery, Leg (Left)</option>
									</optgroup>
									<optgroup label="15 Hand">
										<option value="Hand">Hand</option>
										<option value="HJoint">Hand (Joint)</option>
									</optgroup>
									<optgroup label="16 Foot">
										<option value="Foot">Foot</option>
										<option value="FJoint">Foot (Joint)</option>
									</optgroup>
									<optgroup label="17-18 Neck">
										<option value="Neck">Neck</option>
										<option value="Veeinn">Vein/Artery, Neck</option>
										<option value="Spinen">Spine, Neck (Rear)</option>
									</optgroup>
								</optgroup>
								<optgroup label="Armor Chinks">
									<option value="ChinksT">Chinks (Torso)</option>
									<option value="ChinksO">Chinks (Other)</option>
								</optgroup>
								<optgroup label="Harsh Realism Armor Gaps">
									<option value="ArmpitR">Right Armpit</option>
									<option value="ArmpitL">Left Armpit</option>
									<option value="BoKR">Back of Right Knee</option>
									<option value="BoKL">Back of Left Knee</option>
									<option value="Eyeslit">Eyeslit(s)</option>
									<option value="Cod">Codpiece</option>
									<option value="InsideER">Inside Right Elbow</option>
									<option value="InsideEL">Inside Left Elbow</option>
									<option value="InsideTR">Inside Right Thigh</option>
									<option value="InsideTL">Inside Left Thigh</option>
									<option value="NeckAG">Neck Armor Gap</option>
									<option value="Palm">Open Palm</option>
								</optgroup>
								<optgroup label="Weapons and Equipment">
									<option value="ReachC">Reach C Weapon</option>
									<option value="Reach1">Reach 1 Weapon</option>
									<option value="Reach2">Reach 2 Weapon</option>
								</optgroup>
								<optgroup label="Vehicle Locations">
									<option value="g">Small Glass Window [g]</option>
									<option value="g">Exposed Weapon Mount [X]</option>
									<option value="s">Small Superstructure* [s]</option>
									<option value="s">Independent Turret [t]</option>
									<option value="C">Caterpillar Track [C]</option>
									<option value="C">Draft Animal** [D]</option>
									<option value="C">Helicopter Rotor [H]</option>
									<option value="C">Mast [M]</option>
									<option value="C">Wing [Wi]</option>
									<option value="A">Arm [A]</option>
									<option value="A">Large Superstructure* [S]</option>
									<option value="A">Main Turret* [T]</option>
									<option value="B">Body*</option>
									<option value="BE">Exposed Rider [E]</option>
									<option value="G">Large Glass Window [G]</option>
									<option value="G">Open Cabin [O]</option>
									<option value="R">Runner or Skid [R]</option>
									<option value="R">Wheel [W]</option>
									<option value="V">Vital Area</option>
								</optgroup>
							</select>
							
						</div>
						<div class="sheet-cell sheet-targetpen sheet-readonly">
							<span name="attr_targetpenalty"></span>
						</div>
						<div class="sheet-cell sheet-targetrestr sheet-readonly">
							<span name="attr_targetrestr"></span>
						</div>
					</div>
					<div class="sheet-subheader sheet-subheader-vehw-modifiers">
						<div class="sheet-cell sheet-targeteffects">
							Target Effects
						</div>
					</div>
					<div class="sheet-row sheet-row-vehw-targeteffects">
						<div class="sheet-cell sheet-targeteffects sheet-readonly">
							<span name="attr_targeteffects"></span>
						</div>
					</div>
				</div> <!-- END TABLE -->
			</div> <!-- END BOX -->		
			<div class="sheet-box sheet-box-vehw">
				<div class="sheet-table">
					<div class="sheet-header sheet-vehw-header">
						<div class="sheet-cell sheet-weaponname">
							Vehicle Weapons
						</div>
						<div class="sheet-cell sheet-usage">
							Usage
						</div>
						<div class="sheet-cell sheet-lvl">
							<div class="sheet-popup">Lvl</div><span class="sheet-tooltip">Your skill before any modifiers<br />B171.</span>
						</div>
						<div class="sheet-cell sheet-mods">
							<div class="sheet-popup">Mods</div><span class="sheet-tooltip"><strong>Modifiers:</strong><br />Applied relevant conditional modifiers.<br />All modifiers are cumulative.</span>
						</div>
						<div class="sheet-cell sheet-esl">
							<div class="sheet-popup">ESL</div><span class="sheet-tooltip"><strong>effective skill:</strong><br />Your base skill plus<br />or minus any modifiers for<br />the task at hand.<br />B171</span>
						</div>
						<div class="sheet-cell sheet-acc">
							<div class="sheet-popup">Acc</div>
							<span class="sheet-tooltip"><strong>Accuracy:</strong><br /><i>Ranged weapons only.</i>	Add Accuracy to your skill of if you took an Aim maneuver<br />on the turn prior to your attack. If the weapon has a built-in<br />scope, the bonus for this appears as a separate modifier <strong>after</strong> <br />the weapon’s base Acc; e.g., “7+2.”<br />B269; Firearm Accessories see B411
							</span>
						</div>
						<div class="sheet-cell sheet-damage">
							<div class="sheet-popup">Damage</div><span class="sheet-tooltip">Damage rolls are expressed
								as<br />number of dice, sometimes with a<br />modifier. High damage is expressed<br />as
								dice with a multiplier.<br />
								<i>Armor Divisors</i>: A parenthetical number after<br />damage – e.g., (2) – is an <i>armor divisor</i>.<br />
								See Damage and Injury (p. 377) for additional rules.<br />
								<i>Explosions</i>: An “ex” after crushing or burning<br />damage indicates the attack produces an explosion.<br />
								Fragmentation damage appears in brackets. (p. 414)<br />
								<table>
									<thead>
										<tr><th>Abbr</th><th>Damage Type</th></tr>
									</thead>
									<tbody>
										<tr><td>aff</td><td>Affliction</td></tr>
										<tr><td>burn</td><td>Burning</td></tr>
										<tr><td>bu (tb)</td><td>Burning tight beam</td></tr>
										<tr><td>cor</td><td>Corrosion</td></tr>
										<tr><td>cr</td><td>Crushing</td></tr>
										<tr><td>cut</td><td>Cutting</td></tr>
										<tr><td>fat</td><td>Fatigue</td></tr>
										<tr><td>imp</td><td>Impaling</td></tr>
										<tr><td>pi-</td><td>Small Piercing</td></tr>
										<tr><td>pi</td><td>Piercing</td></tr>
										<tr><td>pi+</td><td>Large Piercing</td></tr>
										<tr><td>pi++</td><td>Huge Piercing</td></tr>
										<tr><td>spec</td><td>Special</td></tr>
										<tr><td>tox</td><td>Toxic</td></tr>
									</tbody>
								</table>								
							</span>
						</div>
						<div class="sheet-cell sheet-range">
							<div class="sheet-popup">Range</div>
								<span class="sheet-tooltip">If a weapon has only one range number,<br />this is the Maximum Range (Max) in<br />yards at which it can attack a target. If<br />two numbers appear, separated by a<br />slash, the first is Half-Damage Range<br />(1/2D) and the second is Max.<br />B269</span>
						</div>
						<div class="sheet-cell sheet-rof">
							<div class="sheet-popup">RoF</div>
							<span class="sheet-tooltip">
								<strong>Rate of Fire:</strong>B270<br />The maximum number of shots that can be fired in one turn (by a regular person).<br />
								The minimum number of shots is 1.<br /><br />
								<strong>!</strong>: means the weapon can <i>only</i> fire on “full auto,” <i>Minimum</i> RoF is 1/4 the listed RoF, rounded up.<br /><strong><i>mxn</i></strong>: fires the first number of shots, which each then split into the second number see Shotguns and Multiple Projectiles (p. 409).<br /><strong>Jet</strong>: shoots a continuous stream of fluid. See page 106.
							</span>
						</div>
						<div class="sheet-cell sheet-shots">
							<div class="sheet-popup">Shots</div>
							<span class="sheet-tooltip">The number of shots that can be fired before the weapon must be reloaded.<br />The parenthetical number indicates the number of 1 second ready maneuvers<br />required to reload the weapon.<br /><strong>T</strong>: the weapon is thrown. To "reload" it, pick it up.<br /><strong>i</strong>: you must load the shots individually. the listed time<br />is for each shot.<br />B270
							</span>
						</div>
						<div class="sheet-cell sheet-bulk">
							<div class="sheet-popup">Bulk</div>
							<span class="sheet-tooltip">A measure of the weapon’s size and handiness. Bulk<br />modifies your weapon skill when you take a<br />Move and Attack maneuver (see Move and Attack, p. 365).<br />It also serves as a penalty to Holdout skill when you<br />attempt to conceal the weapon.<br />
							B270</span>
						</div>
						<div class="sheet-cell sheet-rcl">
							<div class="sheet-popup">Rcl</div>
							<span class="sheet-tooltip">
								When firing at RoF 2+, every full multiple of
								Recoil<br />
								by which you make your attack roll means you
								score<br />
								one extra hit, to a maximum number of hits
								equal<br />
								to total shots fired. See page 373.
							</span>
						</div>
						<div class="sheet-cell sheet-minst">
							<div class="sheet-popup">ST</div>
							<span class="sheet-tooltip">
								The minimum Strength required to<br />use the weapon
								properly.
							</span>
						</div>
					</div>
					<fieldset class="repeating_vehicle">
						<input class="sheet-toggle" type="checkbox" />
						<span class="sheet-checkbox"></span>
						<div class="sheet-row sheet-row-vehw">
							<div class="sheet-cell sheet-buttonbox">
								<input type="hidden" name="attr_rowid" value="" />
								<button class="sheet-roll-button" type="roll" name="attr_veh_atkroll" value="!veh @{character_id} @{rowid} [[@{esl} + @{modifier}]] @{damage} @{type} [[@{notes_onoff}]] [[@{targettype}]] [[@{rounds_fired}]] [[@{recoil}]]" ></button>
							</div>
							<div class="sheet-cell sheet-weaponname">
								<input type="text" name="attr_weaponname" placeholder="Weapon Name" />
							</div>
							<div class="sheet-cell sheet-usage">
								<input type="text" name="attr_usage" placeholder="usage" />
							</div>
							<div class="sheet-cell sheet-lvl">
								<input type="number" name="attr_skill" value="0" />
							</div>
							<div class="sheet-cell sheet-mods">
								<input type="number" name="attr_vmods" value="0" readonly="readonly" />
							</div>
							<div class="sheet-cell sheet-esl">
								<input type="number" name="attr_esl" value="0" readonly="readonly"/>
							</div>
							<div class="sheet-cell sheet-acc">
								<input type="text" name="attr_acc" value="0" />
							</div>
							<div class="sheet-cell sheet-damage">
								<input type="text" name="attr_damage" value="1d6" />
							</div>
							<div class="sheet-cell sheet-type">
								<select name="attr_type">
									<option value="aff">aff</option>
									<option value="burn">burn</option>
									<option value="butb">bu (tb)</option>
									<option value="cor">cor</option>
									<option value="cr">cr</option>
									<option value="cut">cut</option>
									<option value="fat">fat</option>
									<option value="imp">imp</option>
									<option value="pi-">pi-</option>
									<option value="pi">pi</option>
									<option value="pi+">pi+</option>
									<option value="pi++">pi++</option>
									<option value="spec">spec</option>
									<option value="tox">tox</option>
								</select>
							</div>
							<div class="sheet-cell sheet-range">
								<input type="text" name="attr_range" value="0" />
							</div>
							<div class="sheet-cell sheet-rof">
								<input type="text" name="attr_rof" value="0" />
							</div>
							<div class="sheet-cell sheet-shots">
								<input type="text" name="attr_shots" value="0" />
							</div>
							<div class="sheet-cell sheet-bulk">
								<input type="text" name="attr_bulk" value="0" />
							</div>
							<div class="sheet-cell sheet-rcl">
								<input type="text" name="attr_recoil" value="0" />
							</div>
							<div class="sheet-cell sheet-minst">
								<input type="text" name="attr_minst" value="0" />	
							</div>
						</div> <!-- Row -->

						<div class="sheet-subheader sheet-attack-options-subhead">
							<div class="sheet-cell sheet-attack-options">
							Attack Options
							</div>
						</div> <!-- Row -->

						<div class="sheet-row sheet-row-vehw-attack-options">
							<div class="sheet-cell sheet-deceptive-attack">
								<div class="sheet-popup">Deceptive Attack:</div><span class="sheet-tooltip"><strong>Deceptive Attack:</strong><br />For every -2 you accept to your own skill,<br />your foe suffers a -1 penalty on his active<br />defenses against this attack.<br />B369</span>
							</div>
							<div class="sheet-cell sheet-deceptive-attack-drop-down">
								<select name="attr_deceptiveatk">
									<option value="0" selected >0</option>
									<option value="-2">-2</option>
									<option value="-4">-4</option>
									<option value="-6">-6</option>
									<option value="-8">-8</option>
									<option value="-10">-10</option>
								</select>
							</div>
							<div class="sheet-cell sheet-dual-weapon">
								<div class="sheet-popup">Dual-Weapon Attack:</div><span class="sheet-tooltip"><strong>Dual Weapon Attack:</strong><br />-4/-8 with primary/off hand<br />(-4/-4 w.Ambidexterity)<br />B417</span>
							</div>
							<div class="sheet-cell sheet-checkboxbox">
								<input type="checkbox" class="sheet-boolean" name="attr_dualweapon" value="-4" />
							</div>
							<div class="sheet-cell sheet-weaponmount"><div class="sheet-popup sheet-mount">Weapon Mount:</div><span class="sheet-tooltip sheet-weaponmount" style="width: 800px;     margin-left: -150px;"><strong>Weapon Mount</strong><br />Any weapon built into a vehicle is considered “mounted.” The type of mount determines the weapon’s stability and arc of fire. For theeffects of these mounts on ranged attacks from moving vehicles, see Ranged Attack Modifiers<br />
							<table>
								<thead>
									<tr><th style="width:100px; text-align: center">Mount</th><th style="width:700px; text-align: center;">Description</th></tr>
								</thead>
								<tbody>
									<tr><td style="width:100px;">Arm Mount</td><td style="width:700px; text-align: left;">If a vehicle has arms or strikers, these may contain weapons or have hands to carry them. They attack using the rules for handheld weapons.</td></tr>
									<tr><td>Carriage</td><td style="width:650px; text-align: left;">Some ships have weapons on wheeled carriages or sleds, either on deck or firing through ports. Treat these as fixed mounts, but skill is not limited to control skill, as the gun crew can use ropes to aim the weapon.</td></tr>
									<tr><td>External Open Mount</td><td style="width:650px; text-align: left;">Also called a pintle mount, deck gun, etc. Such a weapon can elevate to fire upward or swivel to fire in other directions. However, it isn’t actually in the vehicle; the weapon and its crew have no protection.</td></tr>
									<tr><td>External Stabilized Open Mount</td><td style="width:650px; text-align: left;">As above, but with gyro-stabilization to reduce penalties for firing on the move.</td></tr>
									<tr><td>Fixed Mount</td><td style="width:650px; text-align: left;">You aim the gun by aiming the vehicle; e.g., a cannon in the nose of a jet fighter. The weapon can only shoot in one direction. The mount specifies which: [F] to the front, [R] to the right, and so on. The operator rolls against the lower of his Gunner skill or his control skill to hit.</td></tr>
									<tr><td>Hardpoint</td><td style="width:650px; text-align: left;">Aircraft often mount weapon pods, bombs, or missiles on pylons under their body or wings. Treat these as fixed mounts, but apply a -1 to Accuracy. External weapon loads like this count as encumbrance.</td></tr>
									<tr><td>Stabilized Turret</td><td style="width:650px; text-align: left;">As below, but with gyro-stabilization to keep the weapon aimed at the target regardless of the vehicle’s motion.</td></tr>
									<tr><td>Turret</td><td style="width:650px; text-align: left;">This is a turret (or head) with weapons built into it. It can swivel to change facing independently of the vehicle. Large turrets are usually powered.</td></tr>
									</tbody>
								</table>
							</span>
						</div>
						<div class="sheet-cell sheet-mountselect">
							<select name="attr_weaponmount">
								<option value="0" selected="selected">Handheld</option>
								<option value="1">Arm Mount</option>
								<option value="2">Carriage</option>
								<option value="3">External Open Mount</option>
								<option value="4">Stabilized Ext. Open Mount</option>
								<option value="5">Fixed Mount</option>
								<option value="6">Hardpoint</option>
								<option value="7">Stabilized Turret</option>
								<option value="8">Turret</option>
							</select>
						</div>
						</div>

						<div class="sheet-row sheet-row-details">
							<div class="sheet-cell sheet-col0">
								<div class="sheet-popup"><input type="checkbox" class="sheet-boolean" name="attr_notes_onoff" checked="checked" value="1" />
								</div><span class="sheet-tooltip">Check to display notes in rolls</span>
							</div>
							<div class="sheet-cell sheet-col1">
								<textarea name="attr_notes" placeholder="notes"></textarea>
							</div>
						</div>
						<div class="sheet-row sheet-row-details-rowid">
							<div class="sheet-cell sheet-col2">
								RowID For Macros
								<input name="attr_rowid" value="" readonly="readonly" />
							</div>
							<div class="sheet-cell sheet-pwield">
								Primary
								<input type="radio" name="attr_wield" value="1" checked="checked" />
							</div>
							<div class="sheet-cell sheet-wield">
								Off-hand
								<input type="radio" name="attr_wield" value="0" />
							</div>
							<div class="sheet-cell sheet-bwield">
								Both
								<input type="radio" name="attr_wield" value="2" />
							</div>
							<div class="sheet-cell sheet-aim">
								<div class="sheet-popup">Aiming</div><span class="sheet-tooltip"><strong>Aim for one turn:</strong><br />+Accuracy of weapon.<br /><i>The sum of Acc and all extra aimed-fire bonuses can never exceed<br />twice the base Acc of the attack.</i> Combined bonus from scopes, sights,<br />and other gadgetry cannot exceed the weapon's base Accuracy<br />B372, HT155</span>
								<div class="sheet-popup"><input type="checkbox" class="sheet-boolean" name="attr_aiming" value="1"/></div><span class="sheet-tooltip">Check to aim.</span>
							</div>
							<div class="sheet-cell sheet-laser">
								<div class="sheet-popup">Laser</div><span class="sheet-tooltip"><strong>Laser Sight</strong><br />If you can see your own aiming<br />dot, you get +1 to hit, regardless of<br />whether you took an Aim maneuver.<br />B412</span>
								<div class="sheet-popup"><input type="checkbox" name="attr_laser" class="sheet-boolean" value="1" /></div><span class="sheet-tooltip">Check to use laser sight</span>
							</div>
							<div class="sheet-cell sheet-tgtsys">
								<div class="sheet-cell sheet-subcell">
									<div class="sheet-popup">Tgt. Sys.</div><span class="sheet-tooltip"><strong>Targeting Systems</strong><br />smartgun systems, fire control systems,<br />even computers The combined bonus<br />from all such gadgetry can’t exceed<br />the weapon’s base Accuracy<br />B412</span>
								</div>
								<div class="sheet-cell sheet-tgtsyssubcell">
									<input type="number" name="attr_tgtsys" value="0" step="1" />
								</div>
							</div>
							<div class="sheet-cell sheet-scope">
								<div class="sheet-cell sheet-subcell">
									<div class="sheet-popup">Scope</div><span class="sheet-tooltip"><strong>Scope</strong><br />A telescopic sight, or “scope,” gives a bonus to hit if you take an Aim maneuver.<br />Enter the combined bonus of all targeting systems<br />B420</span>
								</div>
								<div class="sheet-cell sheet-subcell">
									<div class="sheet-cell sheet-checkboxbox">
										<div class="sheet-popup"><input type="checkbox" name="attr_scopeonoff" class="sheet-boolean" value="1" /></div><span class="sheet-tooltip">Check to use scope</span>
									</div>
									<div class="sheet-cell sheet-scopebonus">
										<div class="sheet-popup"><input type="number" name="attr_scopebonus" placeholder="0" /></div><span class="sheet-tooltip">Enter Scope acc bonus</span>
									</div>
								</div>								
							</div>
							<div class="sheet-cell sheet-braced">
								<div class="sheet-popup">Braced</div><span class="sheet-tooltip"><strong>Braced</strong><br />+1 if stationary and took a turn to Aim.</span>		
								<input type="checkbox" class="sheet-boolean" name="attr_braced" value="1" />
							</div>
							<div class="sheet-hidden">
								<input type="number" name="attr_tgtsysbonus" value="0" readonly="readonly" />
								<input type="number" name="attr_aimingbonus" value="0" readonly="readonly" />
								<input type="number" name="attr_ttlaimbonus" value="0" readonly="readonly" />
								<input type="number" name="attr_offhand" value="0" readonly="readonly" />
								<input type="number" name="attr_ccbtpenalty" value="0" readonly="readonly" />
								<input type="number" name="attr_stdeficit" value="0" readonly="readonly" />
								<input type="number" name="attr_tgtbehindpen" value="0" readonly="readonly" />
								<input type="number" name="attr_visionpenalty" value="0" readonly="readonly" />
								<input type="number" name="attr_accbonus" value="0" readonly="readonly" />
								<input type="number" name="attr_vehpenalty" value="0" readonly="readonly" />
								<input type="number" name="attr_ttlvehaimbonus" readonly="readonly" />
							</div>
						</div>
					</fieldset> <!-- .repeating_vehw -->
				</div>
			</div>
			<div class="sheet-box sheet-box-vhl">
				<div class="sheet-table">
					<div class="sheet-header sheet-header-vhl">
						<div class="sheet-cell sheet-vhlroll">Roll</div>
						<div class="sheet-cell sheet-location">Location</div>
						<div class="sheet-cell sheet-penalty">Pen</div>
						<div class="sheet-cell sheet-dr">DR</div>
					</div>
					<div class="sheet-row sheet-row-vhl">
						<div class="sheet-cell sheet-vhlroll">3-4</div>
						<div class="sheet-cell sheet-location"><input type="text" name="attr_vehlocation_3-4" value="Small Glass Window [g] or Exposed Weapon Mount" readonly="readonly" /></div>
						<div class="sheet-cell sheet-penalty">-7</div>
						<div class="sheet-cell sheet-dr"><input type="text" name="attr_vehdr_3-4" value="0" /></div>
					</div>
					<div class="sheet-row sheet-row-vhl">
						<div class="sheet-cell sheet-vhlroll">5</div>
						<div class="sheet-cell sheet-location"><input type="text" name="attr_vehlocation_5" value="Small Superstructure* [s] or Independent Turret [t]" readonly="readonly"/></div>
						<div class="sheet-cell sheet-penalty">-5</div>
						<div class="sheet-cell sheet-dr"><input type="text" name="attr_vehdr_5" value="0" /></div>
					</div>
					<div class="sheet-row sheet-row-vhl">
						<div class="sheet-cell sheet-vhlroll">6-7</div>
						<div class="sheet-cell sheet-location"><input type="text" name="attr_vehlocation_6-7" value="Caterpillar Track [C], Draft Animal** [D], Helicopter Rotor [H], Mast [M], or Wing [Wi]" readonly="readonly"/></div>
						<div class="sheet-cell sheet-penalty">-2</div>
						<div class="sheet-cell sheet-dr"><input type="text" name="attr_vehdr_6-7" value="0" /></div>
					</div>
					<div class="sheet-row sheet-row-vhl">
						<div class="sheet-cell sheet-vhlroll">8</div>
						<div class="sheet-cell sheet-location"><input type="text" name="attr_vehlocation_8" value="Arm [A], Large Superstructure* [S], or Main Turret* [T]" readonly="readonly"/></div>
						<div class="sheet-cell sheet-penalty">-2</div>
						<div class="sheet-cell sheet-dr"><input type="text" name="attr_vehdr_8" value="0" /></div>
					</div>
					<div class="sheet-row sheet-row-vhl">
						<div class="sheet-cell sheet-vhlroll">9</div>
						<div class="sheet-cell sheet-location"><input type="text" name="attr_vehlocation_9" value="Body* or Exposed Rider [E]" readonly="readonly"/></div>
						<div class="sheet-cell sheet-penalty">0</div>
						<div class="sheet-cell sheet-dr"><input type="text" name="attr_vehdr_9" value="0" /></div>
					</div>
					<div class="sheet-row sheet-row-vhl">
						<div class="sheet-cell sheet-vhlroll">10</div>
						<div class="sheet-cell sheet-location"><input type="text" name="attr_vehlocation_10" value="Body*" readonly="readonly"/></div>
						<div class="sheet-cell sheet-penalty">0</div>
						<div class="sheet-cell sheet-dr"><input type="text" name="attr_vehdr_10" value="0" /></div>
					</div>
					<div class="sheet-row sheet-row-vhl">
						<div class="sheet-cell sheet-vhlroll">11</div>
						<div class="sheet-cell sheet-location"><input type="text" name="attr_vehlocation_11" value="Large Glass Window [G] or Open Cabin [O]" readonly="readonly"/></div>
						<div class="sheet-cell sheet-penalty">-3</div>
						<div class="sheet-cell sheet-dr"><input type="text" name="attr_vehdr_11" value="0" /></div>
					</div>
					<div class="sheet-row sheet-row-vhl">
						<div class="sheet-cell sheet-vhlroll">12</div>
						<div class="sheet-cell sheet-location"><input type="text" name="attr_vehlocation_12" value="Arm [A], Large Superstructure* [S], or Main Turret* [T]" readonly="readonly"/></div>
						<div class="sheet-cell sheet-penalty">-2</div>
						<div class="sheet-cell sheet-dr"><input type="text" name="attr_vehdr_12" value="0" /></div>
					</div>
					<div class="sheet-row sheet-row-vhl">
						<div class="sheet-cell sheet-vhlroll">13-14</div>
						<div class="sheet-cell sheet-location"><input type="text" name="attr_vehlocation_13-14" value="Caterpillar Track [C], Draft Animal** [D], Helicopter Rotor [H], Mast [M], or Wing [Wi]" readonly="readonly"/></div>
						<div class="sheet-cell sheet-penalty">-2</div>
						<div class="sheet-cell sheet-dr"><input type="text" name="attr_vehdr_13-14" value="0" /></div>
					</div>
					<div class="sheet-row sheet-row-vhl">
						<div class="sheet-cell sheet-vhlroll">15-16</div>
						<div class="sheet-cell sheet-location"><input type="text" name="attr_vehlocation_15-16" value="Runner or Skid [R] or Wheel [W]" readonly="readonly"/></div>
						<div class="sheet-cell sheet-penalty">-4</div>
						<div class="sheet-cell sheet-dr"><input type="text" name="attr_vehdr_15-16" value="0" /></div>
					</div>
					<div class="sheet-row sheet-row-vhl">
						<div class="sheet-cell sheet-vhlroll">17-18</div>
						<div class="sheet-cell sheet-location"><input type="text" name="attr_vehlocation_17-18" value="Vital Area" readonly="readonly"/></div>
						<div class="sheet-cell sheet-penalty">-3</div>
						<div class="sheet-cell sheet-dr"><input type="text" name="attr_vehdr_17-18" value="0" /></div>
					</div>
					<div class="sheet-row sheet-row-vhl">
						<div class="sheet-cell sheet-vhlnotes"><div class="sheet-popup">* Usually manned; see <i>Occupants and Vehicle Damage</i>.</div><span class="sheet-tooltip"><strong>Occupants and Vehicle Damage:</strong><br />When damage penetrates a vehicle’s DR, the occupants may suffer damage as well as the vehicle.<br />Roll 3d on the <i>Occupant Hit Table</i>. B555</span>
						</div>
					</div>
					<div class="sheet-row sheet-row-vhl">
						<div class="sheet-cell sheet-vhlnotes">** The modifier to target a draft animal deliberately is the animal’s SM.
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- END VEHICLE COMBAT SUBTAB -->
		<!-- _____ _____ COMBAT TOOLS SUB TAB _____ _____ -->
		<div class="sheet-section sheet-section-combattools">
			<div class="sheet-box sheet-box-thrown">
				<div class="sheet-table">
					<div class="sheet-header sheet-header-thrown">
						<div class="sheet-cell sheet-col0"><div class="sheet-popup">Throwing Distance and Damage Calculator</div><span class="sheet-tooltip">Use this to calcualte distance and damage of thrown objects.<br />Transfer the stats to the ranged combat tab to use in an attack.</span>
						</div>
					</div>
					<div class="sheet-header sheet-header-thrown">
						<div class="sheet-cell sheet-col1"><div class="sheet-popup">Wgt</div>
							<span class="sheet-tooltip"><strong>Weight:</strong> the object weight in pounds</span>
						</div>
						<div class="sheet-cell sheet-col2">
							<div class="sheet-popup">ST</div>
							<div class="sheet-tooltip">
								Based on Striking ST<br />
								<i>Note:</i> future versions will add ability to choose ST source or enter ST.
							</div>
						</div>
						<div class="sheet-cell sheet-col3">
							<div class="sheet-popup">MOD</div>
							<div class="sheet-tooltip">
								Strength Modifier to distance only<br />
								Throwing or Throwing Art at DX Level = +1 ST<br />
								Throwing or Throwing Art at DX+1 Level = +2 ST<br />	
							</div>
						</div>
						<div class="sheet-cell sheet-col4">
							<div class="sheet-popup">SUPER</div>
							<div class="sheet-tooltip">
								Super Throw Level<br />
								Each level of Super Throw, double range.<br />
								Each level of Super Throw increases damage by +2 per die.
							</div>
						</div>
						<div class="sheet-cell sheet-col5">
							<div class="sheet-popup">Damage</div>
							<div class="sheet-tooltip">
								Final damage based on ST, super throw, 
								and damage modifier.
							</div>
						</div>
						<div class="sheet-cell sheet-col3">
							<div class="sheet-popup">Mod</div>
							<div class="sheet-tooltip">
								Bonus or penalty per die<br />
								Throwing Art at DX Level = +1 per die<br />
								Throwing Art at DX+1 Level = +2 per die<br />
							</div>
						</div>
						<div class="sheet-cell sheet-col6">
							<div class="sheet-popup">Type</div>
							<span class="sheet-tooltip">
								<table>
									<thead>
										<tr>
											<th>Abbr</th>
											<th>Name</th>
										</tr>
									</thead>
									<tbody>
										<tr><td>cut</td> <td>Cutting</td></tr>
										<tr><td>imp</td> <td>Impaling</td></tr>
										<tr><td>cr</td>  <td>Crushing</td></tr>
										<tr><td>pi-</td> <td>Small Piercing</td></tr>
										<tr><td>pi</td>  <td>Piercing</td></tr>
										<tr><td>pi+</td> <td>Large Piercing</td></tr>
										<tr><td>pi++</td><td>Huge Piercing</td></tr>
										<tr><td>aff</td> <td>Affliction</td></tr>
										<tr><td>burn</td><td>Burning</td></tr>
										<tr><td>cor</td> <td>Corrosion</td></tr>
										<tr><td>fat</td> <td>Fatigue</td></tr>
										<tr><td>tox</td> <td>Toxic</td></tr>
										<tr><td>spec</td><td>Special</td></tr>
									</tbody>
								</table>
							</span>
						</div>					
						<div class="sheet-cell sheet-col7">
							<div class="sheet-popup">Range</div>
							<span class="sheet-tooltip">
								See GURPS Campaigns Page 355 for formula
							</span>
						</div>
					</div> <!-- .sheet-header -->
					<div class="sheet-row sheet-row-thrown">
						<div class="sheet-cell sheet-col1">
							<input type="number" step="1" value="1" min="1" name="attr_thrown_object_weight" />
						</div>
						<div class="sheet-cell sheet-col2">
							<input type="text" name="attr_thrown_object_strength" readonly="readonly" value="10" />
						</div>
						<div class="sheet-cell sheet-col3">
							<input type="number" name="attr_thrown_object_strength_mod" value="0" step="1" />
						</div>
						<div class="sheet-cell sheet-col4">
							<input type="number" name="attr_super_throw_level" value="0" step="1" />
						</div>
						<div class="sheet-cell sheet-col5">
							<input type="text" name="attr_thrown_object_damage" readonly="readonly" value="@{thrust}" />
						</div>
						<div class="sheet-cell sheet-col3">
							<input type="number" step="1" name="attr_thrown_object_damage_mod" value="0" />
						</div>
						<div class="sheet-cell sheet-col6">
							<select name="attr_thrown_object_damage_type">
								<option value="cut">cut</option>
								<option value="imp">imp</option>
								<option value="cr">cr</option>
								<option value="pi-">pi-</option>
								<option value="pi">pi</option>
								<option value="pi+">pi+</option>
								<option value="pi++">pi++</option>
								<option value="burn">burn</option>
								<option value="butb">bu (tb)</option>
								<option value="cor">cor</option>
								<option value="fat">fat</option>
								<option value="aff">aff</option>
								<option value="spec">spec</option>
								<option value="tox">tox</option>
							</select>
						</div>
						<div class="sheet-cell sheet-col7">
							<input type="text" name="attr_thrown_object_range" readonly="readonly" value="10" />
						</div>
						<div class="sheet-cell sheet-col8">
							<button name="roll_dmg_thrown" type="roll" value="&{template:GURPSTHROWN} {{Throw=Throwing Damage}} {{damage=[[@{thrown_object_damage}]]}}"></button>
						</div>
					</div> <!-- .sheet-row -->
				</div> <!-- .sheet-table -->
			</div> <!-- .sheet-box .sheet-ranged-attacks -->
			<div class="sheet-box sheet-box-fall">
				<div class="sheet-table">
					<div class="sheet-header sheet-header-fall">
						<div class="sheet-cell sheet-col0"><div class="sheet-popup">Falling and Collision Calculator</div><span class="sheet-tooltip">Use this to calculate damage from falling and collisions.</span>
						</div>
					</div>
					<div class="sheet-header sheet-header-fall">
						<div class="sheet-cell sheet-col1">
							&nbsp;
						</div>
						<div class="sheet-cell sheet-col2">
							<div class="sheet-popup">Yds</div>
							<span class="sheet-tooltip">
							   Yards fallen
							</span>
						</div>
						<div class="sheet-cell sheet-col3">
							<div class="sheet-popup">G's</div>
							<span class="sheet-tooltip">
							   Gravity
							</span>
						</div>
						<div class="sheet-cell sheet-col4">
							<div class="sheet-popup">Atm.</div>
							<span class="sheet-tooltip">
							   Atmosphere
							</span>
						</div>
						<div class="sheet-cell sheet-col5">
							<div class="sheet-popup">Vel.</div>
							<span class="sheet-tooltip">Velocity</span>
						</div>
						<div class="sheet-cell sheet-col6">
							<div class="sheet-popup">HP</div>
							<span class="sheet-tooltip">
							   Hit Points<br>
							   If hitting immovable object, use HP*2<br>
							</span>
						</div>
						<div class="sheet-cell sheet-col7">
							Damage
						</div>
						<div class="sheet-cell sheet-col8">
							&nbsp;
						</div>
						<div class="sheet-cell sheet-col9">
							&nbsp;
						</div>
					</div>
					<div class="sheet-row sheet-row-fall">
						<div class="sheet-cell sheet-col1">
							Falling
						</div>
						<div class="sheet-cell sheet-col2">
							<input type="number" step="1" value="1" min="1" name="attr_yards_fallen" />
						</div>
						<div class="sheet-cell sheet-col3">
							<input type="number" value="1" min="0" name="attr_gravity" />
						</div>
						<div class="sheet-cell sheet-col4">
							<input type="number" value="1" min="0" name="attr_atmosphere" />
						</div>
						<div class="sheet-cell sheet-col5">
							<input type="number" value="5" readonly="readonly" name="attr_falling_velocity" />
						</div>
						<div class="sheet-cell sheet-col6">
							<input type="number" step="1" value="10" min="1" name="attr_falling_hit_points" />
						</div>
						<div class="sheet-cell sheet-col7">
							<input type="text" value="1d6-2" name="attr_falling_damage" readonly="readonly" />
						</div>
						<div class="sheet-cell sheet-col8">
							<button name="roll_dmg_falling" type="roll" value="&{template:GURPSFALLCOLL} {{CF=Falling Damage}} {{damage=[[@{falling_damage}]]}}"></button>
						</div>
						<div class="sheet-cell sheet-col9">
							<button type="action" name="act_falling_reset" class="reset">Reset</button>
						</div>
					</div>
					<div class="sheet-row sheet-row-fall">
						<div class="sheet-cell sheet-col1">
							Collision
						</div>
						<div class="sheet-cell sheet-col2">
							&nbsp;
						</div>
						<div class="sheet-cell sheet-col3">
							&nbsp;
						</div>
						<div class="sheet-cell sheet-col4">
							&nbsp;
						</div>
						<div class="sheet-cell sheet-col5">
							<input type="number" value="1" step="1" min="1" name="attr_collision_velocity" />
						</div>
						<div class="sheet-cell sheet-col6">
							<input type="number" step="1" value="10" min="1" name="attr_collision_hit_points" />
						</div>
						<div class="sheet-cell sheet-col7">
							<input type="text" value="1d6-3" name="attr_collision_damage" readonly="readonly" />
						</div>
						<div class="sheet-cell sheet-col8">
							<button name="roll_dmg_collision" type="roll" value="&{template:GURPSFALLCOLL} {{CF=Collision Damage}} {{damage=[[@{collision_damage}]]}}"></button>
						</div>
						<div class="sheet-cell sheet-col9">
							<button type="action" name="act_collision_reset" class="reset">Reset</button>
						</div>
					</div>
				</div>
			</div>
			<div class="sheet-box sheet-ref">
				<div class="sheet-table">
					<div class="sheet-header sheet-header-ref">
						<div class="sheet-cell sheet-ref">Demolition</div>
					</div>
					<div class="sheet-subheader sheet-sub-ref">
						<div class="sheet-cell sheet-sub-ref"><button type="action" name="act_how_much" class="reset">How Much Explosive?</button></div>
						<div class="sheet-cell sheet-sub-ref"><button type="action" name="act_how_big" class="reset">How Big a Blast?</button></div>
					</div>
					<div class="sheet-subheader sheet-sub-ref">
						<div class="sheet-cell sheet-type"><div class="sheet-popup">Type</div><span class="sheet-tooltip"><strong>Type</strong><br />Refer to the REF table B415.</span></div>
						<div class="sheet-cell sheet-REF"><div class="sheet-popup">REF</div><span class="sheet-tooltip"><strong>REF:</strong><br />Relative Explosive Force<br />equivilence in pounds of TNT.</span></div>
						<div class="sheet-cell sheet-damage"><div class="sheet-popup">6dx<i>n</i></div><span class="sheet-tooltip"><strong>Damage:</strong><br />Enter the number to multiply 6d6 by.<br />An explosion doing 6dx<i>n</i> damage takes (<i>n</i>x<i>n</i>)/4 pounds of TNT.</span></div>
						<div class="sheet-cell sheet-wgtm"><div class="sheet-popup">lbs</div><span class="sheet-tooltip">Weight in pounds required by its REF.</span></div>

						<div class="sheet-cell sheet-type"><div class="sheet-popup">Type</div><span class="sheet-tooltip"><strong>Type</strong><br />Refer to the REF table B415.</span></div>
						<div class="sheet-cell sheet-REF"><div class="sheet-popup">REF</div><span class="sheet-tooltip"><strong>REF:</strong><br />Relative Explosive Force<br />equivilence in pounds of TNT.</span></div>
						<div class="sheet-cell sheet-wgtb"><div class="sheet-popup">lbs</div><span class="sheet-tooltip"><strong>Enter weight of explosives.</strong></span></div>
						<div class="sheet-cell sheet-damage">Damage</div>	
					</div>
					<div class="sheet-row sheet-row-ref">
						<div class="sheet-cell sheet-roll">
							<button name="roll_dmg_explosion" type="roll" value="/roll [[@{ex_dam1}]]"></button>
						</div>
						<div class="sheet-cell sheet-type">
							<input type="text" name="attr_explosivetypea" />
						</div>
						<div class="sheet-cell sheet-REF">
							<input type="text" name="attr_ref_much" />
						</div>
						<div class="sheet-cell sheet-damage">
							<input type="text" name="attr_explosive_multiplier" />
							<input type="hidden" name="attr_ex_dam1">
						</div>
						<div class="sheet-cell sheet-wgtm">
							<input type="text" name="attr_wgt_result" readonly="readonly" />
						</div>
						<div class="sheet-cell sheet-roll">
							<button name="roll_dmg_explosion" type="roll" value="/roll [[@{ex_damage_result}]] "></button>
						</div>
						<div class="sheet-cell sheet-type">
							<input type="text" name="attr_explosivetypeb" />
						</div>
						<div class="sheet-cell sheet-REF">
							<input type="text" name="attr_ref_big" />
						</div>
						<div class="sheet-cell sheet-wgtb">
							<input type="text" name="attr_wgt_req" />
						</div>
						<div class="sheet-cell sheet-damage">
							<input type="text" name="attr_ex_damage_result" readonly="readonly" />
						</div>
					</div>
				</div>
			</div>
		</div>	
		
	</div> <!--______________ END TAB 4________________-->
	<!-- ===== ===== ===== ===== ITEMS TAB ===== ===== ===== ===== -->
	<div class="sheet-tab5">
		<!-- _____ _____ WEALTH BOX _____ _____ -->
		<div class="sheet-box sheet-items">
			<div class="sheet-table">
				<div class="sheet-header">
					<div class="sheet-cell sheet-col0">#</div>
					<div class="sheet-cell sheet-col1">
						<div class="sheet-popup">A</div>
						<span class="sheet-tooltip">
							Loadout A
						</span>
					</div>
					<div class="sheet-cell sheet-col1">
						<div class="sheet-popup">B</div>
						<span class="sheet-tooltip">
							Loadout B
						</span>
					</div>
					<div class="sheet-cell sheet-col1">
						<div class="sheet-popup">C</div>
						<span class="sheet-tooltip">
							Loadout C
						</span>
					</div>
					<div class="sheet-cell sheet-col2">Equipment (<span name="attr_total_weight_x"></span> lb; $<span name="attr_total_cost_x"></span>)</div>
					<div class="sheet-cell sheet-col3">$</div>
					<div class="sheet-cell sheet-col3">W</div>
					<div class="sheet-cell sheet-col3">∑ $</div>
					<div class="sheet-cell sheet-col3">∑ W</div>
					<div class="sheet-cell sheet-col4">Ref</div>
				</div>
				<fieldset class="repeating_item">
					<input class="sheet-toggle" type="checkbox" />
					<span class="sheet-checkbox"></span>
					<div class="sheet-row sheet-row-items">
						<div class="sheet-cell sheet-col0">
							<input type="number" name="attr_count" value="1" step="1"/>
						</div>
						<div class="sheet-cell sheet-col1">
							<input class="sheet-boolean" type="checkbox" name="attr_carried_a" value="1" />
						</div>
						<div class="sheet-cell sheet-col1">
							<input class="sheet-boolean" type="checkbox" name="attr_carried_b" value="1" />
						</div>
						<div class="sheet-cell sheet-col1">
							<input class="sheet-boolean" type="checkbox" name="attr_carried_c" value="1" />
						</div>
						<div class="sheet-cell sheet-col2">
							<input type="text" name="attr_name" placeholder="Item Name">
						</div>
						<div class="sheet-cell sheet-col3">
							<input type="number" name="attr_cost" value="0.00" />
						</div>
						<div class="sheet-cell sheet-col3">
							<input type="number" name="attr_weight" value="0.00000" />
						</div>
						<div class="sheet-cell sheet-col3">
							<input type="number" name="attr_costtotal" value="0.00" readonly="readonly" />
						</div>
						<div class="sheet-hidden">
							<input type="number" name="attr_costtotal_a" value="0.00" readonly="readonly" />
							<input type="number" name="attr_costtotal_b" value="0.00" readonly="readonly" />
							<input type="number" name="attr_costtotal_c" value="0.00" readonly="readonly" />
						</div>
						<div class="sheet-cell sheet-col3">
							<input type="number" name="attr_weighttotal" value="0.00000" readonly="readonly" />
						</div>
						<div class="sheet-hidden">
							<input type="number" name="attr_weighttotal_a" value="0.00" readonly="readonly" />
							<input type="number" name="attr_weighttotal_b" value="0.00" readonly="readonly" />
							<input type="number" name="attr_weighttotal_c" value="0.00" readonly="readonly" />
						</div>
						<div class="sheet-cell sheet-col4"><input type="text" name="attr_item_ref" placeholder="pg." /></div>
					</div> <!-- .sheet-row -->
					<div class="sheet-row sheet-row-details">
						<div class="sheet-cell sheet-col0">
							<div class="sheet-popup"><input type="checkbox" class="sheet-boolean" name="attr_notes_onoff" value="1" checked="checked" />
							</div><span class="sheet-tooltip">Check to display notes in rolls</span>
						</div>
						<div class="sheet-cell sheet-col1">
							<textarea name="attr_notes" placeholder="notes"></textarea>
						</div>
					</div>
					<div class="sheet-row sheet-row-details-rowid">
						<div class="sheet-cell sheet-col2">
							RowID For Macros:
						</div>
						<div class="sheet-cell sheet-col3">
							<input name="attr_rowid" value="" readonly="readonly" />
						</div>
					</div>
				</fieldset> <!-- .repeating_item -->
			</div> <!-- .sheet-table -->
		</div>
		<div class="sheet-box sheet-loadouts">
			<div class="sheet-table">
				<div class="sheet-header sheet-header-loadouts">
					<div class="sheet-cell sheet-col0"><input type="radio" value="1" name="attr_loadoutchoice" checked="checked" class="sheet-loadoutchoice" />
					</div>
					<div class="sheet-cell sheet-col1">Loadout A</div>
					<div class="sheet-cell sheet-col0"><input type="radio" value="2" name="attr_loadoutchoice" class="sheet-loadoutchoice" /></div>
					<div class="sheet-cell sheet-col1">Loadout B</div>
					<div class="sheet-cell sheet-col0"><input type="radio" value="3" name="attr_loadoutchoice" class="sheet-loadoutchoice"></div>
					<div class="sheet-cell sheet-col1">Loadout C</div>
				</div>
				<div class="sheet-row sheet-loadout-row">
					<div class="sheet-cell sheet-col0">Descr:</div>
					<div class="sheet-cell sheet-col1"><input type="text" name="attr_loadouta_descr" title="@{loadouta_descr}" placeholder="Loadout Description" /></div>
					<div class="sheet-cell sheet-col2">Descr:</div>
					<div class="sheet-cell sheet-col1"><input type="text" name="attr_loadoutb_descr" title="@{loadoutb_descr}" placeholder="Loadout Description" /></div>
					<div class="sheet-cell sheet-col3">Descr:</div>
					<div class="sheet-cell sheet-col1"><input type="text" name="attr_loadoutc_descr" title="@{loadoutc_descr}" placeholder="Loadout Description" /></div>
				</div>
				<div class="sheet-row sheet-loadout-row">
					<div class="sheet-cell sheet-col0">Value:</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">$<span name="attr_total_cost_a"></span><input type="hidden" name="attr_total_cost_a" value="0" /></div>
					<div class="sheet-cell sheet-col2">Value:</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">$<span name="attr_total_cost_b"></span><input type="hidden" name="attr_total_cost_b" value="0" /></div>
					<div class="sheet-cell sheet-col3">Value:</div>
					<div class="sheet-cell sheet-col1 sheet-readonly">$<span name="attr_total_cost_c"></span><input type="hidden" name="attr_total_cost_c" value="0" /></div>
				</div>
				<div class="sheet-row sheet-loadout-row">
					<div class="sheet-cell sheet-col0">Weight:</div>
					<div class="sheet-cell sheet-col1 sheet-readonly"><span name="attr_total_weight_a"></span><input type="hidden" name="attr_total_weight_a" value="0" /> lb</div>
					<div class="sheet-cell sheet-col2">Weight:</div>
					<div class="sheet-cell sheet-col1 sheet-readonly"><span name="attr_total_weight_b"></span><input type="hidden" name="attr_total_weight_b" value="0" /> lb</div>
					<div class="sheet-cell sheet-col3">Weight:</div>
					<div class="sheet-cell sheet-col1 sheet-readonly"><span name="attr_total_weight_c"></span><input type="hidden" name="attr_total_weight_c" value="0" /> lb</div>
				</div>
				<div class="sheet-hidden">
					<div class="sheet-cell sheet-col0">Possessions Total Value:
					</div>
					<div class="sheet-cell sheet-col1"><input type="hidden" name="attr_total_cost_x" value="0" /></div>
					<div class="sheet-cell sheet-col2">Possessions Total Weight:
					</div>
					<div class="sheet-cell sheet-col3"><input type="hidden" name="attr_total_weight_x" value="0" /></div>
				</div>
			</div>
		</div>
				<!-- _____ _____ QUICK INVENTORY BOX _____ _____ -->
		<div class="sheet-box sheet-quick-inventory">
			<div class="sheet-title">Quick Inventory</div>
			<div class="sheet-row sheet-quickinv">
				<textarea class="sheet-quickinventory" name="attr_quick_inventory"></textarea>
			</div>
		</div>
	</div> <!-- .sheet-tab5 -->
	<!-- ===== ===== ===== ===== GRIMOIRE TAB ===== ===== ===== ===== -->
	<div class="sheet-tab6">
		<div class="sheet-box sheet-energy">
			<div class="sheet-table">
				<div class="sheet-header sheet-header-energy">
					<div class="sheet-cell sheet-col0">
						Energy Reserve
					</div>
					<div class="sheet-cell sheet-col1">
						<div class="sheet-popup">Max</div>
						<span class="sheet-tooltip"><strong>Energy Reserve </strong><br />Rules can vary depending on what<br />magic or energy system you are using.</span>
					</div>
					<div class="sheet-cell sheet-col2">
						<div class="sheet-popup">Current</div>
						<span class="sheet-tooltip"><strong>Current Energy Reserve</strong><br />Rules can vary.</span>
					</div>
					<div class="sheet-cell sheet-col3">
						% Remain
					</div>
					<div class="sheet-cell sheet-col4">
						Spells On
					</div>
					<div class="sheet-cell sheet-col5">
						Spells Setup
					</div>
				</div>
				<div class="sheet-row sheet-row-energy">
					<div class="sheet-cell sheet-col0">
						<input type="text" name="attr_er_name" placeholder="Energy Reserve Name" value="" />
					</div>
					<div class="sheet-cell sheet-col1">
						<input type="number" name="attr_energy_points_max" placeholder="0" />
					</div>
					<div class="sheet-cell sheet-col2">
						<input type="number" name="attr_energy_points" value="0" />
					</div>
					<div class="sheet-cell sheet-col3">
						<input type="text" name="attr_percent" placeholder="0" value="0" readonly="readonly"/>
					</div>
					<div class="sheet-cell sheet-col4">
						<input type="number" name="attr_spellson" value="0" />
					</div>
					<div class="sheet-cell sheet-col5">Spells based on:</div>
					<div class="sheet-cell sheet-col6">
						<select name="attr_spell_base">
							<option value="@{strength}">ST</option>
							<option value="@{dexterity}">DX</option>
							<option value="@{intelligence}" selected="selected">IQ</option>
							<option value="@{health}">HT</option>
							<option value="@{willpower}">Will</option>
							<option value="@{perception}">Per</option>
							<option value="10">10</option>
						</select>
					</div>
					<div class="sheet-cell sheet-col7"> Magery/PI/Bonus Level:
					</div>
					<div class="sheet-cell sheet-col8">
						<input type="number" name="attr_spell_bonus" value="0" />
					</div>
				</div>
			</div>
		</div>
		<div class="sheet-box sheet-spells">
			<div class="sheet-table">
				<div class="sheet-header sheet-header-spells">
					<div class="sheet-cell sheet-col0">Spells</div>
					<div class="sheet-cell sheet-col1">Class</div>
					<div class="sheet-cell sheet-col2">Mana Cost</div>
					<div class="sheet-cell sheet-col3">Time</div>
					<div class="sheet-cell sheet-col4">SL</div>
					<div class="sheet-cell sheet-col5">Diff</div>
					<div class="sheet-cell sheet-col6">Pts</div>
					<div class="sheet-cell sheet-col7">Ref</div>
				</div> <!-- .sheet-header -->
				<fieldset class="repeating_spells">
					<input class="sheet-toggle" type="checkbox" />
					<span class="sheet-checkbox"></span>
					<div class="sheet-row sheet-row-spells">
						<div class="sheet-cell sheet-col0">
							<button class="sheet-roll-button" type="roll" name="attr_spellroll" value="!spell @{character_id} @{rowid} [[@{level} + @{modifier} + @{skillRoll_mod}]] [[@{notes_onoff}]]"></button>
						</div>
						<div class="sheet-cell sheet-col1">
							<input type="text" name="attr_name" placeholder="Spell Name"  style="font-weight:bold;"/>
						</div>
						<div class="sheet-cell sheet-col2">
							<input type="text" name="attr_class" placeholder="Class"  style="font-weight:bold;"/>
							<input type="text" name="attr_college" placeholder="College" />
						</div>
						<div class="sheet-cell sheet-col3">
							<input type="text" name="attr_cost" placeholder="Cast" value=""  style="font-weight:bold;"/>
							<input type="text" name="attr_maintain" placeholder="Maintain" value="" />
						</div>
						<div class="sheet-cell sheet-col4">
							<input type="text" name="attr_casttime" placeholder="Casting Time" value=""  style="font-weight:bold;"/>
							<input type="text" name="attr_duration" placeholder="Duration" value="" />
						</div>
						<div class="sheet-cell sheet-col5">
							<input type="text" name="attr_level" disabled="disabled" value="@{spell_base} + @{difficulty} + @{spell_bonus} + @{spellmodifier} + (floor((@{points} * 0.25) + 2) * ceil( ( ( @{points} - 2 ) + abs( @{points} - 2) ) / 256 ) + @{points} * abs( ceil( ( ( @{points} - 2 ) + abs( @{points} - 2) ) / 256 ) - 1 )) - @{spellson}" style="font-weight:bold;"/>
							<input type="text" name="modifier" style="font-weight:bold;text-align: center;"value="Mod:" readonly="readonly" />						
						</div>
						<div class="sheet-cell sheet-col6">
							<select name="attr_difficulty">
								<option value="-3">H</option>
								<option value="-4">VH</option>
							</select>
							<input type="number" style="font-weight:bold;text-align: center;margin-top:-12px;" name="attr_spellmodifier" value="0" />
						</div>
						<div class="sheet-cell sheet-col7">
							<input type="number" style="font-weight:bold;" name="attr_points" value="0" />
						</div>
						<div class="sheet-cell sheet-col8">
							<input type="text" name="attr_ref" placeholder="Page"  style="font-weight:bold;"/>
						</div>
					</div> <!-- .sheet-row -->
					<div class="sheet-row sheet-row-details">
						<div class="sheet-cell sheet-col0">
							<div class="sheet-popup"><input type="checkbox" class="sheet-boolean" name="attr_notes_onoff" value="1" checked="checked" />
							</div><span class="sheet-tooltip">Check to display notes in rolls</span>
						</div>
						<div class="sheet-cell sheet-col1">
							<textarea name="attr_notes" placeholder="notes"></textarea>
						</div>
					</div>
					<div class="sheet-row sheet-row-details-rowid">
						<div class="sheet-cell sheet-col2">
							RowID For Macros:
						</div>
						<div class="sheet-cell sheet-col3">
							<input name="attr_rowid" value="" readonly="readonly" />
						</div>
					</div>
				</fieldset> <!-- .repeating_spells -->
			</div> <!-- .sheet-table -->
		</div> <!-- .sheet-box .sheet-spells -->
	</div> <!-- .sheet-tab6 END-->
	<!-- ===== ===== ===== ===== RITUALS TAB ===== ===== ===== ===== -->
	<div class="sheet-tab7">
		<div class="sheet-box sheet-energy">
			<div class="sheet-table">
				<div class="sheet-header sheet-header-energy">
					<div class="sheet-cell sheet-col0">
						Energy Reserve
					</div>
					<div class="sheet-cell sheet-col1">
						<div class="sheet-popup">Max</div>
						<span class="sheet-tooltip"><strong>Energy Reserve </strong><br />Rules can vary depending on what<br />magic or energy system you are using.</span>
					</div>
					<div class="sheet-cell sheet-col2">
						<div class="sheet-popup">Current</div>
						<span class="sheet-tooltip"><strong>Current Energy Reserve</strong><br />Rules can vary.</span>
					</div>
					<div class="sheet-cell sheet-col3">
						% Remain
					</div>
				</div>
				<fieldset class="repeating_ritualenergy">
					<div class="sheet-row sheet-row-energy">
						<div class="sheet-cell sheet-col0">
							<input type="text" name="attr_er_name" placeholder="Energy Reserve Name" value="" />
						</div>
						<div class="sheet-cell sheet-col1">
							<input type="number" name="attr_energy_points_max" placeholder="0" />
						</div>
						<div class="sheet-cell sheet-col2">
							<input type="number" name="attr_energy_points" value="0" />
						</div>
						<div class="sheet-cell sheet-col3">
							<input type="text" name="attr_percent" placeholder="0" value="0" readonly="readonly"/>
						</div>
					</div>
				</fieldset>
			</div>
		</div>
		<div class='sheet-box sheet-rituals'>
			<div class="sheet-table">
				<div class="sheet-header sheet-ritualheader">
					<div class="sheet-cell sheet-col0">Ritual Name</div>
					<div class="sheet-cell sheet-col1">Energy</div>
					<div class="sheet-cell sheet-col2">Skill</div>
				</div>
				<fieldset class="repeating_rituals">
					<input class="sheet-toggle" type="checkbox" />
					<span class="sheet-checkbox"></span>
					<div class="sheet-row sheet-row-rituals">
						<input type="hidden" name="attr_rowid" value="" />
						<div class="sheet-cell sheet-col0">
							<button class="sheet-roll-button" type="roll" name="attr_ritualroll" value="!ritual @{character_id} @{rowid} [[@{skill} + @{modifier} + @{skillRoll_mod}]] [[@{effectsOnOff}]] [[@{inherentOnOff}]] [[@{greaterEffectsOnOff}]] [[@{ritualDescrOnOff}]] [[@{typicalOnOff}]] [[@{notes_onoff}]]"></button>
						</div>
						<div class="sheet-cell sheet-col1">
							<input type="text" name="attr_ritualname" placeholder="Ritual Name" />
						</div>
						<div class="sheet-cell sheet-col2">
							<input type="number" name="attr_ritualenergy" value="0" placeholder="0" />
						</div>
						<div class="sheet-cell sheet-col3">
							<input type="number" name="attr_skill" value="10" placeholder="0" />
						</div>
					</div>
					<div class="sheet-row sheet-row-details">
						<div class="sheet-cell sheet-col0">
							<div class="sheet-popup"><input type="checkbox" class="sheet-boolean" name="attr_effectsOnOff" value="1" /></div><span class="sheet-tooltip">Check to display notes in rolls</span>
						</div>
						<div class="sheet-cell sheet-col2">
							Spell Effects:
						</div>
						<div class="sheet-cell sheet-col6">
							<textarea name="attr_spelleffects" placeholder="Spell Effects"></textarea>
						</div>
					</div>
					<div class="sheet-row sheet-row-details">
						<div class="sheet-cell sheet-col0">
							<div class="sheet-popup"><input type="checkbox" class="sheet-boolean" name="attr_inherentOnOff" value="1" /></div><span class="sheet-tooltip">Check to display notes in rolls</span>
						</div>
						<div class="sheet-cell sheet-col2">
							Inherent Modifiers:
						</div>
						<div class="sheet-cell sheet-col6">
							<textarea name="attr_inherentmod" placeholder="Inherent Modifiers"></textarea>
						</div>
					</div>
					<div class="sheet-row sheet-row-details">
						<div class="sheet-cell sheet-col0">
							<div class="sheet-popup"><input type="checkbox" class="sheet-boolean" name="attr_greaterEffectsOnOff" value="1" /></div><span class="sheet-tooltip">Check to display notes in rolls</span>
						</div>
						<div class="sheet-cell sheet-col2">
							Greater Effects:
						</div>
						<div class="sheet-cell sheet-col3">
							<input type="number" name="attr_greatereffects" placeholder="0" value="0" />
						</div>
						<div class="sheet-cell sheet-col4">
							x
						</div>
						<div class="sheet-cell sheet-col5">
							<input type="number" name="attr_greatereffectsmultiplier" value="0" readonly="readonly" />
						</div>
					</div>
					<div class="sheet-row sheet-row-details">
						<div class="sheet-cell sheet-col0">
							<div class="sheet-popup"><input type="checkbox" class="sheet-boolean" name="attr_ritualDescrOnOff" value="1" /></div><span class="sheet-tooltip">Check to display notes in rolls</span>
						</div>
						<div class="sheet-cell sheet-col2">
							Ritual Description:
						</div>
						<div class="sheet-cell sheet-col6">
							<textarea name="attr_ritualdescr" placeholder="Ritual Description"></textarea>
						</div>
					</div>
					<div class="sheet-row sheet-row-details">
						<div class="sheet-cell sheet-col0">
							<div class="sheet-popup"><input type="checkbox" class="sheet-boolean" name="attr_typicalOnOff" value="1" /></div><span class="sheet-tooltip">Check to display notes in rolls</span>
						</div>
						<div class="sheet-cell sheet-col2">
							Typical Casting:
						</div>
						<div class="sheet-cell sheet-col6">
							<textarea class="sheet-ritualcast" name="attr_ritualcasting" placeholder="Typical Casting"></textarea>
						</div>
					</div>
					<div class="sheet-row sheet-row-details">
						<div class="sheet-cell sheet-col0">
							<div class="sheet-popup"><input type="checkbox" class="sheet-boolean" name="attr_notes_onoff" value="1" />
							</div><span class="sheet-tooltip">Check to display notes in rolls</span>
						</div>
						<div class="sheet-cell sheet-col1">
							<textarea name="attr_notes" placeholder="notes"></textarea>
						</div>
					</div>
					<div class="sheet-row sheet-row-details-rowid">
						<div class="sheet-cell sheet-col2">
							RowID For Macros:
						</div>
						<div class="sheet-cell sheet-col3">
							<input name="attr_rowid" value="" readonly="readonly" />
						</div>
					</div>
				</fieldset>
			</div>
		</div> <!-- ===== END SHEET-BOX SHEET-RITUALS ===== -->
	</div>
	<!-- ===== ===== ===== ===== NOTES TAB ===== ===== ===== ===== -->
	<div class="sheet-tab8">
		<div class="sheet-box sheet-notes">
			<textarea name="attr_mainnotes" placeholder="Notes:"></textarea>
		</div>
	</div>
	<!-- ===== ===== ===== ===== OPTIONS TAB ===== ===== ===== ===== -->
	<div class="sheet-tab0">
		<div class="sheet-box sheet-charactersheet-settings">
			<div class="sheet-header sheet-header-charactersheet-settings">
				<div class="sheet-cell sheet-col0">Character Sheet Settings
				</div>
			</div>
		</div>
		<div class="sheet-box sheet-enhancements">
			<div class="sheet-table">
				<div class="sheet-header">
					<div class="sheet-cell sheet-enh-title"><div class="sheet-popup">Enhancements</div><span class="sheet-tooltip">Penalty/Enhancement<br />For use with ChatSetAttr API</span></div>
					<div class="sheet-cell sheet-enh-mod"><div class="sheet-popup">Mod</div><span class="sheet-tooltip">Penalty/Enhancement modifier<br />Do Not Use a Plus (+) sign<br />It will break the API!</span></div>
					<div class="sheet-cell sheet-enh-notes"><div class="sheet-popup">Notes</div><span class="sheet-tooltip">Use enh_**_mod_notes<br />to set notes for enhancements</span></div>
				</div>
				<div class="sheet-row sheet-enh">
					<div class="sheet-cell sheet-enh-subtitle"><input type="text" value="enh_ST_mod" readonly="readonly"></div>
					<div class="sheet-cell sheet-enh"><input type="number" name="attr_enh_ST_mod" value="0" step="1" readonly="readonly"/></div><!-- Strength Enhancement Mod -->
					<div class="sheet-cell sheet-enhnotes"><input type="text" name="attr_enh_ST_mod_notes" value="" readonly="readonly"/></div>
				</div>
				<div class="sheet-row sheet-enh">
					<div class="sheet-cell sheet-enh-subtitle"><input type="text" value="enh_DX_mod" readonly="readonly"></div>
					<div class="sheet-cell sheet-enh"><input type="number" name="attr_enh_DX_mod" value="0" step="1" readonly="readonly"/></div><!-- Dexterity Enhancement Mod -->
					<div class="sheet-cell sheet-enhnotes"><input type="text" name="attr_enh_DX_mod_notes" value="" readonly="readonly"/></div>
				</div>
				<div class="sheet-row sheet-enh">
					<div class="sheet-cell sheet-enh-subtitle"><input type="text" value="enh_IQ_mod" readonly="readonly"></div>
					<div class="sheet-cell sheet-enh"><input type="number" name="attr_enh_IQ_mod" value="0" step="1" readonly="readonly"/></div><!-- Intelligence Enhancement Mod -->
					<div class="sheet-cell sheet-enhnotes"><input type="text" name="attr_enh_IQ_mod_notes" value="" readonly="readonly"/></div>
				</div>
				<div class="sheet-row sheet-enh">
					<div class="sheet-cell sheet-enh-subtitle"><input type="text" value="enh_HT_mod" readonly="readonly"></div>
					<div class="sheet-cell sheet-enh"><input type="number" name="attr_enh_HT_mod" value="0" step="1" readonly="readonly"/></div><!-- Health Enhancement Mod -->
					<div class="sheet-cell sheet-enhnotes"><input type="text" name="attr_enh_HT_mod_notes" value="" readonly="readonly"/></div>
				</div>
				<div class="sheet-row sheet-enh">
					<div class="sheet-cell sheet-enh-subtitle"><input type="text" value="enh_Will_mod" readonly="readonly"></div>
					<div class="sheet-cell sheet-enh"><input type="number" name="attr_enh_Will_mod" value="0" step="1" readonly="readonly"/></div><!-- Health Enhancement Mod -->
					<div class="sheet-cell sheet-enhnotes"><input type="text" name="attr_enh_Will_mod_notes" value="" readonly="readonly"/></div>
				</div>
				<div class="sheet-row sheet-enh">
					<div class="sheet-cell sheet-enh-subtitle"><input type="text" value="enh_Per_mod" readonly="readonly"></div>
					<div class="sheet-cell sheet-enh"><input type="number" name="attr_enh_Per_mod" value="0" step="1" readonly="readonly"/></div><!-- Health Enhancement Mod -->
					<div class="sheet-cell sheet-enhnotes"><input type="text" name="attr_enh_Per_mod_notes" value="" readonly="readonly"/></div>
				</div>
				<div class="sheet-row sheet-enh">
					<div class="sheet-cell sheet-enh-subtitle"><input type="text" value="enh_vision_mod" readonly="readonly"></div>
					<div class="sheet-cell sheet-enh"><input type="number" name="attr_enh_vision_mod" value="0" step="1" readonly="readonly"/></div><!-- Health Enhancement Mod -->
					<div class="sheet-cell sheet-enhnotes"><input type="text" name="attr_enh_vision_mod_notes" value="" readonly="readonly"/></div>
				</div>
				<div class="sheet-row sheet-enh">
					<div class="sheet-cell sheet-enh-subtitle"><input type="text" value="enh_hearing_mod" readonly="readonly"></div>
					<div class="sheet-cell sheet-enh"><input type="number" name="attr_enh_hearing_mod" value="0" step="1" readonly="readonly"/></div><!-- Health Enhancement Mod -->
					<div class="sheet-cell sheet-enhnotes"><input type="text" name="attr_enh_hearing_mod_notes" value="" readonly="readonly"/></div>
				</div>
				<div class="sheet-row sheet-enh">
					<div class="sheet-cell sheet-enh-subtitle"><input type="text" value="enh_tasteSmell_mod" readonly="readonly"></div>
					<div class="sheet-cell sheet-enh"><input type="number" name="attr_enh_tasteSmell_mod" value="0" step="1" readonly="readonly"/></div><!-- Health Enhancement Mod -->
					<div class="sheet-cell sheet-enhnotes"><input type="text" name="attr_enh_tasteSmell_mod_notes" value="" readonly="readonly"/></div>
				</div>
				<div class="sheet-row sheet-enh">
					<div class="sheet-cell sheet-enh-subtitle"><input type="text" value="enh_touch_mod" readonly="readonly"></div>
					<div class="sheet-cell sheet-enh"><input type="number" name="attr_enh_touch_mod" value="0" step="1" readonly="readonly"/></div><!-- Health Enhancement Mod -->
					<div class="sheet-cell sheet-enhnotes"><input type="text" name="attr_enh_touch_mod_notes" value="" readonly="readonly"/></div>
				</div>
				<div class="sheet-row sheet-enh">
					<div class="sheet-cell sheet-enh-subtitle"><input type="text" value="enh_AD_mod" readonly="readonly"></div>
					<div class="sheet-cell sheet-enh"><input type="number" name="attr_enh_AD_mod" value="0" step="1" readonly="readonly"/></div><!-- Active Defense Enhancement Mod -->
					<div class="sheet-cell sheet-enhnotes"><input type="text" name="attr_enh_AD_mod_notes" value="" readonly="readonly"/></div>
				</div>
				<div class="sheet-row sheet-enhbottom">
					<div class="sheet-cell sheet-enh-subtitle"><input type="text" value="enh_SC_mod" readonly="readonly"></div>
					<div class="sheet-cell sheet-enh"><input type="number" name="attr_enh_SC_mod" value="0" step="1" readonly="readonly"/></div><!-- Self Control Enhancement Mod -->
					<div class="sheet-cell sheet-enhnotes"><input type="text" name="attr_enh_SC_mod_notes" value="" readonly="readonly"/></div>
				</div>
			</div>
		</div>
		<div class="sheet-box sheet-experience">
			<div class="sheet-header sheet-header-experience">
				<div class="sheet-cell sheet-col0">Character Points</div>
			</div>
			<div class="sheet-row sheet-row-experience">
				<div class="sheet-cell sheet-col0 sheet-label">Starting Pts:</div>
				<div class="sheet-cell sheet-col1"><input type="number" name="attr_base_points" value="0" /></div>
			</div>
			<div class="sheet-header sheet-header-experience">
				<div class="sheet-cell sheet-col0">Experience Points</div>
			</div>
			<div class="sheet-subheader sheet-subheader-experience">
				<div class="sheet-cell sheet-col0">Session Date</div>
				<div class="sheet-cell sheet-col1">Points</div>
			</div>
			<fieldset class="repeating_experience">
				<div class="sheet-row sheet-row-experience">
					<div class="sheet-cell sheet-col0"><input type="text" name="attr_session_date" /></div>
					<div class="sheet-cell sheet-col1"><input type="number" name="attr_points" value="0" /></div>
				</div>
			</fieldset>
			<div class="sheet-subheader sheet-subheader-experience">
				<div class="sheet-cell sheet-col0">Total EXP</div>
				<div class="sheet-cell sheet-col1"><input type="number" name="attr_ex_points" readonly="readonly" value="0" /></div>
			</div>
			<div class="sheet-subheader sheet-subheader-experience">
				<div class="sheet-cell sheet-col0">Total Points</div>
				<div class="sheet-cell sheet-col1"><input type="number" name="attr_total_points" readonly="readonly" value="0" /></div>
			</div>
		</div>
		<hr />
		<div class="sheet-box sheet-superstrength">
			<div class="sheet-table">
				<div class="sheet-header sheet-header-superstrength">
					<div class="sheet-cell sheet-col0">Super Strength</div>
				</div>
				<div class="sheet-subheader sheet-subheader-superstrength">
					<div class="sheet-cell sheet-col0">Base Value</div>
					<div class="sheet-cell sheet-col0">Super Value</div>
					<div class="sheet-cell sheet-col0">Total ST</div>
					<div class="sheet-cell sheet-col1">Basic Lift</div>
					<div class="sheet-cell sheet-col2">Damage</div>
				</div>
				<div class="sheet-row sheet-superstrength">
					<div class="sheet-cell sheet-col0"><input type="number" name="attr_base_value" value="0"/></div>
					<div class="sheet-cell sheet-col0"><input type="number" name="attr_superstrength" value="0" readonly="readonly" /></div>
					<div class="sheet-cell sheet-col0"><input type="number" name="attr_total_superstrength" value="0" readonly="readonly" /></div>
					<div class="sheet-cell sheet-col1"><span name="attr_lift_0"></span><span name="attr_lift0unit"></span></div>
					<div class="sheet-cell sheet-col2">thr: </div>
					<div class="sheet-cell sheet-col3"><input type="text" name="attr_thrust" value="1d6-2" readonly="readonly"/></div>
					<div class="sheet-cell sheet-col2">sw: </div>
					<div class="sheet-cell sheet-col3"><input type="text" name="attr_swing" value="1d6" readonly="readonly"/></div>
				</div>
			</div>
		</div>
		<hr />
		<div class="sheet-box sheet-campaign-settings">
			<div class="sheet-table">
				<div class="sheet-header sheet-header-campaign-settings">
					<div class="sheet=cell sheet-col0">Campaign Settings</div>
				</div>
				<div class="sheet-row sheet-row-tech_level">
					<div class="sheet-cell sheet-col0">Campaign Base Tech Level:
					</div>
					<div class="sheet-cell sheet-col1">
						<input type="number" name="attr_base_tl" value="0" />
					</div>
					<div class="sheet-cell sheet-col2">
						<input type="text" name="attr_tl_exceptions" />
					</div>
				</div>
			</div>
		</div>
		<!-- _____ _____ END CHARACTER SHEET SETTINGS _____ _____ -->

		<hr />
		<div class="sheet-box sheet-settings">
			<div class="sheet-header sheet-header-settings">
				<div class="sheet-cell sheet-col0">Gameplay Settings</div>
			</div>
		</div>
		<div class="sheet-box">
			<input type="radio" name="attr_modifier" value="0" checked="checked" />
			<span class="sheet-popup">No Modifier Prompt</span>
			<span class="sheet-tooltip">
				Rolls will be made immediately with no prompt.
			</span>
			<br /><input type="radio" name="attr_modifier" value="?{Modifier|0}" />
			<span class="sheet-popup">Single Modifier Prompt</span>
			<span class="sheet-tooltip">
				Ask for a bonus or penalty to be added to dice rolls.
				<br />
				This will not affect damage rolls.
			</span>
			<br />
			<input type="radio" name="attr_modifier" value="?{Modifier|0} + ?{Shock|0} + ?{Reeling or Staggered|0} + ?{Off-Hand|0} + ?{Familiarity|0}" />
			<span class="sheet-popup">Extended Modifier Prompts</span>
			<span class="sheet-tooltip">
				Instead of a single modifier, rolls will ask for a series of
				modifiers,<br />
				to remind you about potential bonuses/penalties.
				<br />
				This will not affect damage rolls.
			</span>
		</div>
		<div class="sheet-hidden">
			<div class="sheet-box">
				<input type="radio" name="attr_active_defense_modifier_prompt" value="0" checked="checked" />
				<span class="sheet-popup">No Active Defense Modifier Prompt no modifier</span>
				<span class="sheet-tooltip">
					Rolls will be made immediately with no Active Defense Modifier prompt.
				</span>
				<br /><input type="radio" name="attr_active_defense_modifier_prompt" value="?{Modifier|@{total_ad_mod}}" />
				<span class="sheet-popup">Active Defense Modifier Prompt</span>
				<span class="sheet-tooltip">
					Ask for current Active Defense bonus or penalty to be added to dice rolls.
					<br />
					This will not affect damage rolls.
				</span>
				<br />
				<input type="radio" name="attr_active_defense_modifier_prompt" value="@{total_ad_mod}" />
				<span class="sheet-popup">Automatically add modifier</span>
				<span class="sheet-tooltip">
					Instead of a prompt, rolls will automatically add
					modifiers,<br />

					This will not affect damage rolls.
				</span>
			</div>
		</div>
			<div class="sheet-box">
				<input type="radio" name="attr_whispermode" value="public" checked="checked" />
				<span class="sheet-popup">Public Rolls</span>
				<span class="sheet-tooltip">
					All players will be able to see<br />
					your skill level, roll and results.
				</span>
				<br />
				<input type="radio" name="attr_whispermode" value="gm" />
				<span class="sheet-popup">GM Only Rolls</span>
				<span class="sheet-tooltip">
					Only the GM will see your rolls.
				</span>
			</div>
		<div class="sheet-hidden">
			<div class="sheet-box">
				<div>Fear Checks</div>
				<input type="radio" name="attr_fearmode" value="1" checked="checked" />
				<span class="sheet-popup">Public Rolls</span>
				<span class="sheet-tooltip">
					All players will be able to see<br />
					your skill level, roll and results.
				</span>
				<br />
				<input type="radio" name="attr_fearmode" value="2" />
				<span class="sheet-popup">Private Rolls</span>
				<span class="sheet-tooltip">
					Only you and the GM will see your rolls.
				</span>
				<br />
				<input type="radio" name="attr_fearmode" value="3" />
				<span class="sheet-popup">GM Only Rolls</span>
				<span class="sheet-tooltip">
					Only the GM will see your rolls.
				</span>
			</div>
			<div class="sheet-box">
				<input type="radio" name="attr_critroll_auto" value="on" checked="checked" />
				<span class="sheet-popup">Automatic Crit Rolls: On</span>
				<span class="sheet-tooltip">
					Crit rolls automatically rolled.
				</span>
				<br />
				<input type="radio" name="attr_critroll_auto" value="off" checked="checked" />
				<span class="sheet-popup">Automatic Crit Rolls: Off</span>
				<span class="sheet-tooltip">
					Crit rolls are button activated.
				</span>
				<br />
				<input type="radio" name="attr_critroll_visibility" value="public" checked="checked" />
				<span class="sheet-popup">Public Crit Rolls</span>
				<span class="sheet-tooltip">
					Everyone will see all crit rolls.
				</span>
				<br />
				<input type="radio" name="attr_critroll_visibility" value="secret" />
				<span class="sheet-popup">Player Only Crit Rolls</span>
				<span class="sheet-tooltip">
					Players and GM will see your crit rolls.
				</span>
				<br />
				<input type="radio" name="attr_critroll_visibility" value="gm" />
				<span class="sheet-popup">GM Only Crit Rolls</span>
				<span class="sheet-tooltip">
					Only the GM will see Crit rolls.
				</span>
			</div>
		</div>
		<div class="sheet-box">
			<input type="radio" name="attr_mod_cascade" value="all" checked="checked" />
			<span class="sheet-popup">Mods to attributes increase all derived
				stats (including HP, FP)</span>
			<br />
			<input type="radio" name="attr_mod_cascade" value="some" />
			<span class="sheet-popup">Mods to attributes increase most derived
				stats (not HP, FP)</span>
			<br />
			<input type="radio" name="attr_mod_cascade" value="none" />
			<span class="sheet-popup">Mods to attributes do not increase derived
				stats</span>
		</div>
		<div class="sheet-box">
			<input type="radio" name="attr_rounds_fired" value="1" checked="checked" />
			<span class="sheet-popup">Rapid Fire Prompt Off</span>
			<span class="sheet-tooltip">
				Ranged Attack Rolls will be made without "Rounds fired" prompt.
			</span>
			<br /><input type="radio" name="attr_rounds_fired" value="?{Rounds Fired?|1}" />
			<span class="sheet-popup">Rapid Fire Prompt On</span>
			<span class="sheet-tooltip">
				Ranged Attack Rolls will be made with "Rounds fired" prompt.
				<br />
				This will not affect damage rolls.
			</span>
		</div>
		<div class="sheet-box">
			<input type="radio" name="attr_range_rule" value="1" checked="checked" />
			<span class="sheet-popup">Normal Range</span>
			<span class="sheet-tooltip">
				Normal Range rules.<br />
				B550
			</span>
			<br />
			<input type="radio" name="attr_range_rule" value="2" />
			<span class="sheet-popup">Simple Range</span>
			<span class="sheet-tooltip">
				Simple Range rules.<br />
				MH2:21
			</span>
		</div>
	</div>

	<script type="text/worker">
		/* ---- BEGIN: TheAaronSheet.js ---- */
// Github:   https://github.com/shdwjk/TheAaronSheet/blob/master/TheAaronSheet.js
// By:       The Aaron, Arcane Scriptomancer
// Contact:  https://app.roll20.net/users/104025/the-aaron

var TAS = TAS || (function(){
    'use strict';

    var version = '0.2.5',
        lastUpdate = 1504710542,

        loggingSettings = {
            debug: {
                key:     'debug',
                title:   'DEBUG',
                color: {
                    bgLabel: '#7732A2',
                    label:   '#F2EF40',
                    bgText:  '#FFFEB7',
                    text:    '#7732A2'
                }
            },
            error: {
                key:     'error',
                title:   'Error',
                color: {
                    bgLabel: '#C11713',
                    label:   'white',
                    bgText:  '#C11713',
                    text:    'white'
                }
            },
            warn: {
                key:     'warn',
                title:   'Warning',
                color: {
                    bgLabel: '#F29140',
                    label:   'white',
                    bgText:  '#FFD8B7',
                    text:    'black'
                }
            },
            info: {
                key:     'info',
                title:   'Info',
                color: {
                    bgLabel: '#413FA9',
                    label:   'white',
                    bgText:  '#B3B2EB',
                    text:    'black'
                }
            },
            notice: {
                key:     'notice',
                title:   'Notice',
                color: {
                    bgLabel: '#33C133',
                    label:   'white',
                    bgText:  '#ADF1AD',
                    text:    'black'
                }
            },
            log: {
                key:     'log',
                title:   'Log',
                color: {
                    bgLabel: '#f2f240',
                    label:   'black',
                    bgText:  '#ffff90',
                    text:    'black'
                }
            },
            callstack: {
                key:     'TAS',
                title:   'function',
                color: {
                    bgLabel: '#413FA9',
                    label:   'white',
                    bgText:  '#B3B2EB',
                    text:    'black'
                }
            },
            callstack_async: {
                key:     'TAS',
                title:   'ASYNC CALL',
                color: {
                    bgLabel: '#413FA9',
                    label:   'white',
                    bgText:  '#413FA9',
                    text:    'white'
                }
            },
            TAS: {
                key:     'TAS',
                title:   'TAS',
                color: {
                    bgLabel: 'grey',
                    label:   'black;background:linear-gradient(#304352,#d7d2cc,#d7d2cc,#d7d2cc,#304352)',
                    bgText:  'grey',
                    text:    'black;background:linear-gradient(#304352,#d7d2cc,#d7d2cc,#d7d2cc,#304352)'
                }
            }
        },


        config = {
            debugMode: false,
            logging: {
                log: true,
                notice: true,
                info: true,
                warn: true,
                error: true,
                debug: false
            }
        },

        callstackRegistry = [],
		queuedUpdates = {}, //< Used for delaying saves till the last moment.

    complexType = function(o){
        switch(typeof o){
            case 'string':
                return 'string';
            case 'boolean':
                return 'boolean';
            case 'number':
                return (_.isNaN(o) ? 'NaN' : (o.toString().match(/\./) ? 'decimal' : 'integer'));
            case 'function':
                return 'function: '+(o.name ? o.name+'()' : '(anonymous)');
            case 'object':
                return (_.isArray(o) ? 'array' : (_.isArguments(o) ? 'arguments' : ( _.isNull(o) ? 'null' : 'object')));
            default:
                return typeof o;
        }
    },

	dataLogger = function(primaryLogger,secondaryLogger,data){
        _.each(data,function(m){
            var type = complexType(m);
            switch(type){
                case 'string':
                    primaryLogger(m);
                    break;
                case 'undefined':
                case 'null':
                case 'NaN':
                    primaryLogger('['+type+']');
                    break;
                case 'number':
                case 'not a number':
                case 'integer':
                case 'decimal':
                case 'boolean':
                    primaryLogger('['+type+']: '+m);
                    break;
                default:
                    primaryLogger('['+type+']:=========================================');
                    secondaryLogger(m);
                    primaryLogger('=========================================================');
                    break;
            }
        });
	},


    colorLog = function(options){
        var coloredLoggerFunction,
            key = options.key,
            label = options.title || 'TAS',
            lBGColor = (options.color && options.color.bgLabel) || 'blue',
            lTxtColor = (options.color && options.color.label) || 'white',
            mBGColor = (options.color && options.color.bgText) || 'blue',
            mTxtColor = (options.color && options.color.text) || 'white';

        coloredLoggerFunction = function(message){
            /* eslint-disable no-console */
            console.log(
                '%c '+label+': %c '+message + ' ',
                'background-color: '+lBGColor+';color: '+lTxtColor+'; font-weight:bold;',
                'background-color: '+mBGColor+';color: '+mTxtColor+';'
            ); 
            /* eslint-enable no-console */
        };
        return function(){
            if('TAS'===key || config.logging[key]){
                /* eslint-disable no-console */
               dataLogger(coloredLoggerFunction,function(m){console.log(m);},_.toArray(arguments)); 
                /* eslint-enable no-console */
            }
        };
    },

    logDebug  = colorLog(loggingSettings.debug),
    logError  = colorLog(loggingSettings.error),
    logWarn   = colorLog(loggingSettings.warn),
    logInfo   = colorLog(loggingSettings.info),
    logNotice = colorLog(loggingSettings.notice),
    logLog    = colorLog(loggingSettings.log),
    log       = colorLog(loggingSettings.TAS),
    logCS     = colorLog(loggingSettings.callstack),
    logCSA    = colorLog(loggingSettings.callstack_async),

    registerCallstack = function(callstack,label){
        var idx=_.findIndex(callstackRegistry,function(o){
            return (_.difference(o.stack,callstack).length === _.difference(callstack,o.stack).length) &&
                _.difference(o.stack,callstack).length === 0 &&
                o.label === label;
        });
        if(-1 === idx){
            idx=callstackRegistry.length;
            callstackRegistry.push({
                stack: callstack,
                label: label
            });
        }
        return idx;
    },

    setConfigOption = function(options){
        var newconf =_.defaults(options,config);
        newconf.logging=_.defaults(
            (options && options.logging)||{},
            config.logging
        );
        config=newconf;
    },
    
    isDebugMode = function(){
        return config.debugMode;
    },

    debugMode = function(){
        config.logging.debug=true;
        config.debugMode = true;
    },

    getCallstack = function(){
        var e = new Error('dummy'),
            stack = _.map(_.rest(e.stack.replace(/^[^(]+?[\n$]/gm, '')
            .replace(/^\s+at\s+/gm, '')
            .replace(/^Object.<anonymous>\s*\(/gm, '{anonymous}()@')
            .split('\n')),function(l){
                return l.replace(/\s+.*$/,'');
            });
        return stack;
    },
    logCallstackSub = function(cs){
        var matches, csa;
        _.find(cs,function(line){
            matches = line.match(/TAS_CALLSTACK_(\d+)/);
            if(matches){
               csa=callstackRegistry[matches[1]];
               logCSA( '===================='+(csa.label ? '> '+csa.label+' <' : '')+'====================');
               logCallstackSub(csa.stack);
               return true;
            } 
            logCS(line);
            return false;
        });
    },
    logCallstack = function(){
        var cs;
        if(config.debugMode){
            cs = getCallstack();
            cs.shift();
            log('==============================> CALLSTACK <==============================');
            logCallstackSub(cs);
            log('=========================================================================');
        }
    },


    wrapCallback = function (label, callback, context){
        var callstack;
        if('function' === typeof label){
            context=callback;
            callback=label;
            label=undefined;
        }
        if(!config.debugMode){
            return (function(cb,ctx){
                return function(){
                    cb.apply(ctx||{},arguments);
                };
            }(callback,context));
        }
        
        callstack = getCallstack();
        callstack.shift();
        
        return (function(cb,ctx,cs,lbl){
            var ctxref=registerCallstack(cs,lbl);

            /*jshint -W054 */
            return new Function('cb','ctx','TASlog',
                "return function TAS_CALLSTACK_"+ctxref+"(){"+
                    "var start,end;"+
                    "TASlog('Entering: '+(cb.name||'(anonymous function)'));"+
                    "start=_.now();"+
                    "cb.apply(ctx||{},arguments);"+
                    "end=_.now();"+
                    "TASlog('Exiting: '+(cb.name||'(anonymous function)')+' :: '+(end-start)+'ms elapsed');"+
                "};")(cb,ctx,log);
            /*jshint +W054 */
        }(callback,context,callstack,label));
    },


    prepareUpdate = function( attribute, value ){
        queuedUpdates[attribute]=value;
    },

    applyQueuedUpdates = function() {
      setAttrs(queuedUpdates);
      queuedUpdates = {};
    },

	namesFromArgs = function(args,base){
        return _.chain(args)
            .reduce(function(memo,attr){
                if('string' === typeof attr) {
                    memo.push(attr);
                } else if(_.isArray(args) || _.isArguments(args)){
                    memo = namesFromArgs(attr,memo);
                }
                return memo;
            },(_.isArray(base) && base) || [])
            .uniq()
            .value();
	},

	addId = function(obj,value){
		Object.defineProperty(obj,'id',{
			value: value,
			writable: false,
			enumerable: false
		});
	},

	addProp = function(obj,prop,value,fullname){
		(function(){
            var pname=(_.contains(['S','F','I','D'],prop) ? '_'+prop : prop),
                full_pname = fullname || prop,
                pvalue=value;

            _.each(['S','I','F'],function(p){
                if( !_.has(obj,p)){
                    Object.defineProperty(obj, p, {
                        value: {},
                        enumerable: false,
                        readonly: true
                    });
                }
            });
            if( !_.has(obj,'D')){
                Object.defineProperty(obj, 'D', {
                    value: _.reduce(_.range(10),function(m,d){
                            Object.defineProperty(m, d, {
                                value: {},
                                enumerable: true,
                                readonly: true
                            });
                            return m;
                        },{}),
                    enumerable: false,
                    readonly: true
                });
            }


            // Raw value
			Object.defineProperty(obj, pname, {
                enumerable: true,
				set: function(v){
                    if(v!==pvalue) {
                        pvalue=v;
                        prepareUpdate(full_pname,v);
                    }
				},
				get: function(){
					return pvalue;
				}
			});
            
            // string value
			Object.defineProperty(obj.S, pname, {
                enumerable: true,
				set: function(v){
                    var val=v.toString();
                    if(val !== pvalue) {
                        pvalue=val;
                        prepareUpdate(full_pname,val);
                    }
				},
				get: function(){
					return pvalue.toString();
				}
			});

            // int value
			Object.defineProperty(obj.I, pname, {
                enumerable: true,
				set: function(v){
                    var val=parseInt(v,10) || 0;
                    if(val !== pvalue){
                        pvalue=val;
                        prepareUpdate(full_pname,val);
                    }
				},
				get: function(){
					return parseInt(pvalue,10) || 0;
				}
			});

            // float value
			Object.defineProperty(obj.F, pname, {
                enumerable: true,
				set: function(v){
                    var val=parseFloat(v) || 0;
                    if(val !== pvalue) {
                        pvalue=val;
                        prepareUpdate(full_pname,val);
                    }
				},
				get: function(){
					return parseFloat(pvalue) || 0;
				}
			});
            _.each(_.range(10),function(d){
                Object.defineProperty(obj.D[d], pname, {
                    enumerable: true,
                    set: function(v){
                        var val=(parseFloat(v) || 0).toFixed(d);
                        if(val !== pvalue){
                            pvalue=val;
                            prepareUpdate(full_pname,val);
                        }
                    },
                    get: function(){
                        return (parseFloat(pvalue) || 0).toFixed(d);
                    }
                });
            });

		}());
	},
	
	repeating = function( section ) {
		return (function(s){
			var sectionName = s,
				attrNames = [],
				fieldNames = [],
				operations = [],
                after = [],
			
			repAttrs = function TAS_Repeating_Attrs(){
				attrNames = namesFromArgs(arguments,attrNames);
				return this;
			},
			repFields = function TAS_Repeating_Fields(){
				fieldNames = namesFromArgs(arguments,fieldNames);
				return this;
			},
			repReduce = function TAS_Repeating_Reduce(func, initial, final, context) { 
				operations.push({
                    type: 'reduce',
                    func: (func && _.isFunction(func) && func) || _.noop,
                    memo: (_.isUndefined(initial) && 0) || initial,
                    final: (final && _.isFunction(final) && final) || _.noop,
                    context: context || {}
                });
				return this;
			},
			repMap = function TAS_Repeating_Map(func, final, context) {
				operations.push({
                    type: 'map',
                    func: (func && _.isFunction(func) && func) || _.noop,
                    final: (final && _.isFunction(final) && final) || _.noop,
                    context: context || {}
                });
				return this;
			},
            repEach = function TAS_Repeating_Each(func, final, context) {
				operations.push({
                    type: 'each',
                    func: (func && _.isFunction(func) && func) || _.noop,
                    final: (final && _.isFunction(final) && final) || _.noop,
                    context: context || {}
                });
				return this;
            },
            repTap = function TAS_Repeating_Tap(final, context) {
				operations.push({
                    type: 'tap',
                    final: (final && _.isFunction(final) && final) || _.noop,
                    context: context || {}
                });
				return this;
            },
            repAfter = function TAS_Repeating_After(callback,context) {
				after.push({
                    callback: (callback && _.isFunction(callback) && callback) || _.noop,
                    context: context || {}
                });
				return this;
            },
			repExecute = function TAS_Repeating_Execute(callback,context){
				var rowSet = {},
					attrSet = {},
					fieldIds = [],
					fullFieldNames = [];

                repAfter(callback,context);

				// call each operation per row.
				// call each operation's final
				getSectionIDs("repeating_"+sectionName,function(ids){
					fieldIds = ids;
					fullFieldNames = _.reduce(fieldIds,function(memo,id){
						return memo.concat(_.map(fieldNames,function(name){
							return 'repeating_'+sectionName+'_'+id+'_'+name;  
						}));
					},[]);
					getAttrs( _.uniq(attrNames.concat(fullFieldNames)), function(values){
						_.each(attrNames,function(aname){
							if(values.hasOwnProperty(aname)){
								addProp(attrSet,aname,values[aname]);
							}
						});

						rowSet = _.reduce(fieldIds,function(memo,id){
							var r={};
							addId(r,id);
							_.each(fieldNames,function(name){
								var fn = 'repeating_'+sectionName+'_'+id+'_'+name;  
								addProp(r,name,values[fn],fn);
							});

							memo[id]=r;

							return memo;
						},{});

                        _.each(operations,function(op){
                            var res;
                            switch(op.type){
                                case 'tap':
                                    _.bind(op.final,op.context,rowSet,attrSet)();
                                    break;

                                case 'each':
                                    _.each(rowSet,function(r){
                                        _.bind(op.func,op.context,r,attrSet,r.id,rowSet)();
                                    });
                                    _.bind(op.final,op.context,rowSet,attrSet)();
                                    break;

                                case 'map':
                                    res = _.map(rowSet,function(r){
                                        return _.bind(op.func,op.context,r,attrSet,r.id,rowSet)();
                                    });
                                    _.bind(op.final,op.context,res,rowSet,attrSet)();
                                    break;

                                case 'reduce':
                                    res = op.memo;
                                    _.each(rowSet,function(r){
                                        res = _.bind(op.func,op.context,res,r,attrSet,r.id,rowSet)();
                                    });
                                    _.bind(op.final,op.context,res,rowSet,attrSet)();
                                    break;
                            }
                        });

                        // finalize attrs
                        applyQueuedUpdates();
                        _.each(after,function(op){
                            _.bind(op.callback,op.context)();
                        });
					});
				});
			};
				
			return {
				attrs: repAttrs,
				attr: repAttrs,

				column: repFields,
				columns: repFields,
				field: repFields,
				fields: repFields,

				reduce: repReduce,
				inject: repReduce,
				foldl: repReduce,

				map: repMap,
				collect: repMap,

				each: repEach,
                forEach: repEach,

                tap: repTap,
                'do': repTap,

				after: repAfter,
				last: repAfter,
				done: repAfter,

				execute: repExecute,
				go: repExecute,
				run: repExecute
			};
		}(section));
	},


    repeatingSimpleSum = function(section, field, destination){
        repeating(section)
            .attr(destination)
            .field(field)
            .reduce(function(m,r){
                return m + (r.F[field]);
            },0,function(t,r,a){
                a.S[destination]=t;
            })
            .execute();
    };

    /* eslint-disable no-console */
	console.log('%c•.¸¸.•*´¨`*•.¸¸.•*´¨`*•.¸  The Aaron Sheet  v'+version+'  ¸.•*´¨`*•.¸¸.•*´¨`*•.¸¸.•','background: linear-gradient(to right,green,white,white,green); color:black;text-shadow: 0 0 8px white;');
	console.log('%c•.¸¸.•*´¨`*•.¸¸.•*´¨`*•.¸  Last update: '+(new Date(lastUpdate*1000))+'  ¸.•*´¨`*•.¸¸.•*´¨`*•.¸¸.•','background: linear-gradient(to right,green,white,white,green); color:black;text-shadow: 0 0 8px white;');
    /* eslint-enable no-console */


    return {
        /* Repeating Sections */
        repeatingSimpleSum: repeatingSimpleSum,
		repeating: repeating,

        /* Configuration */
        config: setConfigOption,

        /* Debugging */
        callback: wrapCallback,
        callstack: logCallstack,
        debugMode: debugMode,
        isDebugMode: isDebugMode,
        _fn: wrapCallback,

        /* Logging */
        debug: logDebug,
        error: logError,
        warn: logWarn,
        info: logInfo,
        notice: logNotice,
        log: logLog
    };
}());

/* ---- END: TheAaronSheet.js ---- */

/* ======== ROWIDS =============== */
on('sheet:opened change:repeating_traits', function () {
	TAS.repeating('traits')
		.fields('rowid')
		.map(function (r, a, id) {
			r.rowid = id;
		})
		.execute();
});
on('sheet:opened change:repeating_disadvantages', function () {
	TAS.repeating('disadvantages')
		.fields('rowid')
		.map(function (r, a, id) {
			r.rowid = id;
		})
		.execute();
});
on('sheet:opened change:repeating_quirks', function () {
	TAS.repeating('quirks')
		.fields('rowid')
		.map(function (r, a, id) {
			r.rowid = id;
		})
		.execute();
});
on('sheet:opened change:repeating_racial', function () {
	TAS.repeating('racial')
		.fields('rowid')
		.map(function (r, a, id) {
			r.rowid = id;
		})
		.execute();
});
on('sheet:opened change:repeating_skills', function () {
	TAS.repeating('skills')
		.fields('rowid')
		.map(function (r, a, id) {
			r.rowid = id;
		})
		.execute();
});
on('sheet:opened change:repeating_techniques', function () {
	TAS.repeating('techniques')
		.fields('rowid')
		.map(function (r, a, id) {
			r.rowid = id;
		})
		.execute();
});
on('sheet:opened change:repeating_melee', function () {
	TAS.repeating('melee')
		.fields('rowid')
		.map(function (r, a, id) {
			r.rowid = id;
		})
		.execute();
});
on('sheet:opened change:repeating_ranged', function () {
	TAS.repeating('ranged')
		.fields('rowid')
		.map(function (r, a, id) {
			r.rowid = id;
		})
		.execute();
});
on('sheet:opened change:repeating_defense', function () {
	TAS.repeating('defense')
		.fields('rowid')
		.map(function (r, a, id) {
			r.rowid = id;
		})
		.execute();
});
on('sheet:opened change:repeating_item', function () {
	TAS.repeating('item')
		.fields('rowid')
		.map(function (r, a, id) {
			r.rowid = id;
		})
		.execute();
});
on('sheet:opened change:repeating_spells', function () {
	TAS.repeating('spells')
		.fields('rowid')
		.map(function (r, a, id) {
			r.rowid = id;
		})
		.execute();
});
on('sheet:opened change:repeating_rituals', function () {
	TAS.repeating('rituals')
		.fields('rowid')
		.map(function (r, a, id) {
			r.rowid = id;
		})
		.execute();
});
on('sheet:opened change:repeating_vehicle', function () {
	TAS.repeating('vehicle')
		.fields('rowid')
		.map(function (r, a, id) {
			r.rowid = id;
		})
		.execute();
});
/* =========== END ROWIDS ============ */

/* =========== CHARACTER POINT CALCULATIONS ============= */
// <!-- ==== ==== ==== CHARACTER POINT CALCULATION ==== ==== ==== -->	
	// Update Attributes
	on('sheet:opened change:strength_points change:dexterity_points change:intelligence_points change:health_points change:perception_points change:willpower_points change:hit_points_points change:fatigue_points_points change:basic_speed_points change:basic_move_points',
		function (e) {
			getAttrs(['strength_points', 'dexterity_points', 'intelligence_points', 'health_points', 'perception_points', 'willpower_points', 'hit_points_points', 'fatigue_points_points', 'basic_speed_points', 'basic_move_points'], function (v) {
				var vals = Object.values(v);
				vals.push(0);
				setAttrs({
					att_points: vals.reduce(getSum)
				});
			});
		});
	// Update the total cost of Advantages
	on('change:repeating_traits remove:repeating_traits',function(){
	TAS.repeatingSimpleSum('traits','points','advantages_points');
	});
	// Update the total cost of Disadvantages
	on('change:repeating_disadvantages remove:repeating_disadvantages',function(){
	TAS.repeatingSimpleSum('disadvantages','points','disadvantages_points');
	});
	// Update the total cost of Quirks
	on('change:repeating_quirks remove:repeating_quirks',function(){
	TAS.repeatingSimpleSum('quirks','points','quirks_points');
	});
	// Update the total cost of Racial
	on('change:repeating_racial remove:repeating_racial',function(){
	TAS.repeatingSimpleSum('racial','points','racial_points');
	});
	// Update the total cost of Skills
	on('change:repeating_skills remove:repeating_skills',function(){
	TAS.repeatingSimpleSum('skills','points','skills_points');
	});
	// Update the total cost of Techniques
	on('change:repeating_techniques remove:repeating_techniques',function(){
	TAS.repeatingSimpleSum('techniques','points','techniques_points');
	});
		// Add together skills_points and techniques_points
		on('sheet:opened change:skills_points change:techniques_points', function(e) {
			getAttrs(['skills_points', 'techniques_points'],
				function(v) {
					var vals = Object.values(v);
					vals.push(0);
					setAttrs({
						skillstechniques_points: vals.reduce(getSum)
					});
				});
		});

	// Update the total cost of Spells
	on('change:repeating_spells remove:repeating_spells',function(){
	TAS.repeatingSimpleSum('spells','points','spells_points');
	});
	// Update the total cost of Experience
	on('change:repeating_experience remove:repeating_experience',function(){
	TAS.repeatingSimpleSum('experience','points','ex_points');
	});	

	// Update Lines on Techniques
	on('change:repeating_techniques', function () {
	TAS.repeating('techniques')
		.fields('difficulty', 'defaultlvl', 'mlevel', 'bonus', 'points',
			'level')
		.each(function (r) {
			r.D[0].level = Math.min(Math.max(r.F.difficulty + r.F
				.defaultlvl + r.F.bonus + r.F.points, r.F
				.defaultlvl), r.F.mlevel);
		})
		.execute();
		});

	// Update Total Points Value
	on('sheet:opened change:ex_points change:base_points change:repeating_experience:points remove:repeating_experience:points', function(e) {
		getAttrs(['ex_points', 'base_points'],
			function(v) {
				var vals = Object.values(v);
				vals.push(0);
				setAttrs({
					total_points: vals.reduce(getSum)
				});
			});
	});

	on('sheet:opened change:strength_points change:dexterity_points change:intelligence_points change:health_points change:perception_points change:willpower_points change:hit_points_points change:fatigue_points_points change:energy_points_points change:basic_speed_points change:basic_move_points change:striking_st_points change:lift_st_points change:att_points change:advantages_points change:disadvantages_points change:quirks_points change:racial_points change:skills_points change:techniques_points change:spells_points change:ex_points change:total_points', function(e) {
		getAttrs(['att_points', 'advantages_points', 'disadvantages_points', 'quirks_points', 'racial_points', 'skills_points', 'techniques_points', 'spells_points', 'total_points'], function(v) {
			var att = +v.att_points;
			var race = +v.racial_points;
			var adv = +v.advantages_points;
			var dis = +v.disadvantages_points;
			var quirk = +v.quirks_points;
			var skill = +v.skills_points;
			var tech = +v.techniques_points;
			var spell = +v.spells_points;
			var ttlp = +v.total_points;
			var spent = att + race + adv + dis + quirk + skill + tech + spell;
			var unspnt = ttlp - spent;
			setAttrs({
				unspentpoints: unspnt
			});
		});
	});
/* ================ END CHARACTER POINT CALCULATIONS ================= */

/* ======== BEGIN STATS CALCUALTIONS =========== */
	var noop = function () {}; // do nothing.
	var version = '3.5.0';
	var modCascade = true;
	var modCascadeAll = true;
	var damageTable = [];

	on('sheet:opened', function () {
		console.log('********* Sheet Opened *********');
		getAttrs(['sheet_version', 'mod_cascade', 'modCascade',
			'modCascadeAll'
		], function (v) {
			if (v.modCascade && v.modCascadeAll) {
				modCascade = v.modCascade;
				modCascadeAll = v.modCascadeAll;
			}
			if (!v.sheet_version || v.sheet_version != version) {
				// Set sheet version:
				setAttrs({
					sheet_version: version
				});

				// initalize any empty fields in repeating sections since the default values were removed.
				loadRepeating('repeating_skills', 'points', 1);
				loadRepeating('repeating_techniques', 'points', 1);
				loadRepeating('repeating_spells', 'points', 1);
				loadRepeating('repeating_traits', 'points', 1);
				loadRepeating('repeating_disadvantages', 'points', 1);
				loadRepeating('repeating_quirks', 'points', 1);
				loadRepeating('repeating_racial', 'points', 1);

				// initalize all calculated stats
				resetAll(v.mod_cascade);
			}
		});
		
		damageTable = generateDamageTable();

	});

	on('change:mod_cascade', function (e) {
		getAttrs(['mod_cascade'], function (v) {
			resetAll(v.mod_cascade);
		});
	});

	function resetAll(mod_cascade) {
		switch (mod_cascade) {
		case 'all':
			modCascade = true;
			modCascadeAll = true;
			break;
		case 'some':
			modCascade = true;
			modCascadeAll = false;
			break;
		default:
			modCascade = false;
			modCascadeAll = false;
		}
		setAttrs({
			modCascade: modCascade,
			modCascadeAll: modCascadeAll
		});

			// last thing to update is movement
			var thenMovementStats = _.after(1, function () {
				
				// last thing to update is movement tables
				updateEnhancedMove();
				updateFlightValues();
				updateWaterMoveValues();
				updateJumpDistanceValues();
			});	
		
		
		// After move, dodge, encumbrance, HP, and FP
		var thenCurrentMoveDodge = _.after(2, function () {
			updateMoveDodge();
		});

		// After DX and HT
		var thenSpeedMoveDodge = _.after(2, function () {
			updateBasicSpeed(function () {
				// After Basic Speed...
				updateBasicMove(thenCurrentMoveDodge);
				updateDodge(thenCurrentMoveDodge);
			});
		});

		// After Lift and weight...
		var thenEncumbrance = _.after(2, function () {
			updateEncLevel(thenCurrentMoveDodge);
		});

		// Update attributes, then secondary characteristics, and so on...
		updateST(function () {
			// After ST...
			updateHP(thenCurrentMoveDodge);
			updateLift(thenEncumbrance);
			updateStrikingST();
			// updateStrikingST damage rolls
				console.log("update Striking Damage");
				updateStrikingStrengthDamage();
		});
		updateDX(thenSpeedMoveDodge);
		updateIQ(function () {
			// After IQ...
			updateWill();
			updatePer(function () {
				// After Per...
				updateSense();
			});
		});
		updateHT(function () {
			updateFP(thenCurrentMoveDodge);
			thenSpeedMoveDodge();
		});

	}

	// Sum values, used in reduce
	function getSum(total, num) {
		return (+total || 0) + (+num || 0);
	}

	// function to sum a field from a repeating section
	function sumRepeating(sectionName, fieldName, callback) {
		getSectionIDs(sectionName, function (ids) {
			if (ids.length === 0 ) {
				callback(0);
				return;
			}
			var fieldArray = [];
			for (var i = 0; i < ids.length; i++) {
				fieldArray.push(sectionName + '_' + ids[i] + '_' + fieldName);
			}
			getAttrs(fieldArray, function (fieldValues) {
				var vals = Object.values(fieldValues);
				vals.push(0);
				var total = vals.reduce(getSum);
				callback(total);
			});
		});
	}

	// load values of a repeating section
	function loadRepeating(sectionName, fieldName, defaultValue) {
		console.log('********* loadRepeating ' + sectionName + '.' + fieldName + '*********');
		getSectionIDs(sectionName, function (ids) {
			if (ids.length === 0 ) {
				return;
			}
			var fieldArray = [];
			var update = {};
			for (var i = 0; i < ids.length; i++) {
				var propName = sectionName + '_' + ids[i] + '_' + fieldName;
				fieldArray.push(propName);
				update[propName] = defaultValue;
			}
			getAttrs(fieldArray, function (fieldValues) {
				Object.assign(update, fieldValues);
				setAttrs(update);
			});
		});
	}

	// Cond Enh Temp Change
	on('sheet:opened change:cond_ST_mod change:cond_DX_mod change:cond_IQ_mod change:cond_HT_mod change:cond_AD_mod change:cond_SC_mod change:enh_ST_mod change:enh_DX_mod change:enh_IQ_mod change:enh_HT_mod change:enh_AD_mod change:enh_SC_mod change:temp_ST_mod change:temp_DX_mod change:temp_IQ_mod change:temp_HT_mod change:temp_AD_mod change:temp_SC_mod', function (e) {
		updateCondEnhTemp();
	});
	// Update updateCondEnhTemp
	function updateCondEnhTemp(callback) {
		callback = callback || noop;
		console.log('********* updateST *********');
		getAttrs(['cond_ST_mod', 'cond_DX_mod', 'cond_IQ_mod', 'cond_HT_mod', 'cond_AD_mod', 'cond_SC_mod', 'enh_ST_mod', 'enh_DX_mod', 'enh_IQ_mod', 'enh_HT_mod', 'enh_AD_mod', 'enh_SC_mod', 'temp_ST_mod', 'temp_DX_mod', 'temp_IQ_mod', 'temp_HT_mod', 'temp_AD_mod', 'temp_SC_mod'], function (v) {
				var ST = +v.cond_ST_mod + +v.enh_ST_mod;
				var IQ = +v.cond_IQ_mod + +v.enh_IQ_mod;
				var DX = +v.cond_DX_mod + +v.enh_DX_mod;
				var HT = +v.cond_HT_mod + +v.enh_HT_mod;
				var AD = +v.cond_AD_mod + +v.enh_AD_mod;
				var SC = +v.cond_SC_mod + +v.enh_SC_mod;
			setAttrs({
				temp_ST_mod:ST,
				temp_DX_mod:DX,
				temp_IQ_mod:IQ,
				temp_HT_mod:HT,
				temp_AD_mod:AD,
				temp_SC_mod:SC
			}, {
				silent: false
			}, callback);
		});
	}

	// Strength Change
	on('sheet:opened change:strength_points change:strength_mod change:temp_ST_mod', function (e) {
		updateST();
	});
	// Update Strength
	function updateST(callback) {
		callback = callback || noop;
		console.log('********* updateST *********');
		getAttrs(['strength_points', 'strength_mod', 'temp_ST_mod'], function (v) {
			var base = 10 + ((+v.strength_points || 0) / 10 | 0);
			var mod = +v.strength_mod || 0;
			var temp = +v.temp_ST_mod || 0;
			setAttrs({
				strength_base: base,
				strength: base + mod + temp
			}, {
				silent: false
			}, callback);
		});
	}

	// Dexterity Change
	on('sheet:opened change:dexterity_points change:dexterity_mod change:temp_DX_mod', function (e) {
		updateDX();
	});
	// Update Dexterity
	function updateDX(callback) {
		callback = callback || noop;
		console.log('********* updateDX *********');
		getAttrs(['dexterity_points', 'dexterity_mod', 'temp_DX_mod'], function (v) {
			var base = 10 + ((+v.dexterity_points || 0) / 20 | 0);
			var mod = +v.dexterity_mod || 0;
			var temp = +v.temp_DX_mod || 0;
			setAttrs({
				dexterity_base: base,
				dexterity: base + mod + temp
			}, {
				silent: false
			}, callback);
		});
	}

	// Intelligence
	on('sheet:opened change:intelligence_points change:intelligence_mod change:temp_IQ_mod', function (e) {
		updateIQ();
	});
	// Update Intelligence
	function updateIQ(callback) {
		callback = callback || noop;
		console.log('********* updateIQ *********');
		getAttrs(['intelligence_points', 'intelligence_mod', 'temp_IQ_mod'], function (v) {
			var base = 10 + ((+v.intelligence_points || 0) / 20 | 0);
			var mod = +v.intelligence_mod || 0;
			var temp = +v.temp_IQ_mod || 0;
			setAttrs({
				intelligence_base: base,
				intelligence: base + mod + temp
			}, {
				silent: false
			}, callback);
		});
	}

	// Health
	on('sheet:opened change:health_points change:health_mod change:temp_HT_mod', function (e) {
		updateHT();
	});
	// Update Health
	function updateHT(callback) {
		callback = callback || noop;
		console.log('********* updateHT *********');
		getAttrs(['health_points', 'health_mod', 'temp_HT_mod'], function (v) {
			var base = 10 + ((+v.health_points || 0) / 10 | 0);
			var mod = +v.health_mod || 0;
			var temp = +v.temp_HT_mod || 0;
			setAttrs({
				health_base: base,
				health: base + mod + temp
			}, {
				silent: false
			}, callback);
		});
	}

		// HP
		on('sheet:opened change:strength change:hit_points_points change:hit_points_mod', function (e) { updateHP(); });
	// Update HP
	function updateHP(callback) {
		console.log('********* updateHP *********');
		callback = callback || noop;
		getAttrs(['strength', 'strength_base', 'hit_points_points',
			'hit_points_mod'], function (v) {
			var base = (modCascadeAll ? +v.strength : +v.strength_base) +
				((+v.hit_points_points || 0) / 2 | 0);
			var mod = +v.hit_points_mod;
			setAttrs({
				hit_points_max: base + mod
			}, {
				silent: false
			}, function () {
				getAttrs(['hit_points'], function (v2) {
					if (v2.hit_points == null) {
						setAttrs({
							hit_points: base
						}, {
							silent: false
						}, callback);
					} else {
						callback();
					}
				});
			});
		});
	}

	// Wound Thresholds
	on('sheet:opened change:strength change:hit_points_points change:hit_points_mod', function (e) {
		updateThresholds();
	});
	// Update Thresholds
	function updateThresholds(callback) {
		callback = callback || noop;
		console.log('****updateThresholds****');
		getAttrs(['strength', 'strength_base', 'hit_points_points',
			'hit_points_mod'], function (v) {
			var base = (modCascadeAll ? +v.strength : +v.strength_base) + ((+v.hit_points_points || 0) / 2 | 0);
			var mod = +v.hit_points_mod;
			var maxhp = base + mod;
			var reeling = Math.floor(maxhp / 3);
			var collapse = 0;
			var check1 = maxhp * -1;
			var check2 = maxhp * -2;
			var check3 = maxhp * -3;
			var check4 = maxhp * -4;
			var dead = maxhp * -5;
			var dest = maxhp * -10;

			setAttrs({
				reeling_threshold: reeling,
				hp_collapse: collapse,
				hp_check1: check1,
				hp_check2: check2,
				hp_check3: check3,
				hp_check4: check4,
				dead: dead,
				destroyed: dest,
				
			});
		});
	}
	on('sheet:opened change:strength change:hit_points_points change:hit_points_mod', function (e) {
	updateHPLocations();
	});
	function updateHPLocations(v) {
		getAttrs(['strength', 'strength_base', 'hit_points_points',
			'hit_points_mod'], function (v) {
			var base = (modCascadeAll ? +v.strength : +v.strength_base) + ((+v.hit_points_points || 0) / 2 | 0);
			var mod = +v.hit_points_mod;
			var maxhp = base + mod;
			var eyes = Math.floor(maxhp / 10);
			var limb = Math.floor(maxhp / 2);
			var extr = Math.floor(maxhp / 3);

			setAttrs({
				ehp: eyes,
				limbhp: limb,
				extremityhp: extr
				
			});
		});
	}
	
	// FP
	on('sheet:opened change:health change:fatigue_points_points change:fatigue_points_mod',
		function (e) { updateFP(); });
	// Update FP
	function updateFP(callback) {
		console.log('********* updateFP *********');
		callback = callback || noop;
		getAttrs(['health', 'health_base', 'fatigue_points_points',
			'fatigue_points_mod'
		], function (v) {
			var base = (modCascadeAll ? +v.health : +v.health_base) +
				((+v.fatigue_points_points || 0) / 3 | 0);
			var mod = +v.fatigue_points_mod;
			setAttrs({
				fatigue_points_max: base + mod
			}, {
				silent: false
			}, function () {
				getAttrs(['fatigue_points'], function (v2) {
					if (v2.fatigue_points == null) {
						setAttrs({
							fatigue_points: base
						}, {
							silent: false
						}, callback);
					} else {
						callback();
					}
				});
			});
		});
	}

	// Set Fatigue Point Thresholds
	on('sheet:opened change:fatigue_points_max', function updateFpThresholds(
		callback) {
		console.log('**** updateFpThresholds ****');
		getAttrs(['fatigue_points_max'], function (v) {
			var fpMax = v.fatigue_points_max;
			var fpTired = Math.floor(fpMax / 3);
			var fpColl = 0;
			var fpUncon = fpMax * -1;

			setAttrs({
				fp_tired: fpTired,
				fp_collapse: fpColl,
				fp_uncons: fpUncon
			});
		});
	});

	// Perception
	on('sheet:opened change:intelligence change:perception_points change:perception_mod change:enh_Per_mod',
		function (e) {
			updatePer();
		});
	// Update Perception
	function updatePer(callback) {
		console.log('********* updatePer *********');
		callback = callback || noop;
		getAttrs(['intelligence', 'intelligence_base', 'perception_points',
			'perception_mod', 'enh_Per_mod'
		], function (v) {
			var base = (modCascade ? +v.intelligence : +v
				.intelligence_base) +
				((+v.perception_points || 0) / 5 | 0);
			var mod = +v.perception_mod || 0;
			var pEnh = +v.enh_Per_mod || 0;
			setAttrs({
				perception_base: base,
				perception: base + mod + pEnh
			}, {
				silent: false
			}, callback);
		});
	}

// Vision
	on('sheet:opened change:perception change:vision_points change:vision_mod change:enh_vision_mod',
		function (e) {
			updateVision();
		});
	// Update Vision
	function updateVision(callback) {
		console.log('********* updateVision *********');
		callback = callback || noop;
		getAttrs(['perception', 'perception_base', 'vision_points',
			'vision_mod', 'enh_vision_mod'
		], function (v) {
			var base = (modCascade ? +v.perception : +v
				.perception_base) +
				((+v.vision_points || 0) / 5 | 0);
			var mod = +v.vision_mod || 0;
			var enh = +v.enh_vision_mod || 0;
			setAttrs({
				vision_base: base,
				vision: base + mod + enh
			}, {
				silent: false
			}, callback);
		});
	}
	// Hearing
	on('sheet:opened change:perception change:hearing_points change:hearing_mod change:enh_hearing_mod',
		function (e) {
			updateHearing();
		});
	// Update Hearing
	function updateHearing(callback) {
		console.log('********* updateHearing *********');
		callback = callback || noop;
		getAttrs(['perception', 'perception_base', 'hearing_points',
			'hearing_mod', 'enh_hearing_mod'
		], function (v) {
			var base = (modCascade ? +v.perception : +v
				.perception_base) +
				((+v.hearing_points || 0) / 5 | 0);
			var mod = +v.hearing_mod || 0;
			var enh = +v.enh_hearing_mod || 0;
			setAttrs({
				hearing_base: base,
				hearing: base + mod + enh
			}, {
				silent: false
			}, callback);
		});
	}
	// Taste_Smell
	on('sheet:opened change:perception change:taste_smell_points change:taste_smell_mod change:enh_taste_smell_mod',
		function (e) {
			updateTaste_Smell();
		});
	// Update Taste_Smell
	function updateTaste_Smell(callback) {
		console.log('********* updateTaste_Smell *********');
		callback = callback || noop;
		getAttrs(['perception', 'perception_base', 'taste_smell_points',
			'taste_smell_mod', 'enh_taste_smell_mod'
		], function (v) {
			var base = (modCascade ? +v.perception : +v
				.perception_base) +
				((+v.taste_smell_points || 0) / 5 | 0);
			var mod = +v.taste_smell_mod || 0;
			var enh = +v.enh_taste_smell_mod || 0;
			setAttrs({
				taste_smell_base: base,
				taste_smell: base + mod + enh
			}, {
				silent: false
			}, callback);
		});
	}
	// Touch
	on('sheet:opened change:perception change:touch_points change:touch_mod change:enh_touch_mod',
		function (e) {
			updateTouch();
		});
	// Update Touch
	function updateTouch(callback) {
		console.log('********* updateTouch *********');
		callback = callback || noop;
		getAttrs(['perception', 'perception_base', 'touch_points',
			'touch_mod', 'enh_touch_mod'
		], function (v) {
			var base = (modCascade ? +v.perception : +v
				.perception_base) +
				((+v.touch_points || 0) / 5 | 0);
			var mod = +v.touch_mod || 0;
			var enh = +v.enh_touch_mod || 0;
			setAttrs({
				touch_base: base,
				touch: base + mod + enh
			}, {
				silent: false
			}, callback);
		});
	}

	// Update Willpower, Fear
	on('sheet:opened change:intelligence change:willpower_points change:willpower_mod change:enh_Will_mod change:fear_check_points change:fear_check_mod change:combat_reflexes',
		function (e) {
			updateWill();
		});
	// Update Willpower, Fear -- Updated to reflect 'Rule of 14' for fright checks pg. 360
	function updateWill() {
		console.log('********* updateWill *********');
		getAttrs(['intelligence', 'intelligence_base', 'willpower_points',
			'willpower_mod', 'enh_Will_mod', 'fear_check_points', 'fear_check_mod', 'combat_reflexes'
		], function (v) {
			var wBase = (modCascade ? +v.intelligence : +v
					.intelligence_base) +
				((+v.willpower_points || 0) / 5 | 0);
			var wMod = +v.willpower_mod || 0;
			var wEnh = +v.enh_Will_mod || 0;
			var fBase = wBase + (modCascade ? +wMod : 0) +
				((+v.fear_check_points || 0) / 2 | 0);
			var rBase = +v.combat_reflexes || 0;
			var rMod = rBase * 2;
			var fMod = +v.fear_check_mod || 0;
			var fCheck = fBase + fMod + rMod;
			setAttrs({
				willpower_base: wBase,
				willpower: wBase + wMod + wEnh,
				fear_check_base: fBase,
				fear_check: fCheck
			});
		});
	}

	// Check for conditions to HT and conditions
	on('sheet:opened change:health change:stun_check_mod change:knockdown_check_mod change:unconscious_check_mod change:unconscious_check_points change:death_check_mod change:death_check_points', function (e) {
		updateHealthConditionChecks();
	});
	
	// Update HT, update Stun, Knockdown, Unconscious, and Death Checks
	function updateHealthConditionChecks() {
		console.log('********* updateHealthConditionChecks *********');
		getAttrs(['health', 'health_base', 'stun_check_mod', 'knockdown_check_mod', 'unconscious_check_mod', 'unconscious_check_points', 'death_check_mod', 'death_check_points'], function(v) {
			
			var healthBase = (modCascade ? +v.health : +v.health_base);
			
			// stun
			var stunMod = +v.stun_check_mod || 0;
			
			var stunCheck = healthBase + stunMod;
			
			// knockdown	
			var knockDownMod = +v.knockdown_check_mod || 0;
			
			var knockDownCheck = healthBase + knockDownMod;
			
			// unconscious
			var unconsciousMod = +v.unconscious_check_mod || 0; 
			
			var unconsciousCheck = healthBase + (modCascade ? +unconsciousMod : 0) + ((+v.unconscious_check_points || 0) / 2 | 0);
			
			// death
			var deathMod = +v.death_check_mod || 0;
			
			var deathCheck = healthBase + (modCascade ? +deathMod : 0) + ((+v.death_check_points || 0) / 2 | 0);
			var retch = 25 - (modCascade ? +v.health : +v.health_base);
			
			setAttrs({
			    stun_check: stunCheck,
				knockdown_check: knockDownCheck,
				unconscious_check: unconsciousCheck,
				death_check: deathCheck,
				retchingtime: retch
			});
		});
	}
	
		// check to see if modifier for fright check threshold changed
		on("change:fright_check_threshold_mod", function(event) {
			
			updateFrightCheckThreshold();
			
		});
		
		function updateFrightCheckThreshold() {
			
			var fields = [
				"fright_check_threshold_mod"
				];
			
			getAttrs(fields, function(values) {
				
				var base = 13;
				
				var mod = +values.fright_check_threshold_mod;
				
				var final = base + mod;
				
				setAttrs({
					"fright_check_threshold": final 
				});
				
			});
			
		}

	// Speed
	on('sheet:opened change:dexterity change:health change:basic_speed_points change:basic_speed_mod',
		function (e) {
			updateBasicSpeed();
		});
	// Update Speed
	function updateBasicSpeed(callback) {
		console.log('********* updateBasicSpeed *********');
		callback = callback || noop;
		getAttrs(['dexterity', 'dexterity_base', 'health', 'health_base',
			'basic_speed_points', 'basic_speed_mod'
		], function (v) {
			var dx = (modCascade ? +v.dexterity : +v.dexterity_base);
			var ht = (modCascade ? +v.health : +v.health_base);
			var base = (dx + ht) / 4 + (((+v.basic_speed_points || 0) / 5 |
				0) * 0.25);
			var mod = +v.basic_speed_mod || 0;
			setAttrs({
				basic_speed_base: base,
				basic_speed: base + mod
			}, {
				silent: false
			}, callback);
		});
	}

	// Basic Move
	on('sheet:opened sheet:opened change:basic_speed change:basic_move_points change:basic_move_mod',
		function (e) {
			updateBasicMove();
		});
	// Update Move
	function updateBasicMove(callback) {
		console.log('********* updateBasicMove *********');
		callback = callback || noop;
		getAttrs(['basic_speed', 'basic_speed_base', 'basic_move_points', 'basic_move_mod'], function (v) {
			var speed = (modCascade ? +v.basic_speed : +v.basic_speed_base);
			var base = Math.floor(speed) + ((+v.basic_move_points || 0) /
				5 | 0);
			var mod = +v.basic_move_mod || 0;
			setAttrs({
				basic_move_base: base,
				basic_move: base + mod
			}, {
				silent: false
			}, callback);
		});
	}
	
	// Dodge
	on('sheet:opened change:basic_speed change:dodge_mod', function (e) {
		updateDodge();
	});
	// Update Dodge
	function updateDodge(callback) {
		console.log('********* updateDodge *********');
		callback = callback || noop;
		getAttrs(['basic_speed', 'basic_speed_base', 'dodge_mod'], function (v) {
			var speed = (modCascade ? +v.basic_speed : +v.basic_speed_base);
			var base = Math.floor(speed) + 3;
			var mod = +v.dodge_mod || 0;
			setAttrs({
				dodge_base: base,
				dodge: base + mod
			}, {
				silent: false
			}, callback);
		});
	}
	
	on('sheet:opened change:basic_speed change:dodge change:dodge_mod', function (e) {
		updateDodgeLevels();
		});
		// Update Dodge Levels
		function updateDodgeLevels(callback) {
		console.log('********* updateDodge *********');
		callback = callback || noop;
		getAttrs(['dodge'], function (v) {
			var dodge = +v.dodge || 0;
			var dodge0 = dodge;
			var dodge1 = dodge - 1;
			var dodge2 = dodge - 2;
			var dodge3 = dodge - 3;
			var dodge4 = dodge - 4;
			setAttrs({
				dodge_0: dodge0,
				dodge_1: dodge1,
				dodge_2: dodge2,
				dodge_3: dodge3,
				dodge_4: dodge4
				}, {
				silent: false
			}, callback);
		});
	}
	
	// Encumbered/injured move and dodge
	on('sheet:opened change:encumbrance_level change:dodge change:basic_move change:hit_points change:fatigue_points change:temp_ST_mod',
		function (e) {
			updateMoveDodge();
		});
		
	// Update encumbered/injured move and dodge
	function updateMoveDodge() {
		console.log('***** UPDATE MOVE/DODGE *****');
		getAttrs(['encumbrance_level', 'dodge', 'basic_move', 'hit_points',
			'hit_points_max', 'fatigue_points', 'fatigue_points_max',
			'strength_base', 'strength_mod', 'temp_ST_mod'
		], function (v) {
			var dodge = +v.dodge;
			var move = +v.basic_move;
			var reeling;
			var strength = +v.strength_base + +v.strength_mod + +v.temp_ST_mod;
			if (v.encumbrance_level === 5) {
				dodge = 1;
				move = 1;
			} else {
				dodge = dodge - +v.encumbrance_level;
				// There is some math error when calculating Encumbrance which requires the modifier of 1.01 instead of 1 below
				move = Math.floor(+v.basic_move * (1.01 - (0.2 * +v
					.encumbrance_level)));
				dodge = dodge < 1 ? 1 : dodge;
				move = move < 1 ? 1 : move;
			}
			if (+v.hit_points < +v.hit_points_max / 3) {
				dodge = Math.ceil(dodge / 2);
				move = Math.ceil(move / 2);
				reeling = 1;
			}
			if (+v.hit_points < +v.hit_points_max / 3) {
				reeling = 1;
			} else { reeling = 0; }
			if (+v.fatigue_points < +v.fatigue_points_max / 3) {
				dodge = Math.ceil(dodge / 2);
				move = Math.ceil(move / 2);
				strength = Math.ceil(strength / 2);
			}
			if (+v.fatigue_points < +v.fatigue_points_max / 3) {
				tired = 1;
				} else { tired = 0; }
			setAttrs({
				current_move: move,
				current_dodge: dodge,
				strength: strength,
				reeling: reeling,
				tired: tired
			});
		});
	}

	// Encumbrance Name
	on('sheet:opened change:encumbrance_level change_strength change:hit_points change:fatigue_points change:temp_ST_mod',
		function (e) {
			updateEncumbranceName();
		});
	// Update Encumbrance Name
	function updateEncumbranceName() {
		console.log('***** UPDATE ENC NAME *****');
		getAttrs(['encumbrance_level'], function (v) {
		var enc = +v.encumbrance_level;
			if (enc == 0) {name = "None";}
			else if (enc == 1) {name = "Light";}
			else if (enc == 2) {name = "Medium";}
			else if (enc == 3) {name = "Heavy";}
			else if (enc == 4) {name = "Extra Heavy";}
			else if (enc > 4) {name = "OVERLOADED!!";}
			setAttrs({
				encumbrance_name: name
			});
		});
	}

	// Lifting ST
	on('sheet:opened change:strength change:superstrength change:lift_st_points change:lift_st_mod', function (e) {
		updateLift();
	});
// Update Lift
	function updateLift(callback) {
		console.log('********* updateLift *********');
		callback = callback || noop;
		getAttrs(['strength', 'strength_base', 'superstrength', 'lift_st_points', 'lift_st_mod'],
			function (v) {
				var base = (modCascade ? +v.strength : +v.strength_base) +
					((+v.lift_st_points || 0) / 3 | 0);
				var modded = base + +v.lift_st_mod +v.superstrength;
				var basicLift = (modded * modded) / 5;
				if (basicLift >= 10) {
					basicLift = Math.round(basicLift);
				}
				var lift0unit = " lb";
				var lift0 = basicLift;
				if (lift0 >= 2000 && lift0 < 2000000) {
				lift0 = Math.round(lift0 / 2000);
				lift0unit = " tn";
				} else if (lift0 >= 2000000) {
					lift0 = Math.round(lift0 / 2000000);
					lift0unit = " kt"
				}
				var lift1unit = " lb";
				var lift1 = basicLift * 2;
				if (lift1 >= 2000 && lift1 < 2000000) {
				lift1 = Math.round(lift1 / 2000);
				lift1unit = " tn";
				} else if (lift1 >= 2000000) {
					lift1 = Math.round(lift1 / 2000000);
					lift1unit = " kt"
				}
				var lift2unit = " lb";
				var lift2 = basicLift * 3;
				if (lift2 >= 2000 && lift2 < 2000000) {
				lift2 = Math.round(lift2 / 2000);
				lift2unit = " tn";
				} else if (lift2 >= 2000000) {
					lift2 = Math.round(lift2 / 2000000);
					lift2unit = " kt"
				}
				var lift3unit = " lb";
				var lift3 = basicLift * 6;
				if (lift3 >= 2000 && lift3 < 2000000) {
				lift3 = Math.round(lift3 / 2000);
				lift3unit = " tn";
				} else if (lift3 >= 2000000) {
					lift3 = Math.round(lift3 / 2000000);
					lift3unit = " kt"
				}
				var lift4unit = " lb";
				var lift4 = basicLift * 10;
				if (lift4 >= 2000 && lift4 < 2000000) {
				lift4 = Math.round(lift4 / 2000);
				lift4unit = " tn";
				} else if (lift4 >= 2000000) {
					lift4 = Math.round(lift4 / 2000000);
					lift4unit = " kt"
				}
				var twoHandunit = " lb";
				var twoHand = basicLift * 8;
				if (twoHand >= 2000 && twoHand < 2000000) {
				twoHand = Math.round(twoHand / 2000);
				twoHandunit = " tn";
				} else if (twoHand >= 2000000) {
					twoHand = Math.round(twoHand / 2000000);
					twoHandunit = " kt"
				}
				var shoveunit = " lb";
				var shove = basicLift * 12;
				if (shove >= 2000 && shove < 2000000) {
				shove = Math.round(shove / 2000);
				shoveunit = " tn";
				} else if (shove >= 2000000) {
					shove = Math.round(shove / 2000000);
					shoveunit = " kt"
				}
				var shove2unit = " lb";
				var shove2 = basicLift * 24;
				if (shove2 >= 2000 && shove2 < 2000000) {
				shove2 = Math.round(shove2 / 2000);
				shove2unit = " tn";
				} else if (shove2 >= 2000000) {
					shove2 = Math.round(shove2 / 2000000);
					shove2unit = " kt"
				}
				var carry = basicLift * 15;
				var carryunit = " lb"
				if (carry >= 2000 && carry < 2000000) {
				carry = Math.round(carry / 2000);
				carryunit = " tn";
				} else if (carry >= 2000000) {
					carry = Math.round(carry / 2000000);
					carryunit = " kt"
				}
				var shift = basicLift * 50;
				var shiftunit = " lb"
				if (shift >= 2000 && shift < 2000000) {
				shift = Math.round(shift / 2000);
				shiftunit = " tn";
				} else if (shift >= 2000000) {
					shift = Math.round(shift / 2000000);
					shiftunit = " kt"
				}
				setAttrs({
					lift_st_base: base,
					lift_st: modded,
					basic_lift: basicLift,
					lift_0: lift0,
					lift0unit: lift0unit,
					lift_1: lift1,
					lift1unit: lift1unit,
					lift_2: lift2,
					lift2unit: lift2unit,
					lift_3: lift3,
					lift3unit: lift3unit,
					lift_4: lift4,
					lift4unit: lift4unit,
					one_hand_lift: lift1,
					two_hand_lift: twoHand,
					twoHandunit: twoHandunit,
					shove_lift: shove,
					shoveunit: shoveunit,
					run_shove_lift: shove2,
					shove2unit: shove2unit,
					carry_back_lift: carry,
					carryunit: carryunit,
					shift_lift: shift,
					shiftunit: shiftunit					
				}, {silent: false}, callback);
			});
	}

	// Striking ST
	on('sheet:opened change:strength change:superstrength change:striking_st_points change:striking_st_mod change:temp_ST_mod', function (e) {
		updateStrikingST();
	});
	// Update Striking
	function updateStrikingST() {
		console.log('********* updateStrikingST *********');
		getAttrs(['strength', 'strength_base', 'superstrength', 'striking_st_points', 'striking_st_mod', 'temp_ST_mod'], function(v) {
			var base = (modCascade ? +v.strength : +v.strength_base) +
				((+v.striking_st_points || 0) / 5 | 0);
			var mod = +v.striking_st_mod;
			var temp = +v.temp_ST_mod;
			var sup = +v.superstrength;
			setAttrs({
				striking_st_base: base,
				striking_st: base + mod + temp + sup
			});
		});
	}

	// Update thrust and swing when striking st is updated
	on('change:striking_st', function(e){

		updateStrikingStrengthDamage();
		
	});

	/**
	 * Get the striking ST value and then get the damage type
	 * update Thrust and Swing
	 */
	function updateStrikingStrengthDamage(callback) {
	    
	    console.log("******** updateStrikingStrengthDamage ********");

		// get Strking strength
		getAttrs(['striking_st'], function(values) {

			callback = callback || noop;

			// + means to convert variable to number
			var strikingST = +values.striking_st;

			// get the damageType object (strength, thrust, swing)
			var damageType = getDamageType(strikingST);

			// set thrust and swing
			setAttrs({ 
				thrust: damageType.thrust,
				swing: damageType.swing
			}, {silent: false}, callback);

		});

	}

	/**
	 * Returns the damage type object 
	 * based on ST
	 * damageType {strength, thrust, swing}
	 *
	 * @param int strikingST ST of attack
	 *
	 * @return object 
	 */
	function getDamageType(strikingST) {

		// return value
		var damgeType = null;

		var modifier = 0;

		var baseThrust = 11;

		var baseSwing = 13;

		// prevent bad ST from causing issue
		if (isNaN(strikingST) || strikingST < 0) {
			strikingST = 1;
		}

		if (strikingST < 110) {

			// get damageType from table
			damageType = damageTable[strikingST];

		} else {

			// calculate the total 
			// Add 1d6 to thrust and swing for every full 10 points over 100
			modifier = Math.floor((strikingST - 100) / 10);
			
			baseThrust = baseThrust + modifier;

			baseSwing = baseSwing + modifier;

			damageType = {strength:strikingST, thrust:baseThrust + "d6", swing:baseSwing + "d6"}; 

		}

		return damageType;
	} 

	/**
	 * Populates the global variable damageTable
	 */
	function generateDamageTable() {

		var damageTable = [];

		damageTable[0] = {strength:"0", thrust:"1d6-6", swing:"1d6-6"};
		damageTable[1] = {strength:"1", thrust:"1d6-6", swing:"1d6-5"};
		damageTable[2] = {strength:"2", thrust:"1d6-6", swing:"1d6-5"};
		damageTable[3] = {strength:"3", thrust:"1d6-5", swing:"1d6-4"};
		damageTable[4] = {strength:"4", thrust:"1d6-5", swing:"1d6-4"};
		damageTable[5] = {strength:"5", thrust:"1d6-4", swing:"1d6-3"};
		damageTable[6] = {strength:"6", thrust:"1d6-4", swing:"1d6-3"};
		damageTable[7] = {strength:"7", thrust:"1d6-3", swing:"1d6-2"};
		damageTable[8] = {strength:"8", thrust:"1d6-3", swing:"1d6-2"};
		damageTable[9] = {strength:"9", thrust:"1d6-2", swing:"1d6-1"};
		damageTable[10] = {strength:"10", thrust:"1d6-2", swing:"1d6"};
		damageTable[11] = {strength:"11", thrust:"1d6-1", swing:"1d6+1"};
		damageTable[12] = {strength:"12", thrust:"1d6-1", swing:"1d6+2"};
		damageTable[13] = {strength:"13", thrust:"1d6", swing:"2d6-1"};
		damageTable[14] = {strength:"14", thrust:"1d6", swing:"2d6"};
		damageTable[15] = {strength:"15", thrust:"1d6+1", swing:"2d6+1"};
		damageTable[16] = {strength:"16", thrust:"1d6+1", swing:"2d6+2"};
		damageTable[17] = {strength:"17", thrust:"1d6+2", swing:"3d6-1"};
		damageTable[18] = {strength:"18", thrust:"1d6+2", swing:"3d6"};
		damageTable[19] = {strength:"19", thrust:"2d6-1", swing:"3d6+1"};
		damageTable[20] = {strength:"20", thrust:"2d6-1", swing:"3d6+2"};
		damageTable[21] = {strength:"21", thrust:"2d6", swing:"4d6-1"};
		damageTable[22] = {strength:"22", thrust:"2d6", swing:"4d6"};
		damageTable[23] = {strength:"23", thrust:"2d6+1", swing:"4d6+1"};
		damageTable[24] = {strength:"24", thrust:"2d6+1", swing:"4d6+2"};
		damageTable[25] = {strength:"25", thrust:"2d6+2", swing:"5d6-1"};
		damageTable[26] = {strength:"26", thrust:"2d6+2", swing:"5d6"};
		damageTable[27] = {strength:"27", thrust:"3d6-1", swing:"5d6+1"};
		damageTable[28] = {strength:"28", thrust:"3d6-1", swing:"5d6+1"};
		damageTable[29] = {strength:"29", thrust:"3d6", swing:"5d6+2"};
		damageTable[30] = {strength:"30", thrust:"3d6", swing:"5d6+2"};
		damageTable[31] = {strength:"31", thrust:"3d6+1", swing:"6d6-1"};
		damageTable[32] = {strength:"32", thrust:"3d6+1", swing:"6d6-1"};
		damageTable[33] = {strength:"33", thrust:"3d6+2", swing:"6d6"};
		damageTable[34] = {strength:"34", thrust:"3d6+2", swing:"6d6"};
		damageTable[35] = {strength:"35", thrust:"4d6-1", swing:"6d6+1"};
		damageTable[36] = {strength:"36", thrust:"4d6-1", swing:"6d6+1"};
		damageTable[37] = {strength:"37", thrust:"4d6", swing:"6d6+2"};
		damageTable[38] = {strength:"38", thrust:"4d6", swing:"6d6+2"};
		damageTable[39] = {strength:"39", thrust:"4d6+1", swing:"7d6-1"};
		damageTable[40] = {strength:"40", thrust:"4d6+1", swing:"7d6-1"};
		damageTable[41] = {strength:"41", thrust:"4d6+1", swing:"7d6-1"};
		damageTable[42] = {strength:"42", thrust:"4d6+1", swing:"7d6-1"};
		damageTable[43] = {strength:"43", thrust:"4d6+1", swing:"7d6-1"};
		damageTable[44] = {strength:"44", thrust:"4d6+1", swing:"7d6-1"};
		damageTable[45] = {strength:"45", thrust:"5d6", swing:"7d6+1"};
		damageTable[46] = {strength:"46", thrust:"5d6", swing:"7d6+1"};
		damageTable[47] = {strength:"47", thrust:"5d6", swing:"7d6+1"};
		damageTable[48] = {strength:"48", thrust:"5d6", swing:"7d6+1"};
		damageTable[49] = {strength:"49", thrust:"5d6", swing:"7d6+1"};
		damageTable[50] = {strength:"50", thrust:"5d6+2", swing:"8d6-1"};
		damageTable[51] = {strength:"51", thrust:"5d6+2", swing:"8d6-1"};
		damageTable[52] = {strength:"52", thrust:"5d6+2", swing:"8d6-1"};
		damageTable[53] = {strength:"53", thrust:"5d6+2", swing:"8d6-1"};
		damageTable[54] = {strength:"54", thrust:"5d6+2", swing:"8d6-1"};
		damageTable[55] = {strength:"55", thrust:"6d6", swing:"8d6+1"};	
		damageTable[56] = {strength:"56", thrust:"6d6", swing:"8d6+1"};	
		damageTable[57] = {strength:"57", thrust:"6d6", swing:"8d6+1"};	
		damageTable[58] = {strength:"58", thrust:"6d6", swing:"8d6+1"};	
		damageTable[59] = {strength:"59", thrust:"6d6", swing:"8d6+1"};	
		damageTable[60] = {strength:"60", thrust:"7d6-1", swing:"9d6"};	
		damageTable[61] = {strength:"61", thrust:"7d6-1", swing:"9d6"};	
		damageTable[62] = {strength:"62", thrust:"7d6-1", swing:"9d6"};	
		damageTable[63] = {strength:"63", thrust:"7d6-1", swing:"9d6"};	
		damageTable[64] = {strength:"64", thrust:"7d6-1", swing:"9d6"};	
		damageTable[65] = {strength:"65", thrust:"7d6+1", swing:"9d6+2"};	
		damageTable[66] = {strength:"66", thrust:"7d6+1", swing:"9d6+2"};	
		damageTable[67] = {strength:"67", thrust:"7d6+1", swing:"9d6+2"};	
		damageTable[68] = {strength:"68", thrust:"7d6+1", swing:"9d6+2"};	
		damageTable[69] = {strength:"69", thrust:"7d6+1", swing:"9d6+2"};	
		damageTable[70] = {strength:"70", thrust:"8d6", swing:"10d6"};	
		damageTable[71] = {strength:"71", thrust:"8d6", swing:"10d6"};	
		damageTable[72] = {strength:"72", thrust:"8d6", swing:"10d6"};	
		damageTable[73] = {strength:"73", thrust:"8d6", swing:"10d6"};	
		damageTable[74] = {strength:"74", thrust:"8d6", swing:"10d6"};	
		damageTable[75] = {strength:"75", thrust:"8d6+2", swing:"10d6+2"};
		damageTable[76] = {strength:"76", thrust:"8d6+2", swing:"10d6+2"};
		damageTable[77] = {strength:"77", thrust:"8d6+2", swing:"10d6+2"};
		damageTable[78] = {strength:"78", thrust:"8d6+2", swing:"10d6+2"};
		damageTable[79] = {strength:"79", thrust:"8d6+2", swing:"10d6+2"};
		damageTable[80] = {strength:"80", thrust:"9d6", swing:"11d6"};
		damageTable[81] = {strength:"81", thrust:"9d6", swing:"11d6"};
		damageTable[82] = {strength:"82", thrust:"9d6", swing:"11d6"};
		damageTable[83] = {strength:"83", thrust:"9d6", swing:"11d6"};
		damageTable[84] = {strength:"84", thrust:"9d6", swing:"11d6"};
		damageTable[85] = {strength:"85", thrust:"9d6+2", swing:"11d6+2"};
		damageTable[86] = {strength:"86", thrust:"9d6+2", swing:"11d6+2"};
		damageTable[87] = {strength:"87", thrust:"9d6+2", swing:"11d6+2"};
		damageTable[88] = {strength:"88", thrust:"9d6+2", swing:"11d6+2"};
		damageTable[89] = {strength:"89", thrust:"9d6+2", swing:"11d6+2"};
		damageTable[90] = {strength:"90", thrust:"10d6", swing:"12d6"};
		damageTable[91] = {strength:"91", thrust:"10d6", swing:"12d6"};
		damageTable[92] = {strength:"92", thrust:"10d6", swing:"12d6"};
		damageTable[93] = {strength:"93", thrust:"10d6", swing:"12d6"};
		damageTable[94] = {strength:"94", thrust:"10d6", swing:"12d6"};
		damageTable[95] = {strength:"95", thrust:"10d6+2", swing:"12d6+2"};
		damageTable[96] = {strength:"96", thrust:"10d6+2", swing:"12d6+2"};
		damageTable[97] = {strength:"97", thrust:"10d6+2", swing:"12d6+2"};
		damageTable[98] = {strength:"98", thrust:"10d6+2", swing:"12d6+2"};
		damageTable[99] = {strength:"99", thrust:"10d6+2", swing:"12d6+2"};
		damageTable[100] = {strength:"100", thrust:"11d6", swing:"13d6"};

		return damageTable;

	}



	// -------------encumbrance-----------------------------------------------
	on('sheet:opened change:repeating_item', function(){
		TAS.repeating('item')
			.attrs('total_weight_x', 'total_weight_a', 'total_weight_b', 'total_weight_c','total_cost_x', 'total_cost_a', 'total_cost_b', 'total_cost_c' )
			.fields('count','carried_a','carried_b','carried_c','weight','weighttotal','weighttotal_a', 'weighttotal_b', 'weighttotal_c', 'cost','costtotal', 'costtotal_a', 'costtotal_b', 'costtotal_c')
			.reduce(function(m,r){
				m.weight+=(r.F.weight*r.I.count);
				m.weight_a+=(r.F.weight*r.I.count*r.I.carried_a);
				m.weight_b+=(r.F.weight*r.I.count*r.I.carried_b);
				m.weight_c+=(r.F.weight*r.I.count*r.I.carried_c);
				r.D[5].weighttotal = (r.F.weight * r.I.count);
				r.D[5].weighttotal_a = (r.F.weight * r.I.count * r.I.carried_a);
				r.D[5].weighttotal_b = (r.F.weight * r.I.count * r.I.carried_b);
				r.D[5].weighttotal_c = (r.F.weight * r.I.count * r.I.carried_c);
				r.D[2].costtotal = (r.F.cost * r.I.count);
				r.D[2].costtotal_a = (r.F.cost * r.I.count * r.I.carried_a);
				r.D[2].costtotal_b = (r.F.cost * r.I.count * r.I.carried_b);
				r.D[2].costtotal_c = (r.F.cost * r.I.count * r.I.carried_c);
				m.cost+=(r.F.cost*r.I.count);
				m.cost_a+=(r.F.cost*r.I.count*r.I.carried_a);
				m.cost_b+=(r.F.cost*r.I.count*r.I.carried_b);
				m.cost_c+=(r.F.cost*r.I.count*r.I.carried_c);
				return m;			
			},{weight:0,cost:0,weight_a:0,cost_a:0,weight_b:0,cost_b:0,weight_c:0,cost_c:0},function(m,r,a){          
				a.D[5].total_weight_x=m.weight;
				a.D[2].total_cost_x=m.cost;
				a.D[5].total_weight_a=m.weight_a;
				a.D[2].total_cost_a=m.cost_a;
				a.D[5].total_weight_b=m.weight_b;
				a.D[2].total_cost_b=m.cost_b;
				a.D[5].total_weight_c=m.weight_c;
				a.D[2].total_cost_c=m.cost_c;
				})
				.execute();
	});

	on('sheet:opened change:loadoutchoice change:total_weight_a change:total_weight_b change:total_weight_c',
		function (e) {
			getAttrs(['loadoutchoice', 'total_weight_a', 'total_weight_b',
				'total_weight_c'
			], function (v) {
				var weight;
				switch (+v.loadoutchoice) {
				case 1:
					weight = +v.total_weight_a;
					break;
				case 2:
					weight = +v.total_weight_b;
					break;
				case 3:
					weight = +v.total_weight_c;
					break;
				}
				total_weight_unit = " lb"
				if (weight > 2000) {
				weight = Math.floor(weight / 2000);
				total_weight_unit = " tn";
			}
				setAttrs({
					total_weight: weight
				});
			});
		});

	// Get Encumbrance Level:
	on('change:total_weight change:basic_lift', function (e) {
		updateEncLevel();
	});
	function updateEncLevel(callback) {
		getAttrs(['basic_lift', 'total_weight'], function (v) {
			callback = callback || noop;
			var basicLift = +v.basic_lift;
			var encumbranceLevel = Math.floor(v.total_weight / basicLift);
			if (encumbranceLevel > 0 && (v.total_weight % basicLift) ===
				0) {
				encumbranceLevel--;
			}
			if (encumbranceLevel >= 10) {
				encumbranceLevel = 4;
			} else if (encumbranceLevel >= 6) {
				encumbranceLevel = 4;
			} else if (encumbranceLevel >= 3) {
				encumbranceLevel = 3;
			}
			var pen = encumbranceLevel * -1;
			setAttrs({
				encumbrance_level: encumbranceLevel,
				defend_encumbrance_penalty: pen
				 },
					{silent: false},
				callback
			);
		});
	}
     on("change:enhanced_ground_move_mod change:enhanced_ground_move_points change:basic_move change:encumbrance_level change:hit_points change:fatigue_points",function(a){updateEnhancedMove()});
function updateEnhancedMove(){console.log("***** UPDATE ENHANCED MOVE *****");getAttrs("enhanced_ground_move_mod enhanced_ground_move_points basic_move encumbrance_level hit_points hit_points_max fatigue_points fatigue_points_max".split(" "),function(a){var d=+a.enhanced_ground_move_mod,b=+a.enhanced_ground_move_points,e=+a.basic_move,g=0,k=0,m=0,c=0;0>d&&(d=0);d=Math.ceil(2*d)/2;0>b&&(b=0);b=10*Math.ceil(b/10);var n=d+b/20;var l=getEnhancedValue(e,n);0<n?(encumberedDisplayMove0=e+"/"+l,move1=getEncumberedMove(e,
1),g=getEncumberedMove(l,1),encumberedDisplayMove1=move1+"/"+g,move2=getEncumberedMove(e,2),k=getEncumberedMove(l,2),encumberedDisplayMove2=move2+"/"+k,move3=getEncumberedMove(e,3),m=getEncumberedMove(l,3),encumberedDisplayMove3=move3+"/"+m,move4=getEncumberedMove(e,4),c=getEncumberedMove(l,4),encumberedDisplayMove4=move4+"/"+c):(encumberedDisplayMove0=e,encumberedDisplayMove1=getEncumberedMove(e,1),encumberedDisplayMove2=getEncumberedMove(e,2),encumberedDisplayMove3=getEncumberedMove(e,3),encumberedDisplayMove4=
getEncumberedMove(e,4));var h=getInjuryFatigueModifier(a.hit_points,a.hit_points_max,a.fatigue_points,a.fatigue_points_max);switch(a.encumbrance_level){case 0:a=Math.floor(+e*h)+"/"+Math.floor(+l*h);break;case 1:a=Math.floor(+move1*h)+"/"+Math.floor(+g*h);break;case 2:a=Math.floor(+move2*h)+"/"+Math.floor(+k*h);break;case 3:a=Math.floor(+move3*h)+"/"+Math.floor(+m*h);break;default:a=Math.floor(+move4*h)+"/"+Math.floor(+c*h)}setAttrs({enhanced_ground_move_mod:d,enhanced_ground_move_points:b,enhanced_ground_move_multiple:n,
enhanced_ground_move:l,move_0:encumberedDisplayMove0,move_1:encumberedDisplayMove1,move_2:encumberedDisplayMove2,move_3:encumberedDisplayMove3,move_4:encumberedDisplayMove4,move_5:"",move_current:a})})}function getEncumberedMove(a,d){1>d?d=1:4<d&&(d=4);var b=Math.floor(Math.round(100*(1-2*d/10))/100*a);0>=b&&(b=1);return b}function getEnhancedValue(a,d){if(0==d)var b=0;else 0==d%1?b=a*Math.pow(2,d):(b=a*Math.pow(2,Math.floor(d))*1.5,b=Math.floor(b));return b}
function getInjuryFatigueModifier(a,d,b,e){var g=1;+a<+d/3&&(g/=2);+b<+e/3&&(g/=2);return g}on("change:flight_checked change:basic_speed change:basic_air_move_points change:basic_air_move_mod change:enhanced_air_level change:enhanced_air_move_points change:encumbrance_level change:hit_points change:fatigue_points",function(a){updateFlightValues()});
function updateFlightValues(){console.log("***** UPDATE FLIGHT VALUES *****");getAttrs("flight_checked basic_speed enhanced_air_level basic_air_move basic_air_move_mod basic_air_move_points enhanced_air_level enhanced_air_move_points encumbrance_level hit_points hit_points_max fatigue_points fatigue_points_max".split(" "),function(a){var d=+a.basic_air_move_points;0>d&&(d=0);var b=+a.basic_air_move_mod;0>b&&(b=0);var e=0,g=+a.enhanced_air_level;0>g&&(g=0);var k=+a.enhanced_air_move_points;0>k&&(k=
0);var m=0;if(1==a.flight_checked){e=Math.floor(2*+a.basic_speed);var c=Math.floor(2*+a.basic_speed)||0;d=2*Math.ceil(d/2);c=c+b+d/2;k=10*Math.ceil(k/10);g=Math.ceil(2*g)/2;m=g+k/20;b=getEnhancedValue(c,m);if(0<b){g=c+"/"+b;var n=getEncumberedMove(c,1)+"/"+getEncumberedMove(b,1);var l=getEncumberedMove(c,2)+"/"+getEncumberedMove(b,2);var h=getEncumberedMove(c,3)+"/"+getEncumberedMove(b,3);var p=getEncumberedMove(c,4)+"/"+getEncumberedMove(b,4)}else g=c,n=getEncumberedMove(c,1),l=getEncumberedMove(c,
2),h=getEncumberedMove(c,3),p=getEncumberedMove(c,4);var f=getInjuryFatigueModifier(a.hit_points,a.hit_points_max,a.fatigue_points,a.fatigue_points_max);switch(a.encumbrance_level){case 0:a=c*f;0<b&&(a=a+"/"+b*f);break;case 1:a=getEncumberedMove(c,1)*f;0<b&&(a=a+"/"+getEncumberedMove(b,1)*f);break;case 2:a=getEncumberedMove(c,2)*f;0<b&&(a=a+"/"+getEncumberedMove(b,2)*f);break;case 3:a=getEncumberedMove(c,3)*f;0<b&&(a=a+"/"+getEncumberedMove(b,3)*f);break;default:a=getEncumberedMove(c,4)*f,0<b&&(a=
a+"/"+getEncumberedMove(b,4)*f)}}else p=h=l=n=g=a=b=c=0;setAttrs({basic_air_move:c,basic_air_move_unmodified:e,enhanced_air_move:b,enhanced_air_move_level:m,basic_air_move_points:d,enhanced_air_move_points:k,air_0:g,air_1:n,air_2:l,air_3:h,air_4:p,current_air:a})})}
on("change:amphibious_checked change:basic_move change:basic_water_move_points change:basic_water_move_mod change:enhanced_water_level change:enhanced_water_move_points change:encumbrance_level change:hit_points change:fatigue_points",function(a){updateWaterMoveValues()});
function updateWaterMoveValues(){console.log("***** UPDATE WATER MOVE VALUES *****");getAttrs("amphibious_checked basic_move enhanced_water_level basic_water_move basic_water_move_mod basic_water_move_points enhanced_water_level enhanced_water_move_points encumbrance_level hit_points hit_points_max fatigue_points fatigue_points_max".split(" "),function(a){var d=+a.basic_water_move_points;0>d&&(d=0);var b=+a.basic_water_move_mod;0>b&&(b=0);var e=+a.enhanced_water_level;0>e&&(e=0);var g=+a.enhanced_water_move_points;
0>g&&(g=0);var k=0;if(1==a.amphibious_checked&&(0<g||0<e)){var m=+a.basic_move;var c=1==a.amphibious_checked?+a.basic_move:+a.basic_move/5;d=5*Math.ceil(d/5);c=Math.floor(c+b+d/5);0>=c&&(c=1);g=10*Math.ceil(g/10);e=Math.ceil(2*e)/2;k=e+g/20;b=getEnhancedValue(c,k);e=c+"/"+b;var n=getEncumberedMove(c,1)+"/"+getEncumberedMove(b,1);var l=getEncumberedMove(c,2)+"/"+getEncumberedMove(b,2);var h=getEncumberedMove(c,3)+"/"+getEncumberedMove(b,3);var p=getEncumberedMove(c,4)+"/"+getEncumberedMove(b,4);var f=
getInjuryFatigueModifier(a.hit_points,a.hit_points_max,a.fatigue_points,a.fatigue_points_max);switch(a.encumbrance_level){case 0:a=c*f+"/"+b*f;break;case 1:a=getEncumberedMove(c,1)*f+"/"+getEncumberedMove(b,1)*f;break;case 2:a=getEncumberedMove(c,2)*f+"/"+getEncumberedMove(b,2)*f;break;case 3:a=getEncumberedMove(c,3)*f+"/"+getEncumberedMove(b,3)*f;break;default:a=getEncumberedMove(c,4)*f+"/"+getEncumberedMove(b,4)*f}}else switch(m=+a.basic_move,c=1==a.amphibious_checked?+a.basic_move:+a.basic_move/
5,c=Math.floor(c+b),0>=c&&(c=1),d=5*Math.ceil(d/5),c+=d/5,b=0,e=c,n=getEncumberedMove(c,1),l=getEncumberedMove(c,2),h=getEncumberedMove(c,3),p=getEncumberedMove(c,4),f=getInjuryFatigueModifier(a.hit_points,a.hit_points_max,a.fatigue_points,a.fatigue_points_max),a.encumbrance_level){case 0:a=c*f;break;case 1:a=getEncumberedMove(c,1)*f;break;case 2:a=getEncumberedMove(c,2)*f;break;case 3:a=getEncumberedMove(c,3)*f;break;default:a=getEncumberedMove(c,4)*f}setAttrs({basic_water_move:c,basic_water_move_unmodified:m,
enhanced_water_move:b,enhanced_water_move_level:k,basic_water_move_points:d,enhanced_water_move_points:g,water_0:e,water_1:n,water_2:l,water_3:h,water_4:p,current_water:a})})};
    
   // check for changes that affect jump distance
    on("change:use_st_for_jump change:jump_skill change:basic_move change:enhanced_ground_move change:super_jump_entered_level change:super_jump_points change:jump_encumbrance change:encumbrance_level change:jump_concentration change:running_jump_yards_moved change:running_high_jump_yards_moved change:strength change:encumbrance_level change:hit_points change:fatigue_points", function(e) {
        
        updateJumpDistanceValues();
        
    });
    
    /**
     * Update jump distance values
     */
    function updateJumpDistanceValues() {
        
        console.log('***** UPDATE JUMP VALUES *****');
		    
        getAttrs(["use_st_for_jump", "jump_skill", "basic_move", "enhanced_ground_move", "super_jump_entered_level", 
                  "super_jump_points", "strength", "jump_concentration", "running_jump_yards_moved", "running_high_jump_yards_moved", 
                  "encumbrance_level", "hit_points", "hit_points_max", "fatigue_points", "fatigue_points_max", "jump_encumbrance", "encumbrance_level"], function(values) {
            
            var jumpSkill = +values.jump_skill;
            
            if (jumpSkill < 0) {
                jumpSkill = 0;
            }
            
            var jumpST = +values.strength;
            
            if (jumpST < 0) {
                jumpST = 0;
            }
            
            // + sign converts value to a number
            var superJumpPoints = +values.super_jump_points;
            
            // ensure valid superJumpPoints
            if (superJumpPoints < 0) {
                superJumpPoints = 0;
            }
            
            var superJumpEnteredLevel = +values.super_jump_entered_level;
            
            if (superJumpEnteredLevel < 0) {
                superJumpEnteredLevel = 0;
            }
            
            var basicMove = +values.basic_move;
            
            // ensure valid basicWaterMoveMod
            if (basicMove < 0) {
                basicMove = 0;    
            }
            
            // check for super move
            var enhancedGroundMove = +values.enhanced_ground_move;
            
            if (enhancedGroundMove < 0) {
                enhancedGroundMove = 0;
            }
            
            // check for running jump
            var runningJumpYardsMoved = +values.running_jump_yards_moved;
            
            runningJumpYardsMoved = Math.floor(runningJumpYardsMoved);
            
            var runningHighJumpYardsMoved = +values.running_high_jump_yards_moved;
            
            runningHighJumpYardsMoved = Math.floor(runningHighJumpYardsMoved);
            
            var runningMoveToUse = 0;
            
            var runningHighMoveToUse = 0;
            
            var jumpBroadFeet = 0;
            
            var jumpBroadYards = 0;
            
            var runningBroadJumpFeet = 0;
            
            var runningBroadJumpYards = 0;
            
            var jumpHighFeet = 0;
            
            var jumpHighYards = 0;
            
            var runningHighJumpFeet = 0;
            
            var runningHighJumpYards = 0;
            
            var superJumpLevelFromPoints = 0;
            
            var totalSuperJumpLevel = 0;
            
            var encumberedDisplayMove0 = "";
            
            var encumberedDisplayMove1 = "";
            
            var encumberedDisplayMove2 = "";
            
            var encumberedDisplayMove3 = "";
            
            var encumberedDisplayMove4 = "";
            
            var encumberedDisplayMove5 = "";
            
            var totalSuperJumpLevel = 0;
            
            var injuryFatigueMoveModifier = 1;
            
            var jumpMoveSpeed = 0;
            
            var finalJumpMoveSpeed = 0;
            
            var statUsedForJump = "";
            
            var statUsedForRunningJump = "";
            
            var baseJumpMove = "";
            
            // calculate broad and high jump
            if (jumpSkill > 0) {
                
                // -------------
                // USE JUMP SKILL
                baseJumpMove = Math.floor(jumpSkill/2);
                
                // calc. standing broad jump
                jumpBroadFeet = baseJumpMove;
                
                if (jumpBroadFeet <= 0) {
                    jumpBroadFeet = 1;
                }
                
                statUsedForJump = "Jump Skill/2 = " + jumpBroadFeet;
                
                jumpBroadFeet = (jumpBroadFeet * 2) - 3;
                
                if (jumpBroadFeet <= 0) {
                    jumpBroadFeet = 1;
                }
                
                // calc. running broad jump
                if (enhancedGroundMove > Math.floor(jumpSkill/2)) {
                    
                    // use enhanced move instead of jump skill
                    statUsedForRunningJump = "Basic Move * (2 ^ Enh MV Mod)";
                    
                    runningMoveToUse = enhancedGroundMove;
                    
                    runningHighMoveToUse = enhancedGroundMove;
                    
                } else {
                    
                    // use jump skill for running jump
                    statUsedForRunningJump = statUsedForJump + " + Yards Run";
                    
                    runningMoveToUse = Math.floor(jumpSkill/2) + runningJumpYardsMoved;
                    
                    runningHighMoveToUse = Math.floor(jumpSkill/2) + runningHighJumpYardsMoved;
                    
                }
                
                runningBroadJumpFeet = (runningMoveToUse * 2) - 3;
                
                if (runningBroadJumpFeet <= 0) {
                    
                    runningBroadJumpFeet = 1;
                    
                }
                
                // calc. standing high jump
                jumpHighFeet = Math.floor(jumpSkill/2);
                
                if (jumpHighFeet <= 0) {
                    jumpHighFeet = 1;
                }
                
                jumpHighFeet = (6 * jumpHighFeet) - 10;
                
                if (jumpHighFeet <= 0) {
                    jumpHighFeet = 1;
                }
                
                // convert to feet
                // round to 2 decimals
                // https://stackoverflow.com/questions/11832914/round-to-at-most-2-decimal-places-only-if-necessary
                jumpHighFeet = Math.round( (jumpHighFeet / 12) * 100) / 100;
                
                if (jumpHighFeet <= 0) {
                    jumpHighFeet = 1;
                }
                
                // calc. running high jump
                runningHighJumpFeet = (6 * runningHighMoveToUse) - 10;
                
                if (runningHighJumpFeet <= 0) {
                    runningHighJumpFeet = 1;
                }
                
                // convert to feet
                runningHighJumpFeet = Math.floor(runningHighJumpFeet / 12);
                
                if (runningHighJumpFeet <= 0) {
                    
                    runningHighJumpFeet = 1;
                    
                } else if (runningHighJumpFeet > jumpHighFeet * 2) {
                    
                    // can't be greater than twice standing broad jump
                    runningHighJumpFeet = jumpHighFeet * 2;
                    
                }
                
            } else if (values.use_st_for_jump == "1") {
                
                //-------------------------------
                // USE Strength to determine jump
                baseJumpMove = Math.floor(jumpST/4);
                
                // calc. standing broad jump
                jumpBroadFeet = baseJumpMove;
                
                if (jumpBroadFeet <= 0) {
                    jumpBroadFeet = 1;
                }
                
                statUsedForJump = "ST / 4 = " + jumpBroadFeet;
                
                jumpBroadFeet = (jumpBroadFeet * 2) - 3;
                
                if (jumpBroadFeet <= 0) {
                    jumpBroadFeet = 1;
                }
                
                // calc. running broad jump
                if (enhancedGroundMove > Math.floor(jumpST/4)) {
                    
                    // use enhanced move instead of strength
                    statUsedForRunningJump = "Basic Move * (2 ^ Enh MV Mod)";
                    
                    runningMoveToUse = enhancedGroundMove;
                    
                    runningHighMoveToUse = enhancedGroundMove;
                    
                } else {
                    
                    statUsedForRunningJump = statUsedForJump + " + Yards Run";
                    
                    runningMoveToUse = Math.floor(jumpST/4) + runningJumpYardsMoved;
                    
                    runningHighMoveToUse = Math.floor(jumpST/2) + runningHighJumpYardsMoved;
                }
                
                runningBroadJumpFeet = (runningMoveToUse * 2) - 3;
                
                if (runningBroadJumpFeet <= 0) {
                    
                    runningBroadJumpFeet = 1;
                    
                }
                
                // calc. standing high jump
                jumpHighFeet = Math.floor(jumpST/4);
                
                if (jumpHighFeet <= 0) {
                    jumpHighFeet = 1;
                }
                
                jumpHighFeet = (6 * jumpHighFeet) - 10;
                
                if (jumpHighFeet <= 0) {
                    jumpHighFeet = 1;
                }
                
                // convert to feet
                // round to 2 decimals
                // https://stackoverflow.com/questions/11832914/round-to-at-most-2-decimal-places-only-if-necessary
                jumpHighFeet = Math.round( (jumpHighFeet / 12) * 100) / 100;
                
                if (jumpHighFeet <= 0) {
                    jumpHighFeet = 1;
                }
                
                // calc. running high jump
                runningHighJumpFeet = (6 * runningHighMoveToUse) - 10;
                
                if (runningHighJumpFeet <= 0) {
                    runningHighJumpFeet = 1;
                }
                
                // convert to feet
                runningHighJumpFeet = Math.floor(runningHighJumpFeet / 12);
                
                if (runningHighJumpFeet <= 0) {
                
                    runningHighJumpFeet = 1;
                    
                } else if (runningHighJumpFeet > jumpHighFeet * 2) {
                    
                    // can't be greater than twice standing broad jump
                    runningHighJumpFeet = jumpHighFeet * 2;
                    
                }
                
            } else {
                
                //---------------
                // USE Basic Move
                baseJumpMove = basicMove;
                
                statUsedForJump = "Basic Move = " + basicMove;
                
                // calc. standing broad jump
                jumpBroadFeet = (basicMove * 2) - 3;
                
                if (jumpBroadFeet <= 0) {
                    jumpBroadFeet = 1;
                }
                
                // calc. running broad jump
                if (enhancedGroundMove > basicMove) {
                    
                    // use enhanced move instead of strength
                    statUsedForRunningJump = "Basic Move * (2 ^ Enh MV Mod)";
                    
                    runningMoveToUse = enhancedGroundMove;
                    
                    runningHighMoveToUse = enhancedGroundMove;
                    
                } else {
                    
                    statUsedForRunningJump = statUsedForJump + " + Yards Run";
                    
                    runningMoveToUse = basicMove + runningJumpYardsMoved;
                    
                    runningHighMoveToUse = basicMove + runningHighJumpYardsMoved;
                    
                }
                
                runningBroadJumpFeet = (runningMoveToUse * 2) - 3;
                
                if (runningBroadJumpFeet <= 0) {
                
                    runningBroadJumpFeet = 1;
                    
                } else if (runningBroadJumpFeet > jumpBroadFeet * 2) {
                    
                    // can't be greater than twice standing broad jump
                    runningBroadJumpFeet = jumpBroadFeet * 2;
                    
                }
                
                // calc. high jump
                jumpHighFeet = (6 * basicMove) - 10;
                
                if (jumpHighFeet <= 0) {
                    jumpHighFeet = 1;
                }
                
                // convert to feet
                // round to 2 decimals
                // https://stackoverflow.com/questions/11832914/round-to-at-most-2-decimal-places-only-if-necessary
                jumpHighFeet = Math.round( (jumpHighFeet / 12) * 100) / 100;
                
                if (jumpHighFeet <= 0) {
                    jumpHighFeet = 1;
                }
                
                // calc. running high jump
                runningHighJumpFeet = (6 * runningHighMoveToUse) - 10;
                
                if (runningHighJumpFeet <= 0) {
                    runningHighJumpFeet = 1;
                }
                
                // convert to feet
                runningHighJumpFeet = Math.floor(runningHighJumpFeet / 12);
                
                if (runningHighJumpFeet <= 0) {
                    
                    runningHighJumpFeet = 1;
                    
                } else if (runningHighJumpFeet > jumpHighFeet * 2) {
                    
                    // can't be greater than twice standing broad jump
                    runningHighJumpFeet = jumpHighFeet * 2;
                    
                }
                
            }
            
            // If no concentration, divide distance by 2
            if (values.jump_concentration != "1") {
                
                jumpBroadFeet = Math.floor(jumpBroadFeet / 2);
                
                if (jumpBroadFeet <= 0) {
                    jumpBroadFeet = 1;
                }
                
                runningBroadJumpFeet = Math.floor(runningBroadJumpFeet / 2);    
                
                if (runningBroadJumpFeet <= 0 ) {
                    runningBroadJumpFeet = 1;
                }
                
                // reduce in half
                // round to 2 decimals
                // https://stackoverflow.com/questions/11832914/round-to-at-most-2-decimal-places-only-if-necessary
                jumpHighFeet = Math.round( (jumpHighFeet / 2) * 100) / 100;
                
                if (jumpHighFeet <= 0) {
                    jumpHighFeet = 1;
                }
                
                runningHighJumpFeet = Math.floor(runningHighJumpFeet / 2);
                
                if (runningHighJumpFeet <= 0) {
                    
                    runningHighJumpFeet = 1;
                }
                
            }
            
            // check for super jump
            if (superJumpPoints > 0 || superJumpEnteredLevel > 0) {
                
                //-----------------
                // calculate super jump
                // make sure points is multiple of 10
                // https://stackoverflow.com/questions/18953384/javascript-round-up-to-the-next-multiple-of-5 
                superJumpPoints = Math.ceil(superJumpPoints / 10) * 10;
                
                superJumpLevelFromPoints = superJumpPoints / 10;
                
                // -------
                // make sure entered super jump level is an integer, min of 1
                superJumpEnteredLevel = Math.floor(superJumpEnteredLevel);
                
                if (superJumpEnteredLevel < 0) {
                    superJumpEnteredLevel = 0;
                }
                
                totalSuperJumpLevel = superJumpEnteredLevel + superJumpLevelFromPoints;
                
                // get the new jump feet values based on super level
                jumpBroadFeet = getEnhancedValue(jumpBroadFeet, totalSuperJumpLevel);
                
                runningBroadJumpFeet = getEnhancedValue(runningBroadJumpFeet, totalSuperJumpLevel);
                
                jumpHighFeet = getEnhancedValue(jumpHighFeet, totalSuperJumpLevel);
                
                runningHighJumpFeet = getEnhancedValue(runningHighJumpFeet, totalSuperJumpLevel);
                
            }
            
            // check for encumbrance
            if (+values.jump_encumbrance === 1) {
                
                switch(+values.encumbrance_level) {
                    
                    default:
                    case 0:
                        // do nothing
                        break;
                        
                    case 1:
                        // Light
                        jumpBroadFeet = Math.round( (jumpBroadFeet * .8) * 100) / 100;
                        
                        runningBroadJumpFeet = Math.round( (runningBroadJumpFeet * .8) * 100) / 100;
                        
                        jumpHighFeet = Math.round( (jumpHighFeet * .8) * 100) / 100;
                    
                        runningHighJumpFeet = Math.round( (runningHighJumpFeet * .8) * 100) / 100;
                        
                        break;
                        
                    case 2:
                        // Medium
                        jumpBroadFeet = Math.round( (jumpBroadFeet * .6) * 100) / 100;
                        
                        runningBroadJumpFeet = Math.round( (runningBroadJumpFeet * .6) * 100) / 100;
                        
                        jumpHighFeet = Math.round( (jumpHighFeet * .6) * 100) / 100;
                    
                        runningHighJumpFeet = Math.round( (runningHighJumpFeet * .6) * 100) / 100;
                        
                        break;
                        
                    case 3:
                        // Heavy
                        jumpBroadFeet = Math.round( (jumpBroadFeet * .4) * 100) / 100;
                        
                        runningBroadJumpFeet = Math.round( (runningBroadJumpFeet * .4) * 100) / 100;
                        
                        jumpHighFeet = Math.round( (jumpHighFeet * .4) * 100) / 100;
                    
                        runningHighJumpFeet = Math.round( (runningHighJumpFeet * .4) * 100) / 100;
                        
                        break;
                        
                    case 4:
                        // Extra-Heavy
                        jumpBroadFeet = Math.round( (jumpBroadFeet * .2) * 100) / 100;
                        
                        runningBroadJumpFeet = Math.round( (runningBroadJumpFeet * .2) * 100) / 100;
                        
                        jumpHighFeet = Math.round( (jumpHighFeet * .2) * 100) / 100;
                    
                        runningHighJumpFeet = Math.round( (runningHighJumpFeet * .2) * 100) / 100;
                        
                        break;
                        
                }
                
            }
            
            // get broad jump in yards. Minimum of 1
            jumpBroadYards = Math.round( (jumpBroadFeet / 3) * 100) / 100;
            
            // get running jump in yards. Min of 1
            runningBroadJumpYards = Math.round( (runningBroadJumpFeet / 3) * 100) / 100;
            
            // get high jump in yards
            jumpHighYards = Math.round( (jumpHighFeet / 3) * 100) / 100;
            
            // get running high in yards
            runningHighJumpYards = Math.round( (runningHighJumpFeet / 3) * 100) / 100;
            
            // calculate jump move speed
            jumpMoveSpeed = Math.floor(jumpBroadYards / 5);
            
            if (jumpMoveSpeed <= 0) {
                jumpMoveSpeed = 1;
            }
            
            // determine which one to use
            if (jumpMoveSpeed > basicMove) {
                
                finalJumpMoveSpeed = jumpMoveSpeed;
                
            } else {
                
                finalJumpMoveSpeed = basicMove;
                
            }
            
            // set jump distances
            setAttrs({
                "broad_jump_distance_feet": jumpBroadFeet, 
                "broad_jump_distance_yards": jumpBroadYards, 
                "high_jump_distance_feet": jumpHighFeet,
                "high_jump_distance_yards": jumpHighYards,
                "super_jump_level": totalSuperJumpLevel,
                "super_jump_entered_level": superJumpEnteredLevel,
                "super_jump_points": superJumpPoints,
                "running_jump_distance_feet": runningBroadJumpFeet,
                "running_jump_distance_yards": runningBroadJumpYards,
                "running_high_jump_distance_feet": runningHighJumpFeet,
                "running_high_jump_distance_yards": runningHighJumpYards,
                "broad_jump_base": baseJumpMove,
                "standing_broad_jump_stat_to_use": statUsedForJump,
                "running_broad_jump_stat_to_use": statUsedForRunningJump,
                "high_jump_base": baseJumpMove,
                "standing_high_jump_stat_to_use": statUsedForJump,
                "running_high_jump_stat_to_use": statUsedForRunningJump,
                "jump_move_speed": finalJumpMoveSpeed
            });
            
        });
        
    }

// <!-- ==== ==== ==== Combat Calculations ==== ==== ==== -->
// ================= CONDITIONS =========================

	var conditions = [ "Stunned", "Shock", "Mentally Stunned", "Surprised", "Bleeding", "Reeling", "Mortally Wounded", "Tired", "Coughing", "Drowsy", "Drunk", "Euphoria", "Nauseated", "Moderate Pain", "Severe Pain", "Terrible Pain", "Typsy", "Agony", "Choking", "Dazed", "Ecstasy", "Hallucinating", "Paralyzed", "Retching", "Seizure", "Unconscious", "Coma", "Heart Attack" ];
	var condition_attrs = conditions.map( c => c.toLowerCase().replace(' ', '_'));
	on(`change:${condition_attrs.join(' change:')} sheet:opened`, function () {
		console.log("===============================");
		console.log("****!!!Update-Conditions!!!*****");
		getAttrs(condition_attrs, function (values) {
			var conditionNames = []; //We'll collect all the condition names in here.
						
			console.log(` cond count: ${conditionNames.length}`);
			for (var i = 0; i < condition_attrs.length; i++) {
				console.log(`  cond idlen:${i}`); // changed this to show the current row
				console.log(`     cond id:|${condition_attrs[i]}|`);

				// need to test the checkbox value
				if(values[condition_attrs[i]] != 0) {
					conditionNames.push(conditions[i]); //push the attribute name into the collection array
				}
			}
			var output = conditionNames.join(", ");
			setAttrs({
				current_conditions: output
			});
		});
	});

	//Update Temporary Attribute Penalties
	on('sheet:opened change:current_conditions change:hipain change:lopain', function () {
	  console.log('**** Update Temporary Attribute Penalties *****');
			getAttrs(["stunned", "shock", "mentally_stunned", "surprised", "coughing", "drowsy", "drunk", "euphoria", "nauseated", "moderate_pain", "severe_pain", "terrible_pain", "hipain", "lopain", "tipsy", "agony", "choking", "dazed", "ecstasy", "hallucinating", "paralyzed", "retching", "seizure", "unconscious", "coma", "heart_attack" ], function (v) {
				// Irritating Conditions B428
				var stun = +v.stunned * -4;
				var shock = +v.shock * -1;
				var mstun = +v.mentally_stunned * -4;
				var sup = +v.surprised * -4
				var dcough = +v.coughing * -3; var icough = +v.coughing * -1;
				var drowsy = +v.drowsy * -2;
				var drunk = +v.drunk * -2; var drunkSC = +v.drunk * -4;
				var euph = +v.euphoria * -3;
				var naus = +v.nauseated * -2; var nausAD = +v.nauseated * -1;
				var hip = +v.hipain;
				var lop = +v.lopain;
				if (hip == 2 && lop == 0) {
					mpain = (+v.moderate_pain) / hip;
					spain = (+v.severe_pain) /  hip;
					tpain = (+v.terrible_pain) /  hip;
				} else if (lop == 2 && hip == 0) {
					mpain = (+v.moderate_pain) * lop;
					spain = (+v.severe_pain) * lop;
					tpain = (+v.terrible_pain) * lop;
				} else if (lop == 0 && hip == 0 || lop == 2 && hip == 2) {
					mpain = +v.moderate_pain;
					spain = +v.severe_pain;
					tpain = +v.terrible_pain;
				}
				var tipsy = +v.tipsy * -1; var tipsySC = +v.tipsy * -2;
				
				// Incapacitating Conditions B428
				var agony = +v.agony * -99; var agonyStun = +v.agony * -4;
				var choking = +v.choking * -99; var chokingStun = +v.choking * -4;
				var dazed = +v.dazed * -99; var dazedStun = +v.dazed * -4;
				var ecstasy = +v.ecstasy * -99; var ecstasyStun = +v.ecstasy * -4;
				var hall = +v.hallucinating * -99; var hStun = +v.hallucinating * -4;
				var par = +v.paralyzed * -99;
				var retch = +v.retching * -5; var rStun = +v.retching * -4;
				var seiz = +v.seizure * -99; var seizStun = +v.seizure * -4;
				var uncon = +v.unconscious * -99;
				var coma = +v.coma * -99;
				var hAtk = +v.heart_attack * -99;
				
				// Build penalty arrays
				var penaltyAD = [stun, mstun, sup, nausAD, agonyStun, chokingStun, dazedStun, ecstasyStun, hStun, par, rStun, seizStun, uncon, coma, hAtk ];
					penaltyAD.push(0);
				var penaltyST = [];
					penaltyST.push(0);
				var penaltyDX = [shock, dcough, drowsy, drunk, tipsy];
					penaltyDX.push(0);
				var penaltyIQ = [shock, icough, drowsy, drunk, tipsy];
					penaltyIQ.push(0);
				var penaltyHT = [];
					penaltyHT.push(0);
				var penaltySCRoll = [drowsy, drunkSC, euph, mpain, spain, tpain, tipsySC];
					penaltySCRoll.push(0);
				var penaltySTRoll = [naus, agony, choking, dazed, ecstasy, , hall, par, retch, uncon, coma, hAtk];
					penaltySTRoll.push(0);
				var penaltyDXRoll = [euph, naus, mpain, spain, tpain, agony, choking, dazed, ecstasy, , hall, par, retch, uncon, coma, hAtk];
					penaltyDXRoll.push(0);
				var penaltyIQRoll = [euph, naus, mpain, spain, tpain, agony, choking, dazed, ecstasy, , hall, par, retch, uncon, coma, hAtk];
					penaltyIQRoll.push(0);
				var penaltyHTRoll = [naus, agony, choking, dazed, ecstasy, , hall, par, retch, uncon, coma, hAtk];
					penaltyHTRoll.push(0);
				var penaltySkillRoll = [euph, naus, mpain, spain, tpain, agony, choking, dazed, ecstasy, , hall, par, retch, uncon, coma, hAtk];
					penaltySkillRoll.push(0);

					setAttrs({
					cond_AD_mod: penaltyAD.reduce(getSum),
					cond_ST_mod: penaltyST.reduce(getSum),
					cond_DX_mod: penaltyDX.reduce(getSum),
					cond_IQ_mod: penaltyIQ.reduce(getSum),
					cond_HT_mod: penaltyHT.reduce(getSum),
					cond_SC_mod: penaltySCRoll.reduce(getSum),
					STRoll_mod: penaltySTRoll.reduce(getSum),
					DXRoll_mod: penaltyDXRoll.reduce(getSum),
					IQRoll_mod: penaltyIQRoll.reduce(getSum),
					HTRoll_mod: penaltyHTRoll.reduce(getSum),
					skillRoll_mod: penaltySkillRoll.reduce(getSum),
				});
			});
		});

// ================ MANUEVERS ======================
	// Manuever Generator
	on("sheet:opened change:manuever", function() {
	    getAttrs(["manuever"], function(values) {
	        const manuevers = {
	            Aim: {
	                name: "Aim",
	                AD: "Any*",
	                move: "Step | None",
	                descr: "Description: Aim a ranged weapon to get its Acc bonus (+1 for bracing, +1 for 2 turns, +2 for 3+ turns, the combined bonus from all targeting systems cannot exceed the weapon’s base Accuracy) | You get no step if your two-handed weapon is braced. Check Aiming box to add aiming bonus to total attack modifiers",
	                page: "B363",
	                block: 0,
	                dodge: 0,
	                parry: 0,
	                meleemod: 0,
	                rangedmod: 0,
	                note: "Note: * Taking an active defense spoils your Aim; if you are injured, make a Will roll or lose your Aim."
	            },
	            AoAMDD: {
	                name: "All-Out Attack - Melee Double",
	                AD: "None",
	                move: "1/2 forward",
	                descr: "2 attacks on same foe with ready weapon (-4 to off-hand without Ambidexterity)",
	                page: "B363",
	                block: -99,
	                dodge: -99,
	                parry: -99,
	                meleemod: 0,
	                rangedmod: 0,
	                note: ""
	            },
	            AoAMDT: {
	                name: "All-Out Attack - Melee Determined",
	                AD: "None",
	                move: "1/2 forward",
	                descr: "+4 to hit",
	                page: "B363",
	                block: -99,
	                dodge: -99,
	                parry: -99,
	                meleemod: 4,
	                rangedmod: 0,
	                note: ""
	            },
	            AoAMF: {
	                name: "All-Out Attack - Melee Feint",
	                AD: "None",
	                move: "1/2 forward",
	                descr: "Make one feint and one attack on the same foe",
	                page: "B363",
	                block: -99,
	                dodge: -99,
	                parry: -99,
	                meleemod: 0,
	                rangedmod: 0,
	                note: ""
	            },
	            AoAML: {
	                name: "All-Out Attack - Melee Long",
	                AD: "None",
	                move: "1/2 forward",
	                descr: "Increase reach by 1 yard (Swing attacks at -2 dmg or -1 per die), may end in crouch.",
	                page: "MA87",
	                block: -99,
	                dodge: -99,
	                parry: -99,
	                meleemod: 0,
	                rangedmod: 0,
	                note: ""
	            },
	            AoAMS: {
	                name: "All-Out Attack - Melee Strong",
	                AD: "None",
	                move: "1/2 forward",
	                descr: "+2 to damage (or +1 per damage die)",
	                page: "B363",
	                block: -99,
	                dodge: -99,
	                parry: -99,
	                meleemod: 0,
	                rangedmod: 0,
	                note: ""
	            },
	            AoARD: {
	                name: "All-Out Attack - Ranged Determined",
	                AD: "None",
	                move: "1/2 forward",
	                descr: "+1 to hit",
	                page: "B363",
	                block: -99,
	                dodge: -99,
	                parry: -99,
	                meleemod: 0,
	                rangedmod: 1,
	                note: ""
	            },
	            AoARS: {
	                name: "All-Out Attack - Ranged Suppression Fire",
	                AD: "None",
	                move: "1/2 forward",
	                descr: "RoF 5+ targets 2 yard zone - RoF 10+ suppress multiple, adjacent 2 yard zones with 5+ Shots/zone",
	                page: "B363",
	                block: -99,
	                dodge: -99,
	                parry: -99,
	                meleemod: 0,
	                rangedmod: 0,
	                note: ""
	            },
	            AoDID: {
	                name: "All-Out Defense Increased Defense",
	                AD: "Any",
	                move: "Step (1/2)",
	                descr: "+2 to one Active Defense until next turn (Increased Dodge allows up to Half Move)",
	                page: "B363",
	                block: 2,
	                dodge: 2,
	                parry: 2,
	                meleemod: 0,
	                rangedmod: 0,
	                note: ""
	            },
	            AoDDD: {
	                name: "All-Out Defense Double Defense",
	                AD: "Any",
	                move: "Step",
	                descr: "Two different Defenses against one attack",
	                page: "B363",
	                block: 0,
	                dodge: 0,
	                parry: 0,
	                meleemod: 0,
	                rangedmod: 0,
	                note: ""
	            },
	            AoDMD: {
	                name: "All-Out Defense Mental Defense",
	                AD: "Any",
	                move: "Step (1/2)",
	                descr: "+2 to one Active Defense until next turn (Increased Dodge allows up to Half Move)",
	                page: "B363",
	                block: 2,
	                dodge: 2,
	                parry: 2,
	                meleemod: 0,
	                rangedmod: 0,
	                note: ""
	            },
	            Atk: {
	                name: "Attack",
	                AD: "Any",
	                move: "Step",
	                descr: "Attack unarmed or with a ready weapon, you make take a step before or after you attack",
	                page: "B363",
	                block: 0,
	                dodge: 0,
	                parry: 0,
	                meleemod: 0,
	                rangedmod: 0,
	                note: ""
	            },
	            CP: {
	                name: "Change Posture",
	                AD: "Any",
	                move: "None",
	                descr: "Standing, sitting, kneeling, crawling, prone, lying face up (see B364/MA98). Prone to standing takes two turns (Exception Acrobatic Stand)",
	                page: "B363",
	                block: 0,
	                dodge: 0,
	                parry: 0,
	                meleemod: 0,
	                rangedmod: 0,
	                note: ""
	            },
	            Conc: {
	                name: "Concentrate",
	                AD: "Any †",
	                move: "Step",
	                descr: "Focus on mental task. All-Out Concentrate (DF14:34) gives +1 to roll but loose active defenses. Must make Will-2 if injured or distracted",
	                page: "B366",
	                block: 0,
	                dodge: 0,
	                parry: 0,
	                meleemod: 0,
	                rangedmod: 0,
	                note: "† Taking an active defense or being knocked down, injured, distracted etc. requires a Will-3 roll to maintain."
	            },
	            CAMD: {
	                name: "Committed Attack - Melee Determined",
	                AD: "Special ‡",
	                move: "Step",
	                descr: "+2 to hit, or take two steps at -2 to hit for a total modifier of 0, may move before or after an attack",
	                page: "MA100",
	                block: -2,
	                dodge: -2,
	                parry: -2,
	                meleemod: 0,
	                rangedmod: 0,
	                note: "‡ The attacker cannot parry with the hand(s) he used to attack, block if he attacked with his shield or cloak, or dodge if he kicked. He can use any other defense, but at -2. He cannot retreat."
	            },
	            CAMS: {
	                name: "Committed Attack - Melee Strong",
	                AD: "Special ‡",
	                move: "Step",
	                descr: "+1 to damage (or +1 per two full damage dice), ST-based attacks only, may take 2 steps at -2 to skill, may move before or after an attack",
	                page: "MA100",
	                block: -2,
	                dodge: -2,
	                parry: -2,
	                meleemod: 0,
	                rangedmod: 0,
	                note: "‡ The attacker cannot parry with the hand(s) he used to attack, block if he attacked with his shield or cloak, or dodge if he kicked. He can use any other defense, but at -2. He cannot retreat."
	            },
	            DAtk: {
	                name: "Defensive Attack",
	                AD: "Any",
	                move: "Step**",
	                descr: "Balanced weapon = +1 Parry/Block, Unbalanced weapon: +1 Parry/Block with different weapon or Parry with the same weapon, Kick: +2 to avoid Leg Grapple and DX rolls to avoid falling. -2 to damage (or -1 per die if worse), foe gets +1 to defend against a grab or grapple",
	                page: "MA100",
	                block: 1,
	                dodge: 0,
	                parry: 1,
	                meleemod: 0,
	                rangedmod: 0,
	                note: "** Before or after attack."
	            },
	            DN: {
	                name: "Do Nothing",
	                AD: "Any",
	                move: "None",
	                descr: "Take no action",
	                page: "B364",
	                block: 0,
	                dodge: 0,
	                parry: 0,
	                meleemod: 0,
	                rangedmod: 0,
	                note: ""
	            },
	            Eval: {
	                name: "Evaluate",
	                AD: "Any",
	                move: "Step",
	                descr: "Study a foe prior to a melee attack (+1 per turn to subsequent attacks or feints, max. +3); may also use the Evaluate Bonus to cancel out penalties from Deceptive Attacks or feints",
	                page: "B364",
	                block: 0,
	                dodge: 0,
	                parry: 0,
	                meleemod: 0,
	                rangedmod: 0,
	                note: ""
	            },
	            FMB: {
	                name: "Feint - Melee Beat",
	                AD: "Any",
	                move: "Step",
	                descr: "Contest of ST-based combat skill vs foe’s ST- or DX-based skill",
	                page: "MA100",
	                block: 0,
	                dodge: 0,
	                parry: 0,
	                meleemod: 0,
	                rangedmod: 0,
	                note: ""
	            },
	            FMDF: {
	                name: "Feint - Melee Defensive Feint",
	                AD: "Any",
	                move: "Step",
	                descr: "Apply the penalty from a successful Beat, Feint or Ruse to foe’s attacks roll instead of defense",
	                page: "MA100",
	                block: 0,
	                dodge: 0,
	                parry: 0,
	                meleemod: 0,
	                rangedmod: 0,
	                note: ""
	            },
	            Fnt: {
	                name: "Feint",
	                AD: "Any",
	                move: "Step",
	                descr: "Contest of combat skill (melee or ranged) vs. combat skill, cloak/shield or DX",
	                page: "B363",
	                block: 0,
	                dodge: 0,
	                parry: 0,
	                meleemod: 0,
	                rangedmod: 0,
	                note: ""
	            },
	            FMR: {
	                name: "Feint - Melee Ruse",
	                AD: "Any",
	                move: "Step",
	                descr: "Contest of IQ-based combat skill vs. foe’s Per-based skill, DX-based skill or Tactics",
	                page: "MA101",
	                block: 0,
	                dodge: 0,
	                parry: 0,
	                meleemod: 0,
	                rangedmod: 0,
	                note: ""
	            },
	            MA: {
	                name: "Move and Attack",
	                AD: "Special §",
	                move: "Full Move",
	                descr: "Move and attack at a penalty (Ranged: -2 or weapon’s bulk; non-slam Melee: -4, max. skill 9). For thrusting attacks, may use slam damage (HP x velocity/100). Not compatible with Flurry of Blows, Mighty Blow, Giant Step, Combos, Rapid Strike or Deceptive Attack (except slams or cinematic techniques which require final effective skill of at least 10). If tripped or stunble -2 to avoid falling",
	                page: "MA101",
	                block: 0,
	                dodge: 0,
	                parry: 0,
	                meleemod: 0,
	                rangedmod: 0,
	                note: "§ If you attacked using an arm, you cannot use that arm to parry (if the attack involved a fist, elbow, or weapon) or block (if you used a shield or cloak). If you used any other body part to attack, you cannot dodge. You can use any other defense, but you cannot retreat."
	            },
	            Move: {
	                name: "Move",
	                AD: "Any",
	                move: "Full Move",
	                descr: "Do nothing but move (See Sprinting B354 and Acrobatic move MA105+)",
	                page: "B364",
	                block: 0,
	                dodge: 0,
	                parry: 0,
	                meleemod: 0,
	                rangedmod: 0,
	                note: ""
	            },
	            Rdy: {
	                name: "Move",
	                AD: "Any",
	                move: "Step",
	                descr: "Ready or reload a weapon, adjust reach (B269), change grip, change hands (MA102)",
	                page: "B364",
	                block: 0,
	                dodge: 0,
	                parry: 0,
	                meleemod: 0,
	                rangedmod: 0,
	                note: ""
	            },
	            Wait: {
	                name: "Wait",
	                AD: "Any",
	                move: "Wait",
	                descr: "Hold your action, then take an Attack, All-Out Attack, Committed Attack, Defensive Attack, Feint, Ready or Stop Hit. Specify exactly what your action will be and what will trigger it. You may also perform a Step and Wait, loosing your Step in the proceeding Maneuver",
	                page: "B364",
	                block: 0,
	                dodge: 0,
	                parry: 0,
	                meleemod: 0,
	                rangedmod: 0,
	                note: ""
	            }
	        };
	        let manuever = values.manuever;
	        if (!manuevers.hasOwnProperty(manuever)) {
	            // I reversed the order from the example above for simplicity
	            console.log("Error: The item " + manuever + " is not found within the manuever Object.");
	            return;
	        }
	        // set Active Defense, Movement, Description, Ref, Mods, Notes
	        setAttrs({
	            man_active_defense: manuevers[manuever].AD,
	            man_description: manuevers[manuever].descr,
	            man_movement: manuevers[manuever].move,
	            man_ref: manuevers[manuever].page,
	            man_block_mod: manuevers[manuever].block,
	            man_dodge_mod: manuevers[manuever].dodge,
	            man_parry_mod: manuevers[manuever].parry,
	            man_melee_mod: manuevers[manuever].meleemod,
	            man_ranged_mod: manuevers[manuever].rangedmod,
	            man_notes: manuevers[manuever].note
	        });
	    });
	});
// =============== POSTURE=============================
	on("sheet:opened change:posture",
		function () {
			getAttrs(["posture"], function (values) {
			let post = values.posture;
				attack = "",
				defend = "",
				target = "",
				move = "",
				name = "";
			switch(post){
				case "1": // Crouching -2 Normal -2 2/3 (+1/2 per hex)
				name = "Crouching";
				attack = -2;
				defend = 0;
				target = -2;
				move = "2/3 (+1/2 per hex)";
				break;
				case "2": // Kneeling
				name = "Kneeling";
				attack = -2;
				defend = -2;
				target = -2;
				move = "1/3 (+2 per hex)";
				break;
				case "3": // Crawling
				name = "Crawling";
				attack = -4;
				defend = -3;
				target = -2;
				move = "1/3 (+2 per hex)";
				break;
				case "4": // Sitting
				name = "Sitting";
				attack = -2;
				defend = -2;
				target = -2;
				move = "None";
				break;
				case "5": // Lying down or prone
				name = "Lying down";
				attack = -4;
				defend = -3;
				target = -2;
				move = "1 yard/second";
				break;
				default: // Standing
				name = "Standing";
				attack = 0;
				defend = 0;
				target = 0;
				move = "Normal; may sprint";
			}
			// Set Posture modifiers
			setAttrs ({
				posture_name: name,
				posture_attack: attack,
				posture_defend: defend,
				posture_target: target,
				posture_move: move
			});
		});
	});

// ================ ACTIVE DEFENSE ======================
// Update Lines Defense
on("sheet:opened change:repeating_defense remove:repeating_defense change:combat_reflexes change:ambidextrous change:trained_by_master change:weapon_master change:shield_defense_bonus change:man_block_mod change:man_dodge_mod change:man_parry_mod change:defend_encumbrance_penalty change:defend_verticaldiff change:defend_badfoot change:cantseeattacker change:defdistracted change:ad_mounted change:frombehind change:fromside change:multiparry change:defendlaser change:defenddeceptive change:unarmedattacker change:dual change:defendflail change:defendfeint change:parrythrown change:defendacrobatic change:feverish change:posture_defend change:temp_AD_mod change:crossparry change:dodgeanddrop change:riposte change:retreat", function() {
    console.log("********* Update Lines Defense *********");
    TAS.repeating("defense")
        .attr("combat_reflexes", "ambidextrous", "trained_by_master", "weapon_master", "shield_defense_bonus", "man_block_mod", "man_dodge_mod", "man_parry_mod", "defend_encumbrance_penalty", "defend_verticaldiff", "defend_badfoot", "cantseeattacker", "defdistracted", "ad_mounted", "multiparry", "frombehind", "fromside", "defendlaser", "defenddeceptive", "unarmedattacker", "dual", "defendflail", "defendfeint", "parrythrown", "defendacrobatic", "feverish", "posture_defend", "temp_AD_mod", "crossparry", "dodgeanddrop", "riposte", "retreat")
        .fields("adtype", "lvl", "ad_bonus", "esl", "defense_offhand", "wield", "defense_mods", "martialart", "mpp", "flailpenalty", "retreatpenalty", "defendweapontype", "unarmedparry")
        .each(function(r, a) {
            if (r.I.wield == 0 && a.I.ambidextrous == 0) {
                r.D[0].defense_offhand = -2;
            } else {
                r.D[0].defense_offhand = 0;
            }

            if (a.I.trained_by_master == 1 && r.F.martialart == 1) {
                r.D[0].mpp = a.F.multiparry * -1;
            } else if (a.I.weapon_master == 1 && r.F.martialart == 1) {
                r.D[0].mpp = a.F.multiparry * -1;
            } else if (a.I.trained_by_master == 1 || a.I.weapon_master == 1 || r.F.martialart == 1) {
                r.D[0].mpp = a.F.multiparry * -2;
            } else {
                r.D[0].mpp = a.F.multiparry * -4;
            }

            if (r.S.adtype === "Block") {
                r.D[0].flailpenalty = a.F.defendflail * -2;
            } else if (r.S.adtype === "Parry" && r.F.martialart == 1) {
                r.D[0].flailpenalty = a.F.defendflail * -99;
            } else if (r.S.adtype === "Parry" && r.F.martialart != 1) {
                r.D[0].flailpenalty = a.F.defendflail * -4;
            }

            switch (r.F.martialart) {
                case 2:
                case 3:
                case 6:
                case 7:
                    r.F.unarmedparry = -3 + (a.F.unarmedattacker * 3);
                    break;
                default:
                    r.F.unarmedparry = 0;
            }

            switch (r.S.adtype) {
                case "Block":
                    switch (a.F.retreat) {
                        case 1:
                            r.F.retreatpenalty = 1;
                            break;
                        case 4:
                            r.F.retreatpenalty = -1;
                            break;
                        default:
                            r.F.retreatpenalty = 0;
                    }
                    break;
                case "Dodge":
                    switch (a.F.retreat) {
                        case 1:
                            r.F.retreatpenalty = 3;
                            break;
                        case 2:
                        case 3:
                            r.F.retreatpenalty = 2;
                            break;
                        case 4:
                            r.F.retreatpenalty = 1;
                            break;
                        default:
                            r.F.retreatpenalty = 0;
                    }
                    break;
                case "Parry":
                    switch (a.F.retreat) {
                        case 1:
                            switch (r.F.martialart) {
                                case 1:
                                case 2:
                                case 4:
                                case 5:
                                    r.F.retreatpenalty = 3;
                                    break;
                                default:
                                    r.F.retreatpenalty = 1;
                            }
                            break;
                        case 2:
                        case 3:
                            switch (r.F.martialart) {
                                case 1:
                                case 2:
                                case 4:
                                case 5:
                                    r.F.retreatpenalty = 2;
                                    break;
                                default:
                                    r.F.retreatpenalty = 0;
                            }
                            break;
                        case 4:
                            switch (r.F.martialart) {
                                case 1:
                                case 2:
                                case 4:
                                case 5:
                                    r.F.retreatpenalty = 1;
                                    break;
                                default:
                                    r.F.retreatpenalty = -1;
                            }
                            break;
                        default:
                            r.F.retreatpenalty = 0;
                    }
                    break;
            }

            if (r.S.adtype === "Block") {
                r.D[0].defense_mods = a.F.combat_reflexes + a.F.shield_defense_bonus + a.F.man_block_mod + a.F.defend_verticaldiff + a.F.defend_badfoot + a.F.cantseeattacker + a.F.defdistracted + a.F.ad_mounted + a.F.frombehind + a.F.fromside + a.F.defenddeceptive + a.F.dual + r.F.flailpenalty + a.F.defendfeint + a.F.feverish + a.F.posture_defend + a.F.temp_AD_mod + r.F.retreatpenalty;
            } else if (r.S.adtype === "Dodge") {
                r.D[0].defense_mods = a.F.combat_reflexes + a.F.shield_defense_bonus + a.F.man_dodge_mod + a.F.defend_verticaldiff + a.F.defend_badfoot + a.F.cantseeattacker + a.F.defdistracted + a.F.defend_encumbrance_penalty + a.F.ad_mounted + a.F.frombehind + a.F.fromside + a.F.defendlaser + a.F.defenddeceptive + a.F.dual + a.F.defendfeint + a.F.defendacrobatic + a.F.feverish + a.F.posture_defend + a.F.temp_AD_mod + a.F.dodgeanddrop + r.F.retreatpenalty;
            } else if (r.S.adtype === "Parry") {
                r.D[0].defense_mods = a.F.combat_reflexes + a.F.shield_defense_bonus + r.F.mpp + r.F.defense_offhand + a.F.man_parry_mod + a.F.defend_verticaldiff + a.F.defend_badfoot + a.F.cantseeattacker + a.F.defdistracted + a.F.defend_encumbrance_penalty + a.F.ad_mounted + a.F.frombehind + a.F.fromside + a.F.defenddeceptive + a.F.dual + r.F.flailpenalty + a.F.defendfeint + a.F.parrythrown + a.F.feverish + a.F.posture_defend + a.F.temp_AD_mod + a.F.crossparry + a.F.riposte + r.F.retreatpenalty + r.F.defendweapontype + r.F.unarmedparry;
            }

            r.D[0].esl = r.F.lvl + r.I.ad_bonus + r.F.defense_mods;
        })
        .execute();
});


// UPDATE REPEATING SHIELD
on("sheet:opened change:repeating_shield", function() {
    TAS.repeating("shield")
        .attrs("shield_defense_bonus", "shieldfront_db", "shieldleft_db", "shieldright_db", "shieldback_db", "lgshieldpen")
        .fields("shield_large", "shield_ready", "setshield_front", "setshield_left", "setshield_right", "setshield_back", "shield_db")
        .reduce(function(m, r) {
            m.db += (r.F.shield_db * r.I.shield_ready);
            m.fdb += (r.F.shield_db * r.I.shield_ready * r.I.setshield_front);
            m.ldb += (r.F.shield_db * r.I.shield_ready * r.I.setshield_left);
            m.rdb += (r.F.shield_db * r.I.shield_ready * r.I.setshield_right);
            m.bdb += (r.F.shield_db * r.I.shield_ready * r.I.setshield_back);
            m.large += (r.I.shield_large * r.F.shield_ready);

            return m;
        }, {
            db: 0,
            fdb: 0,
            ldb: 0,
            rdb: 0,
            bdb: 0,
            large: 0
        }, function(m, r, a) {
            a.D[0].shield_defense_bonus = m.db;
            a.D[0].shieldfront_db = m.fdb;
            a.D[0].shieldleft_db = m.ldb;
            a.D[0].shieldright_db = m.rdb;
            a.D[0].shieldback_db = m.bdb;
            a.D[0].lgshieldpen = m.large;
        })
        .execute();
});

on("sheet:opened change:lgshieldpen", function() {
    getAttrs(["lgshieldpen"], function(v) {
        var bool;
        var pen;
        if (v.lgshieldpen < 0) {
            bool = "Yes";
            pen = -2;
        } else {
            bool = "No";
            pen = 0;
        }
        setAttrs({
            shieldyesno: bool,
            lgshieldpen: pen
        });
    });
});
  
// Update Non-Repeating Dodge ESL
  // Ref. B374
  //Row 10253
  on("sheet:opened change:dodge_bonus change:current_dodge change:combat_reflexes change:shield_defense_bonus change:man_block_mod change:man_dodge_mod change:man_parry_mod change:defend_encumbrance_penalty change:defend_verticaldiff change:defend_badfoot change:cantseeattacker change:defdistracted change:ad_mounted change:frombehind change:fromside change:defendlaser change:defenddeceptive change:dual change:defendfeint change:defendacrobatic change:feverish change:posture_defend change:temp_AD_mod change:dodgeanddrop change:retreat", function (e) {
    console.log("****** Update Non-Repeating Dodge ESL ******");
    getAttrs(["dodge_bonus", "current_dodge", "combat_reflexes", "shield_defense_bonus", "man_dodge_mod", "defend_encumbrance_penalty", "defend_verticaldiff", "defend_badfoot", "cantseeattacker", "defdistracted", "ad_mounted", "multiparry", "frombehind", "fromside", "defendlaser", "defenddeceptive", "dual", "defendfeint", "defendacrobatic", "feverish", "posture_defend", "temp_AD_mod", "dodgeanddrop", "retreat"],
    function(v){
      var drp;
      switch(+v.retreat) {
            case 1:
            drp = 3;
            break;
            case 2:
            case 3:
            drp = 2;
            break;
            case 4:
            drp = 1;
            break;
            default:
            drp = 0;
          }
          var mod = [+v.combat_reflexes, +v.shield_defense_bonus, +v.man_dodge_mod, +v.defend_verticaldiff, +v.defend_badfoot, +v.cantseeattacker, +v.defdistracted, +v.ad_mounted, +v.frombehind, +v.fromside, +v.defendlaser, +v.defenddeceptive, +v.dual, +v.defendfeint, +v.feverish, +v.dodgeanddrop, +v.posture_defend, +v.defendacrobatic, +v.temp_AD_mod, drp];
          var mods = Object.values(mod);
          mods.push(0);
          var ttlmods = mods.reduce(getSum);

          var skill = [+v.current_dodge, +v.dodge_bonus, ttlmods];
          var esl = Object.values(skill);
          esl.push(0);


      setAttrs({
        dodge_esl: esl.reduce(getSum),
        dodgedefense_mods: mods.reduce(getSum)
      });
    });
  });



// ============== TARGET SHEETWORKER ====================

// Grand Unified Hit Locations Table v2.4
on("sheet:opened change:targetloc", function () {
    getAttrs(["targetloc"], function (values) {
        console.log("*** Update Melee Hit Location ***");
        const targets = {
            random: {
                name: "Random Body",
                penalty: 0,
                restr: "none",
                effects: "Random Grand Unified Hit Locations Table v2.4",
                table: 0,
                subtable: 0,
                type: 0
                
            },
           // Skull
            skull: {
                name: "Skull",
                penalty: -7,
                restr: "-5 from behind",
                effects: "2 DR; if not tox: x4 inj; if not tox: any injury causing shock requires stun/knockdown roll, major wound roll -10 vs stun/knockdown; bleed at 30 seconds not 1 minute",
                table: 3,
                subtable: 0,
                type: 0
            },
            skullr: {
                name: "Skull (Rear)",
                penalty: -5,
                restr: "-5 from behind",
                effects: "2 DR; if not tox: x4 inj; if not tox: any injury causing shock requires stun/knockdown roll, major wound roll -10 vs stun/knockdown; bleed at 30 seconds not 1 minute",
                table: 3,
                subtable: 1,
                type: 0
            },
            // Face
            facef: {
                name: "Face (Front)",
                penalty: -5,
                restr: "-7 from behind",
                effects: "Roll on sub-table A; Cor x1.5 inj; any injury causing shock requires stun/knockdown roll, major wound roll -5 stun/knockdown",
                table: 5,
                subtable: 0,
                type: 0
            },
            Jaw: {
                name: "Jaw",
                penalty: -6,
                restr: "front only",
                effects: "Miss by 1 hit chest; any injury causing shock requires -1 stun/knockdown roll; major wound roll -6 to stun/knockdown.",
                table: 5,
                subtable: 1,
                type: 0
            },
            Nose: {
                name: "Nose",
                penalty: -7,
                restr: "front only",
                effects: "Miss by 1 hit chest; cripple over 1/4 HP and causes No Sense of Smell/Taste (non-cutting) or Appearance loss (cutting, x2 crippling threshold), non-cutting major wound -5 to stun/knockdown.",
                table: 5,
                subtable: 2,
                type: 0
            },
            Ear: {
                name: "Ear",
                penalty: -7,
                restr: "cutting or treat as face",
                effects: "Miss by 1 hit chest; cripple over 1/4 HP, no -5 to stun/knockdown, major wound only on sever; lost ear causes Appearance penalties.",
                table: 5,
                subtable: 3,
                type: 0
            },
            Cheek: {
                name: "Cheek",
                penalty: -5,
                restr: "-7 from behind",
                effects: "Roll on sub-table A; Cor x1.5 inj; any injury causing shock requires stun/knockdown roll, major wound roll -5 stun/knockdown",
                table: 5,
                subtable: 4,
                type: 0
            },
            Eye: {
                name: "Eye",
                penalty: -9,
                restr: "-10 in helmet; imp, pi-, pi, pi+, pi++, bu (tb) only",
                effects: "Cripple over 1/10 hp; otherwise skull hit w/no DR. Tox has no spec. effect beyond cripple; bleed at 30 seconds not 1 min.",
                table: 5,
                subtable: 6,
                type: 0
            },
            facer: {
                name: "Face (Rear)",
                penalty: -7,
                restr: "-7 from behind",
                effects: "Roll on sub-table A; Cor x1.5 inj; any injury causing shock requires stun/knockdown roll, major wound roll -5 stun/knockdown",
                table: 5,
                subtable: 0,
                type: 0
            },
            // Leg (Right)
            LegR: {
                name: "Leg (Right)",
                penalty: -2,
                restr: "none",
                effects: "Roll on sub-table B; pi+, pi++, imp: x1 inj; cripple over 1/2 H",
                table: 6,
                subtable: 0,
                type: 0
            },
            Shinr: {
                name: "Shin (Right)",
                penalty: -2,
                restr: "none",
                effects: "Roll on sub-table B; pi+, pi++, imp: x1 inj; cripple over 1/2 H",
                table: 6,
                subtable: 1,
                type: 0
            },
            Kneer: {
                name: "Knee (Right)",
                penalty: -5,
                restr: "cr, cut, pi-, pi, pi+, pi++, bu (tb) only",
                effects: "Miss by 1 hit limb; as per limb but cripple over 1/3 HP; dismember as per limb, not per joint; recover from cripple at -2",
                table: 6,
                subtable: 4,
                type: 0
            },
            Thighr: {
                name: "Thigh (Right)",
                penalty: -2,
                restr: "none",
                effects: "Roll on sub-table B; pi+, pi++, imp: x1 inj; cripple over 1/2 H",
                table: 6,
                subtable: 5,
                type: 0
            },
            Veinrl: {
                name: "Vein/Artery, Leg (Right)",
                penalty: -5,
                restr: "cu, imp, pi-, pi, pi+, pi++, bu (tb) only",
                effects: "Miss by 1 hit limb; Cr, corr: x1.5 inj; cut x2 inj; no cripple, no inj limit; bleed at -3 (-4 if cu); make bleed rolls every 30s",
                table: 6,
                subtable: 6,
                type: 0
            },
            // Arm (Right)
            ArmR: {
                name: "Arm (Right)",
                penalty: -2,
                restr: "-4 with shield",
                effects: "Roll on sub-table C; pi+, pi++, imp: x1 inj; cripple over 1/2 HP",
                table: 8,
                subtable: 0,
                type: 0
            },
            Forearmr: {
                name: "Forearm (Right)",
                penalty: -2,
                restr: "-4 with shield",
                effects: "pi+, pi++, imp: x1 inj; cripple over 1/2 HP",
                table: 8,
                subtable: 1,
                type: 0
            },
            Elbowr: {
                name: "Elbow (Right)",
                penalty: -5,
                restr: "cr, cut, pi-, pi, pi+, pi++, bu (tb) only",
                effects: "Miss by 1 hit limb; as per limb but cripple over 1/3 HP; dismember as per limb, not per joint; recover from cripple at -2",
                table: 8,
                subtable: 4,
                type: 0
            },
            Upperr: {
                name: "Upper Arm (Right)",
                penalty: -2,
                restr: "-4 with shield",
                effects: "pi+, pi++, imp: x1 inj; cripple over 1/2 HP",
                table: 8,
                subtable: 5,
                type: 0
            },
            Shoulderr: {
                name: "Shoulder (Right)",
                penalty: -5,
                restr: "-4 with shield",
                effects: "pi+, pi++, imp: x1 inj; cripple over 1/2 HP",
                table: 8,
                subtable: 6,
                type: 0
            },
            Veinra: {
                name: "Vein/Artery, Arm (Right)",
                penalty: -5,
                restr: "cu, imp, pi-, pi, pi+, pi++, bu (tb) only",
                effects: "Miss by 1 hit limb; Cr, corr: x1.5 inj; cut x2 inj; no cripple, no inj limit; bleed at -3 (-4 if cu); make bleed rolls every 30s",
                table: 8,
                subtable: 7,
                type: 0
            },
            // Chest
            Chest: {
                name: "Chest",
                penalty: 0,
                restr: "none",
                effects: "Default location. Roll on sub table D; injury can't exceed 2xHP (1xHP if using bleeding); any excess is lost",
                table: 9,
                subtable: 0,
                type: 0
            },
            Vitalsc: {
                name: "Vitals",
                penalty: -3,
                restr: "cr, imp; pi-, pi, pi+, pi++; bu (tb) only",
                effects: "Imp, pi-, pi, pi+, pi++: x3 inj; bu (tb) x2 inj; cr x1, shock force HT roll for Knockdown, major wound -5 stun/knockdown; bleed at 30 seconds not 1 minute; -4 bleed penalty",
                table: 9,
                subtable: 1,
                type: 0
            },
            Spinec: {
                name: "Spine",
                penalty: -8,
                restr: "behind only, cr, cut, imp, pi-, pi, pi+, pi++, bu (tb) only",
                effects: "Miss by 1 hit chest; 3 DR; as per chest but enough injury for shock penalty (even with HPT) gives stun/knockdown, -5 if a major wound. Cripple over 1xHP Bad Back (Severe) and Lame (Paraplegic) until healed",
                table: 9,
                subtable: 7,
                type: 0
            },
            Heart: {
                name: "Vitals (Heart)",
                penalty: -5,
                restr: "cr, imp; pi-, pi, pi+, pi++; bu (tb) only",
                effects: "Imp, pi-, pi, pi+, pi++: x3 inj; bu (tb) x2 inj; cr x1, shock force HT roll for Knockdown, major wound -5 stun/knockdown; bleed at 30 seconds not 1 minute; -4 bleed penalty. May be special for some characters (e.g. Vampires).",
                table: 9,
                subtable: 8,
                type: 0
            },
            // Abdomen
            Abdomen: {
                name: "Abdomen",
                penalty: -1,
                restr: "none",
                effects: "Roll on sub-table E; Injury can't exceed 2xHP (1xHP if using bleeding); any excess is lost",
                table: 11,
                subtable: 0,
                type: 0
            },
            Vitalsa: {
                name: "Vitals, Abdomen",
                penalty: -3,
                restr: "cr, imp; pi-, pi, pi+, pi++; bu (tb) only",
                effects: "Imp, pi-, pi, pi+, pi++: x3 inj; bu (tb) x2 inj; cr x1, shock force HT roll for Knockdown, major wound -5 stun/knockdown; bleed at 30 seconds not 1 minute; -4 bleed penalty",
                table: 11,
                subtable: 1,
                type: 0
            },
            Digest: {
                name: "Digestive Tract",
                penalty: -3,
                restr: "none",
                effects: "As abdomen; on major wound HT-3 to avoid special",
                table: 11,
                subtable: 2,
                type: 0
            },
            Pelvis: {
                name: "Pelvis",
                penalty: -3,
                restr: "none",
                effects: "As abdomen; on major wound: fall down, cannot stand, Lame (Missing Legs) until healed",
                table: 11,
                subtable: 5,
                type: 0
            },
            Groin: {
                name: "Groin",
                penalty: -3,
                restr: "none",
                effects: "double shock; major wound -5 stun/knockdown",
                table: 11,
                subtable: 5,
                type: 0
            },
            // Arm (Left)
            ArmL: {
                name: "Arm (Left)",
                penalty: -2,
                restr: "-4 with shield",
                effects: "Roll on sub-table C; pi+, pi++, imp: x1 inj; cripple over 1/2 HP",
                table: 12,
                subtable: 0,
                type: 0
            },
            Forearm: {
                name: "Forearm (Left)",
                penalty: -2,
                restr: "-4 with shield",
                effects: "pi+, pi++, imp: x1 inj; cripple over 1/2 HP",
                table: 12,
                subtable: 1,
                type: 0
            },
            Elbowl: {
                name: "Elbow (Left)",
                penalty: -5,
                restr: "cr, cut, pi-, pi, pi+, pi++, bu (tb) only",
                effects: "Miss by 1 hit limb; as per limb but cripple over 1/3 HP; dismember as per limb, not per joint; recover from cripple at -2",
                table: 12,
                subtable: 4,
                type: 0
            },
            Upperl: {
                name: "Upper Arm (Left)",
                penalty: -2,
                restr: "-4 with shield",
                effects: "pi+, pi++, imp: x1 inj; cripple over 1/2 HP",
                table: 12,
                subtable: 5,
                type: 0
            },
            Shoulderl: {
                name: "Shoulder (Left)",
                penalty: -5,
                restr: "-4 with shield",
                effects: "pi+, pi++, imp: x1 inj; cripple over 1/2 HP",
                table: 12,
                subtable: 6,
                type: 0
            },
            Veinla: {
                name: "Vein/Artery, Arm (Left)",
                penalty: -5,
                restr: "cu, imp, pi-, pi, pi+, pi++, bu (tb) only",
                effects: "Miss by 1 hit limb; Cr, corr: x1.5 inj; cut x2 inj; no cripple, no inj limit; bleed at -3 (-4 if cu); make bleed rolls every 30s",
                table: 12,
                subtable: 7,
                type: 0
            },
            LegL: {
                name: "Leg (Left)",
                penalty: -2,
                restr: "none",
                effects: "Roll on sub-table B; pi+, pi++, imp: x1 inj; cripple over 1/2 H",
                table: 13,
                subtable: 0,
                type: 0
            },
            Shinl: {
                name: "Shin (Left)",
                penalty: -2,
                restr: "none",
                effects: "Roll on sub-table B; pi+, pi++, imp: x1 inj; cripple over 1/2 H",
                table: 13,
                subtable: 1,
                type: 0
            },
            Kneel: {
                name: "Knee (Left)",
                penalty: -5,
                restr: "cr, cut, pi-, pi, pi+, pi++, bu (tb) only",
                effects: "Miss by 1 hit limb; as per limb but cripple over 1/3 HP; dismember as per limb, not per joint; recover from cripple at -2",
                table: 13,
                subtable: 4,
                type: 0
            },
            Thighl: {
                name: "Thigh (Left)",
                penalty: -2,
                restr: "none",
                effects: "Roll on sub-table B; pi+, pi++, imp: x1 inj; cripple over 1/2 H",
                table: 13,
                subtable: 5,
                type: 0
            },
            Veinll: {
                name: "Vein/Artery, Leg (Left)",
                penalty: -5,
                restr: "cu, imp, pi-, pi, pi+, pi++, bu (tb) only",
                effects: "Miss by 1 hit limb; Cr, corr: x1.5 inj; cut x2 inj; no cripple, no inj limit; bleed at -3 (-4 if cu); make bleed rolls every 30s",
                table: 13,
                subtable: 6,
                type: 0
            },
            Hand: {
                name: "Hand",
                penalty: -4,
                restr: "-8 with shield",
                effects: "Roll on sub-table F; pi+, pi++, imp: x1 inj; cripple over 1/3 HP",
                table: 15,
                subtable: 0,
                type: 0
            },
            HJoint: {
                name: "Hand (Joint)",
                penalty: -7,
                restr: "cr, cut, pi-, pi, pi+, pi++, bu (tb) only",
                effects: "Miss by 1 hit extremity; as per extremity but cripple over 1/4 HP; dismember as per extremity, not per joint; recover from cripple at -2",
                table: 15,
                subtable: 1,
                type: 0
            },
            Foot: {
                name: "Foot",
                penalty: -4,
                restr: "none",
                effects: "Roll on sub-table F; pi+, pi++, imp: x1 inj; cripple over 1/3 HP",
                table: 16,
                subtable: 0,
                type: 0
            },
            FJoint: {
                name: "Hand (Joint)",
                penalty: -7,
                restr: "cr, cut, pi-, pi, pi+, pi++, bu (tb) only",
                effects: "Miss by 1 hit extremity; as per extremity but cripple over 1/4 HP; dismember as per extremity, not per joint; recover from cripple at -2",
                table: 16,
                subtable: 1,
                type: 0
            },
            Neck: {
                name: "Neck",
                penalty: -5,
                restr: "none",
                effects: "Roll on sub-table G; Miss by 1 hit chest; Cr, corr: x1.5 inj; cut x2 inj; bleed at 30 seconds not 1 minute; -2 bleed penalty; optional: treat any crushing injury over HP/2 to the neck hit location as a crippling injury which crushes the windpipe, causing choking.",
                table: 17,
                subtable: 0,
                type: 0
            },
            Veeinn: {
                name: "Neck Vein/Artery",
                penalty: -8,
                restr: "cu, imp, pi-, pi, pi+, pi++, bu (tb) only",
                effects: "Miss by 1 hit neck; Cr, corr: x2 inj; cut x2.5 inj; bleed at -3 (-4 if cu); make bleed rolls every 30s",
                table: 17,
                subtable: 1,
                type: 0
            },
            Spinen: {
                name: "Spine, Neck (Rear)",
                penalty: -8,
                restr: "behind only, cr, cut, imp, pi-, pi, pi+, pi++, bu (tb) only",
                effects: "Miss by 1 hit chest; 3 DR; as per chest but enough injury for shock penalty (even with HPT) gives stun/knockdown, -5 if a major wound. Cripple over 1xHP Broken Neck (Severe) Lame, No Manipulators (Quadriplegic) until healed",
                table: 17,
                subtable: 2,
                type: 0
            },
            ChinksT: {
                name: "Chinks (Torso)",
                penalty: -8,
                restr: "none",
                effects: "Halves DR over Torso",
                table: 9,
                subtable: 0,
                type: 0
            },
            ChinksO: {
                name: "Chinks (Other)",
                penalty: -10,
                restr: "none",
                effects: "Halves DR over any other hit location",
                table: 20,
                subtable: 0,
                type: 0
            },
            // Harsh Realism Armor Gaps -------
            ArmpitR: {
                name: "Right Armpit",
                penalty: -8,
                restr: "imp only",
                effects: "Armor gap over Vitals; on Critical Hit: instead of rolling on table, cripple arm (in addition to vitals damage)",
                table: 8,
                subtable: 6,
                type: 0
            },
            ArmpitL: {
                name: "Left Armpit",
                penalty: -8,
                restr: "imp only",
                effects: "Armor gap over Vitals; on Critical Hit: instead of rolling on table, cripple arm (in addition to vitals damage)",
                table: 12,
                subtable: 6,
                type: 0
            },
            BoKR: {
                name: "Back of Right Knee",
                penalty: -8,
                restr: "none",
                effects: "Armor gap over joint",
                table: 6,
                subtable: 4,
                type: 0
            },
            BoKL: {
                name: "Back of Left Knee",
                penalty: -8,
                restr: "none",
                effects: "Armor gap over joint",
                table: 13,
                subtable: 4,
                type: 0
            },
            Eyeslit: {
                name: "Eyeslit(s)",
                penalty: -10,
                restr: "imp, pi-, pi, pi+, pi++, bu (tb) only",
                effects: "Armor gap over eyes",
                table: 5,
                subtable: 6,
                type: 0
            },
            Cod: {
                name: "Codpiece",
                penalty: -8,
                restr: "none",
                effects: "Armor gap over groin",
                table: 11,
                subtable: 6,
                type: 0
            },
            InsideER: {
                name: "Inside Right Elbow",
                penalty: -8,
                restr: "none",
                effects: "Armor gap over joint",
                table: 8,
                subtable: 4,
                type: 0
            },
            InsideEL: {
                name: "Inside Left Elbow",
                penalty: -8,
                restr: "none",
                effects: "Armor gap over joint",
                table: 12,
                subtable: 4,
                type: 0
            },
            InsideTR: {
                name: "Inside Right Thigh",
                penalty: -8,
                restr: "-3 from the back",
                effects: "Armor gap over Leg (Thigh); optional: cu, imp, pi, bu (tb) hits Limb Vein/Artery.",
                table: 6,
                subtable: 6,
                type: 0
            },
            InsideTL: {
                name: "Inside Left Thigh",
                penalty: -8,
                restr: "-3 from the back",
                effects: "Armor gap over Leg (Thigh); optional: cu, imp, pi, bu (tb) hits Limb Vein/Artery.",
                table: 13,
                subtable: 6,
                type: 0
            },
            NeckAG: {
                name: "Neck Armor Gap",
                penalty: -8,
                restr: "none",
                effects: "Armor gap over neck",
                table: 17,
                subtable: 0,
                type: 0
            },
            Palm: {
                name: "Open Palm",
                penalty: -8,
                restr: "-6 if unarmed",
                effects: "Armor gap over hand",
                table: 15,
                subtable: 0,
                type: 0
            },
            // Weapons and Equipment --------
            ReachC: {
                name: "Reach C Weapon",
                penalty: -5,
                restr: "see weapon breakage p.401",
                effects: "Roll normal damage against the weapon.",
                table: 40,
                subtable: 1,
                type: 0
            },
            Reach1: {
                name: "Reach 1 Weapon",
                penalty: -4,
                restr: "see weapon breakage p.401",
                effects: "Roll normal damage against the weapon.",
                table: 40,
                subtable: 1,
                type: 0
            },
            Reach2: {
                name: "Reach 2 Weapon",
                penalty: -3,
                restr: "see weapon breakage p.401",
                effects: "Roll normal damage against the weapon.",
                table: 40,
                subtable: 1,
                type: 0
            },
             vehicle: {
                name: "Random Vehicle",
                penalty: 0,
                restr: "none",
                effects: "Random Grand Unified Hit Locations Table v2.4",
                table: 50,
                subtable: 50,
                type: "?{Target Vehicle Powered?|Yes,1|No,2}"
            },
            g: {
                name: "Small Glass Window* or Exposed Weapon Mount",
                penalty: -7,
                restr: "none",
                effects: "See B554",
                table: 50,
                subtable: 3,
                type: "?{Target Vehicle Powered?|Yes,1|No,2}"
            },
            s: {
                name: "Small Superstructure* or Independent Turret",
                penalty: -5,
                restr: "none",
                effects: "See B554",
                table: 50,
                subtable: 5,
                type: "?{Target Vehicle Powered?|Yes,1|No,2}"
            },
            C: {
                name: "Caterpillar Track [C], Draft Animal** [D], Helicopter Rotor [H], Mast [M], or Wing [Wi]",
                penalty: -2,
                restr: "none",
                effects: "See B554",
                table: 50,
                subtable: 6,
                type: "?{Target Vehicle Powered?|Yes,1|No,2}"
            },
            A: {
                name: "Arm [A], Large Superstructure* [S], or Main Turret* [T]",
                penalty: -2,
                restr: "none",
                effects: "See B554",
                table: 50,
                subtable: 8,
                type: "?{Target Vehicle Powered?|Yes,1|No,2}"
            },
            BE: {
                name: "Body* or Exposed Rider [E]",
                penalty: 0,
                restr: "none",
                effects: "See B554",
                table: 50,
                subtable: 9,
                type: "?{Target Vehicle Powered?|Yes,1|No,2}"
            },
            B: {
                name: "Body*",
                penalty: 0,
                restr: "none",
                effects: "See B554",
                table: 50,
                subtable: 10,
                type: "?{Target Vehicle Powered?|Yes,1|No,2}"
            },
            G: {
                name: "Large Glass Window [G] or Open Cabin [O]",
                penalty: 0,
                restr: "none",
                effects: "See B554",
                table: 50,
                subtable: 11,
                type: "?{Target Vehicle Powered?|Yes,1|No,2}"
            },
            R: {
                name: "Runner or Skid [R] or Wheel [W]",
                penalty: -4,
                restr: "none",
                effects: "See B554",
                table: 50,
                subtable: 15,
                type: "?{Target Vehicle Powered?|Yes,1|No,2}"
            },
            V: {
                name: "Vital Area",
                penalty: -3,
                restr: "none",
                effects: "See B554",
                table: 50,
                subtable: 17,
                type: "?{Target Vehicle Powered?|Yes,1|No,2}"
            },
        };
        let targetloc = values.targetloc;
        if (!targets.hasOwnProperty(targetloc)) {
            // I reversed the order from the example above for simplicity
            console.log("Error: The item " + targetloc + " is not found within the melee_target Object.");
            return;
        }
        setAttrs({
            targetname: targets[targetloc].name,
            targetpenalty: targets[targetloc].penalty,
            targetrestr: targets[targetloc].restr,
            targeteffects: targets[targetloc].effects,
            targettable: targets[targetloc].table,
            targetsubtable: targets[targetloc].subtable,
            targettype: targets[targetloc].type
        });
    });
});

// ================= MELEE COMBAT ========================

// Update Lines on Melee
	on("sheet:opened change:repeating_melee remove:repeating_melee change:strength change:ambidextrous change:trained_by_master change:weapon_master change:badfoot change:meleegrappled change:shield_defense_bonus change:shieldccbt change:lgshieldpen change:targetpenalty change:distraction change:meleestrikeccbt change:meleewild change:evaluate change:meleecannotsee change:visionpenalty change:nightvision change:firing_size_mod change:temp_DX_mod change:skillRoll_mod change:man_melee_mod", function () {
		console.log("********* Update Lines Melee *********");
		TAS.repeating("melee")
			.attrs("strength", "ambidextrous", "trained_by_master", "weapon_master", "badfoot", "meleegrappled", "shield_defense_bonus", "shieldccbt", "shield_melee_penalty", "lgshieldpen", "targetpenalty", "distraction", "meleestrikeccbt", "meleewild", "evaluate", "meleecannotsee", "visionpenalty", "nightvision", "firing_size_mod", "temp_DX_mod", "skillRoll_mod", "man_melee_mod" )

			.fields("esl", "skill", "mmods",  "minst", "stdeficit",  "rapidstrike", "rsp", "dualweapon", "offhand", "wield", "deceptiveatk", "telegraph", "visionpenalty")

			.each(function (r, a) {

				if (r.I.minst > a.I.strength) {
					r.D[0].stdeficit = a.I.strength - r.I.minst;
					} else {
					r.D[0].stdeficit = 0;
					}
				if (a.I.trained_by_master > 0 || a.I.weapon_master > 0) {
					r.D[0].rsp = r.I.rapidstrike / 2;
					} else { r.D[0].rsp = r.I.rapidstrike;
					}
				if (r.I.wield < 1 && a.I.ambidextrous < 1) {
					r.D[0].offhand = -4;
					} else {
					r.D[0].offhand = 0;
					}
				if (a.I.visionpenalty < -9) {
					r.D[0].visionpenalty = -10;
				} else {
					r.D[0].visionpenalty = Math.min(0, (a.F.visionpenalty + a.F.nightvision));
				}

				a.D[0].shield_melee_penalty = a.F.shieldccbt * a.F.shield_defense_bonus;

				r.D[0].mmods = a.F.temp_DX_mod + a.F.skillRoll_mod + r.F.stdeficit + r.F.rsp + r.F.offhand + r.F.deceptiveatk + r.F.dualweapon + r.F.telegraph +  a.F.badfoot + a.F.meleegrappled + a.F.lgshieldpen + a.F.shield_melee_penalty + a.F.targetpenalty + a.F.distraction + a.F.meleestrikeccbt + a.F.meleewild + a.F.evaluate + a.F.meleecannotsee + r.F.visionpenalty + a.F.firing_size_mod + a.F.man_melee_mod;

				r.D[0].esl = r.F.skill + r.F.mmods;
		})
			.execute();
	});		
	
// ================ RANGED SHEET WORKERS =================
	// ======= CONSTANT SPEED SIZE RANGE ======
    // see: https://app.roll20.net/forum/post/7251390/slug%7D
	const modBySpeedRange = [ 
                    	{r:1, m:0},
                    	{r:2, m:0},
                    	{r:3, m:-1},
                    	{r:5, m:-2},
                    	{r:7, m:-3},
                    	{r:10, m:-4},
                    	{r:15, m:-5},
                    	{r:20, m:-6},
                    	{r:30, m:-7},
                    	{r:50, m:-8},
                    	{r:70, m:-9},
                    	{r:100, m:-10},
                    	{r:150, m:-11},
                    	{r:200, m:-12},
                    	{r:300, m:-13},
                    	{r:500, m:-14},
                    	{r:700, m:-15},
                    	{r:1000, m:-16},
                    	{r:1500, m:-17},
                    	{r:2000, m:-18},
                    	{r:3000, m:-19},
                    	{r:5000, m:-20},
                    	{r:7000, m:-21},
                    	{r:10000, m:-22},
                    	{r:15000, m:-23},
                    	{r:20000, m:-24}
                    ];

    /**
     * Create global function
     * use: var mod = getModBySpeedRange(14);
     * Uses the array of json object objects
     * to get the modifier based on speed/range
     **/
    const getModBySpeedRange = (d) => {
    	
    	// find first matching entry where range is greater than distance
    	// Distance = 4, first entry where range is greater than 4. 
    	// Range = 5, which is greater than 4. return that object. Modifier = -2
    	const entry = modBySpeedRange.find((o)=>o.r>=d );
    	
    	// if no matches, return -24.
    	return (entry != undefined ? entry.m : -24);
    
    };
	
		// see: https://app.roll20.net/forum/post/7251390/slug%7D
	const modBySimpleSpeedRange = [ 
                    	{r:5, m:0},
						{r:20, m:-3},
						{r:100, m:-7},
						{r:500, m:-11},
						{r:2500, m:-15}
                    ];

    /**
     * Create global function
     * use: var mod = getModBySpeedRange(14);
     * Uses the array of json object objects
     * to get the modifier based on speed/range
     **/
    const getModBySimpleSpeedRange = (d) => {
    	
    	// find first matching entry where range is greater than distance
    	// Distance = 4, first entry where range is greater than 4. 
    	// Range = 5, which is greater than 4. return that object. Modifier = -2
    	const entry = modBySimpleSpeedRange.find((o)=>o.r>=d );
    	
    	// if no matches, return -24.
    	return (entry != undefined ? entry.m : -24);
    
    };
    // Range Calculator
    on('change:firing_distance change:firing_speed_difference change:firing_size_mod change:firing_direction change:firing_up_dwn_distance change:range_rule', function (event) {

        updateRangeModifier();

    });

    /**
     * Determine new range based on fields
     * and then get the final to hit modifier
     */
    function updateRangeModifier() {

        var fields = [
            "firing_distance",
            "firing_speed_difference",
            "firing_size_mod",
            "firing_direction",
            "firing_up_dwn_distance",
            "range_rule"
        ];

        getAttrs(fields, function (values) {

            var linearDistance = +values.firing_distance;

            var sizeMod = +values.firing_size_mod;

            var speed = +values.firing_speed_difference;

            var elevation = +values.firing_up_dwn_distance;
            
            var rangeRule = +values.range_rule;

            var elevationDown = 0;

            var rangeToTarget = 0;

            var speedRangeValue = 0;

            var finalSpeedRangeValue = 0;
            

            // make sure value is valid
            if (linearDistance < 0)
                linearDistance = 0;

            if (elevation > 0 && values.firing_direction == "up") {

                rangeToTarget = linearDistance + elevation;

            } else if (elevation > 0 && values.firing_direction == "dn") {

                elevationDown = Math.floor(elevation / 2);

                // max elevation is half of ground distance
                if (elevationDown > Math.floor(linearDistance / 2)) {

                    elevationDown = Math.floor(linearDistance / 2);

                }

                rangeToTarget = linearDistance - elevationDown;

            } else {

                rangeToTarget = linearDistance;

            }

            
            
            
            finalSpeedRangeValue = rangeToTarget + speed;
            
            if (rangeRule === 1) {
                var hitModifier = getModBySpeedRange(finalSpeedRangeValue);
            } else if (rangeRule === 2) {
                var hitModifier = getModBySimpleSpeedRange(finalSpeedRangeValue);
            }

            // add in size modifier
            hitModifier = hitModifier + sizeMod;

            setAttrs({
                'firing_new_range': finalSpeedRangeValue,
                'rangedspeedrangesize': hitModifier
            });

        });

    }

// =============== END RANGE CALCULATOR ===================
// =============== BEGIN RAPID FIRE CALCULATOR
// Rapid Fire Calculator
    const modByRapidFire = [ 
                        {r:4, m:0},
                        {r:8, m:1},
                        {r:12, m:2},
                        {r:16, m:3},
                        {r:24, m:4},
                        {r:49, m:5},
                        {r:99, m:6},
                        {r:199, m:7},
                        {r:399, m:8},
                        {r:799, m:9},
                        {r:1699, m:10},
                        {r:3199, m:11},
                        {r:6399, m:12},
                        {r:12799, m:13}
                    ];

const getModByRapidFire = (d) => {
        
        const entry = modByRapidFire.find((o)=>o.r>=d );

        return (entry != undefined ? entry.m : -24);
    
    };

    // Rapid Fire Calculator
    on("sheet:opened change:rapidfire", function(event) {
        
        updateRapidFireModifier();
        
    });
    
    function updateRapidFireModifier() {
        
        var fields = [
            "rapidfire"
            ];
            
       getAttrs(fields, function(values) {
           
           var roundsFired = +values.rapidfire;
              
           var finalRoundsFiredValue = 0;
           
           finalRoundsFiredValue = roundsFired;
           var rapidFireModifier = getModByRapidFire(finalRoundsFiredValue);

           
           setAttrs({
                "rapidfirerounds": finalRoundsFiredValue,
                "rapidfirebonus": rapidFireModifier
            });
           
       });
        
    }
// ============== END RAPID FIRE CALCULATOR ================

	// Update Lines on ranged
	on("sheet:opened change:repeating_ranged remove:repeating_ranged change:strength change:ambidextrous change:trained_by_master change:weapon_master change:temp_DX_mod change:skillRoll_mod  change:range_rule change:badfoot change:rangedccbt change:damagedweapon  change:distraction change:extraaim change:popup change:unfam change:oppfireon change:oppfire change:hexes change:rangedcannotsee change:visionpenalty change:nightvision change:rangedspeedrangesize change:rapidfire change:lightcover change:targetbehind change:targetposture change:targetpartialcover change:targetpenalty change:man_ranged_mod", function () {
		console.log("********* Update Lines ranged *********");
		TAS.repeating("ranged")
			.attrs("strength", "ambidextrous", "trained_by_master", "weapon_master","temp_DX_mod", "skillRoll_mod", "badfoot", "rangedccbt", "damagedweapon", "distraction", "popup", "unfam", "rangedcannotsee", "visionpenalty", "nightvision",  "rangedspeedrangesize", "rapidfirebonus", "oppfireon", "oppfire", "hexes", "oppfirepenalty", "lightcover", "targetbehind", "targetposture", "targetpartialcover", "targetpenalty", "visionpenalty", "extraaim", "man_ranged_mod" )
			.fields("esl", "skill", "rmods", "acc", "bulk",  "minst", "stdeficit", "dualweapon", "offhand", "wield", "deceptiveatk", "visionpenalty", "tgtsysbonus", "aimingbonus", "ttlaimbonus", "tgtbehindpen", "braced", "scopebonus", "scopeonoff", "laser", "aiming", "ccbtpenalty", "accbonus", "tgtsys" )
			.each(function (r, a) {

				if (r.I.minst > a.I.strength) {
					r.D[0].stdeficit = a.I.strength - r.I.minst;
					} else {
					r.D[0].stdeficit = 0;
					}
				if (r.I.wield < 1 && a.I.ambidextrous < 1) {
					r.D[0].offhand = -4;
					} else {
					r.D[0].offhand = 0;
					}
				a.D[0].oppfirepenalty = a.I.oppfireon * (a.F.oppfire + a.F.hexes);
				if (a.I.visionpenalty < -9) {
						r.D[0].visionpenalty = -10;
					} else {
						r.D[0].visionpenalty = Math.min(0, (a.F.visionpenalty + a.F.nightvision));
					}

				r.D[0].tgtbehindpen = a.I.targetbehind * -4;
				r.D[0].ccbtpenalty = a.F.rangedccbt * r.F.bulk;
				r.D[0].accbonus = r.F.aiming * r.F.acc;
				r.D[0].aimingbonus = r.F.aiming * (Math.min((r.I.acc), (a.F.extraaim + r.F.braced)));
				r.D[0].tgtsysbonus = Math.min((r.I.acc), ( (r.F.aiming * r.F.tgtsys) + r.F.laser + (r.F.aiming * (r.F.scopeonoff * r.F.scopebonus))));
				r.D[0].ttlaimbonus = r.F.accbonus + r.F.aimingbonus + r.F.tgtsysbonus;
				


				r.D[0].rmods = a.F.temp_DX_mod + a.F.skillRoll_mod + r.F.stdeficit + r.F.dualweapon + r.F.offhand + r.F.deceptiveatk + a.F.badfoot + a.F.damagedweapon + a.F.distraction + a.F.popup + a.F.unfam + a.F.rapidfirebonus + a.F.oppfirepenalty + a.F.rangedspeedrangesize + a.F.lightcover + a.F.targetposture + a.F.rangedcannotsee + r.F.visionpenalty + a.F.targetpartialcover + a.F.targetpenalty + r.F.tgtbehindpen + r.F.ccbtpenalty + r.F.ttlaimbonus + a.F.man_ranged_mod;

				r.D[0].esl = r.I.skill + r.F.rmods;
		})
			.execute();
	});	


	// Update Lines on vehicle
	on("sheet:opened change:repeating_vehicle remove:repeating_vehicle change:strength change:ambidextrous change:trained_by_master change:weapon_master change:temp_DX_mod change:skillRoll_mod  change:range_rule change:badfoot change:rangedccbt change:damagedweapon  change:distraction change:extraaim change:popup change:unfam change:oppfireon change:oppfire change:hexes change:rangedcannotsee change:visionpenalty change:nightvision change:rangedspeedrangesize change:rapidfire change:lightcover change:targetbehind change:targetposture change:targetpartialcover change:targetpenalty change:SR change:vehdodged change:turnedrider change:failedctrl change:hangingrider change:terrain change:man_ranged_mod change:man_melee_mod", function () {
	    console.log("********* Update Lines ranged *********");
	    TAS.repeating("vehicle")
	        .attrs("strength", "ambidextrous", "trained_by_master", "weapon_master", "temp_DX_mod", "skillRoll_mod", "badfoot", "rangedccbt", "damagedweapon", "distraction", "popup", "unfam", "rangedcannotsee", "visionpenalty", "nightvision", "rangedspeedrangesize", "rapidfirebonus", "oppfireon", "oppfire", "hexes", "oppfirepenalty", "lightcover", "targetbehind", "targetposture", "targetpartialcover", "targetpenalty", "visionpenalty", "extraaim", "SR", "vehdodged", "turnedrider", "failedctrl", "hangingrider", "terrain", "man_ranged_mod", "man_melee_mod" )
	        .fields("esl", "skill", "vmods", "acc", "bulk", "minst", "stdeficit", "dualweapon", "offhand", "wield", "deceptiveatk", "visionpenalty", "tgtsysbonus", "aimingbonus", "ttlaimbonus", "tgtbehindpen", "braced", "scopebonus", "scopeonoff", "laser", "aiming", "ccbtpenalty", "accbonus", "tgtsys", "weaponmount", "vehpenalty", "ttlvehaimbonus")
	        .each(function (r, a) {
	            r.D[0].tgtbehindpen = a.I.targetbehind * -4;
	            r.D[0].ccbtpenalty = a.F.rangedccbt * r.F.bulk;
	            r.D[0].accbonus = r.F.aiming * r.F.acc;
	            r.D[0].aimingbonus = r.F.aiming * (Math.min((r.I.acc), (a.F.extraaim + r.F.braced)));
	            r.D[0].tgtsysbonus = Math.min((r.I.acc), ((r.F.aiming * r.F.tgtsys) + r.F.laser + (r.F.aiming * (r.F.scopeonoff * r.F.scopebonus))));
	            r.F.ttlaimbonus = r.F.accbonus + r.F.aimingbonus + r.F.tgtsysbonus;
	            switch (a.F.terrain) {
	            case 0:
	                switch (r.F.weaponmount) {
	                case 0: //Handheld
	                case 1: //Arm Mount
	                case 2: //Carriage
	                case 3: //External Open Mount
	                case 4: //Stabilized External Open Mount
	                case 5: //Fixed Mount
	                case 6: //Hardpoint
	                case 7: //Stabilized Turret
	                case 8: //Turret
	                    r.F.vehpenalty = 0;
	                    break;
	                }
	                break;
	            case 1: //Air
	            case 2: //Good Road
	                switch (r.F.weaponmount) {
	                case 0: //Handheld
	                    r.F.vehpenalty = -1;
	                    break;
	                case 1: //Arm Mount
	                case 2: //Carriage
	                case 3: //External Open Mount
	                case 4: //Stabilized External Open Mount
	                case 5: //Fixed Mount
	                case 6: //Hardpoint
	                case 7: //Stabilized Turret
	                case 8: //Turret
	                    r.F.vehpenalty = 0;
	                    break;
	                }
	                break;
	            case 3: //Bad Road
	            case 5: //Calm Water
	                switch (r.F.weaponmount) {
	                case 1: //Arm Mount
	                case 4: //Stabilized External Open Mount
	                case 7: //Stabilized Turret
	                    r.F.vehpenalty = 0;
	                    break;
	                case 2: //Carriage
	                case 5: //Fixed Mount
	                case 6: //Hardpoint
	                case 8: //Turret
	                    r.F.vehpenalty = -1;
	                    break;
	                case 3: // External Open Mount
	                    r.F.vehpenalty = -2;
	                    break;
	                case 0: //Handheld
	                    r.F.vehpenalty = -3;
	                    break;
	                }
	                break;
	            case 4: //Off-Road
	            case 6: //Rough Water
	                switch (r.F.weaponmount) {
	                case 1: //Arm Mount
	                case 4: //Stabilized External Open Mount
	                case 7: //Stabilized Turret
	                    r.F.vehpenalty = -1;
	                    break;
	                case 2: //Carriage
	                case 5: //Fixed Mount
	                case 6: //Hardpoint
	                case 8: //Turret
	                    r.F.vehpenalty = -2;
	                    break;
	                case 3: // External Open Mount
	                    r.F.vehpenalty = -3;
	                    break;
	                case 0: //Handheld
	                    r.F.vehpenalty = -4;
	                    break;
	                }
	                break;
	            }

	            if (r.F.weaponmount === 1) {
	                r.F.ttlvehaimbonus = r.F.ttlaimbonus;
	            } else if (r.F.weaponmount === 2) {
	                r.F.ttlvehaimbonus = r.F.ttlaimbonus;
	            } else if (r.F.weaponmount === 4) {
	                r.F.ttlvehaimbonus = r.F.ttlaimbonus;
	            } else if (r.F.weaponmount === 7) {
	                r.F.ttlvehaimbonus = r.F.ttlaimbonus;
	            } else if (r.F.weaponmount === 0) {
	                r.F.ttlvehaimbonus = Math.min(r.F.ttlaimbonus, a.F.SR);
	            } else if (r.F.weaponmount === 6) {
	                r.F.ttlvehaimbonus = Math.min(r.F.ttlaimbonus, a.F.SR);
	            } else if (r.F.weaponmount === 3) {
	                r.F.ttlvehaimbonus = Math.min(r.F.ttlaimbonus, a.F.SR);
	            } else if (r.F.weaponmount === 5) {
	                r.F.ttlvehaimbonus = Math.min(r.F.ttlaimbonus, a.F.SR);
	            } else if (r.F.weaponmount === 8) {
	                r.F.ttlvehaimbonus = Math.min(r.F.ttlaimbonus, a.F.SR);
	            }

	            if (r.I.minst > a.I.strength) {
	                r.D[0].stdeficit = a.I.strength - r.I.minst;
	            } else {
	                r.D[0].stdeficit = 0;
	            }
	            if (r.I.wield < 1 && a.I.ambidextrous < 1) {
	                r.D[0].offhand = -4;
	            } else {
	                r.D[0].offhand = 0;
	            }
	            a.D[0].oppfirepenalty = a.I.oppfireon * (a.F.oppfire + a.F.hexes);
	            if (a.I.visionpenalty < -9) {
	                r.D[0].visionpenalty = -10;
	            } else {
	                r.D[0].visionpenalty = Math.min(0, (a.F.visionpenalty + a.F.nightvision));
	            }


	            r.D[0].vmods = a.F.temp_DX_mod + a.F.skillRoll_mod + r.F.stdeficit + r.F.dualweapon + r.F.offhand + r.F.deceptiveatk + a.F.badfoot + a.F.damagedweapon + a.F.distraction + a.F.popup + a.F.unfam + a.F.rapidfirebonus + a.F.oppfirepenalty + a.F.rangedspeedrangesize + a.F.lightcover + a.F.targetposture + a.F.rangedcannotsee + r.F.visionpenalty + a.F.targetpartialcover + a.F.targetpenalty + r.F.tgtbehindpen + r.F.ccbtpenalty + r.F.ttlvehaimbonus + r.F.vehpenalty + a.F.vehdodged + a.F.turnedrider + a.F.failedctrl + a.F.hangingrider + a.F.man_melee_mod + a.F.man_ranged_mod;

	            r.D[0].esl = r.I.skill + r.F.vmods;
	        })
	        .execute();
	});

	on('sheet:opened change:repeating_rituals', function () {
		TAS.repeating('rituals')
			.fields('greatereffects', 'greatereffectsmultiplier')
			.each(function (r) {
				r.greatereffectsmultiplier = ((2 * r.greatereffects) +
					1);
			})
			.execute();
	});

	on('change:energy_points_max change:energy_points', function (e) {
		updateEnergyReserve();
	});
	// Update Energy Points
	function updateEnergyReserve(callback) {
		console.log('********* updateEnergyReserve *********');
		callback = callback || noop;
		getAttrs(['energy_points_max', 'energy_points', 'percent'], function(v) {
			var energy = v.energy_points || 0;
			var max = v.energy_points_max || 0;
			var percent = Math.floor((energy / max) * 100) || 0;
			setAttrs({
				percent: percent
			}, {silent: false}, callback);
		});
	}	


		// check for changes that affect thrown object stats
	on('change:thrown_object_weight change:striking_st change:basic_lift change:super_throw_level change:thrown_object_strength_mod change:thrown_object_damage_mod', function(event) {
	    
	    updateThrownObjectStats();
	    
	});
	
	/**
	 * Update thrown objects stats
	 * Damage, range, etc.
	 */
	function updateThrownObjectStats() {
	
	    console.log("*********** Updating Thrown Object Stats ***********");
	    
	    var fields = ['thrown_object_weight',
            'striking_st',
            'thrown_object_strength_mod',
            'super_throw_level',
            'thrust',
            'basic_lift',
            'thrown_object_damage_mod'
        ];
	    
	    getAttrs(fields, function (values) {
	        
	        var weight = +values.thrown_object_weight;
	        
	        var basicLift = +values.basic_lift;
	        
	        var throwingST = +values.striking_st;
	        
	        var throwingStMod = parseInt(values.thrown_object_strength_mod);
	        
	        var superThrowLvl = parseInt(values.super_throw_level);
	        
	        var enteredDamageMod = parseInt(values.thrown_object_damage_mod);
	        
	        var damageMod = 0;
	        
	        throwingST = throwingST + throwingStMod;
	        
	        if (weight < 1) {
	            weight = 0;
	        }
	        
	        if (basicLift < 0) {
	            basicLift = 1;
	        }
	        
	        if (superThrowLvl < 0) {
	            superThrowLvl = 0;
	        }
	        
	        var weightRatio = weight/basicLift;
	        
	        var distanceMod = distanceModifier(weightRatio);
	        
	        var distance = throwingST * distanceMod;
	        
	        var damageMod = getThrownDamageModifier(basicLift, weight);
	        
	        // check for super throw
	        if (superThrowLvl > 0) {
	            
	            distance = distance * Math.pow(2,superThrowLvl);
	            
	            damageMod = damageMod + (superThrowLvl * 2);
	            
	        }
	        
	        // check to see if they entered a modifier
	        if (enteredDamageMod != 0) {
	            damageMod = damageMod + enteredDamageMod; 
	        }
	        
	        distance = Math.floor(distance);
	        
	        var finalDamage = getModifiedDamage(values.thrust, damageMod);
	        
            //
	        setAttrs({
	            'thrown_object_strength': throwingST,
	            'thrown_object_range': distance,
	            'thrown_object_damage': finalDamage
	        });
	        
	    });
	    
	}
	
	/*
	 * Get damage modifier
	 *
	 * @param int basicLift In pounds
	 * @param int weight    Weight of thrown object
	 *
	 * @return int
	 */
	function getThrownDamageModifier(basicLift, weight) {
	    
	    var damageMod = 0;
	    
	    if (weight <= Math.floor(basicLift/8)) {
	        damageMod = -2;
	    } else if (Math.floor(basicLift/8) < weight && weight <= Math.floor(basicLift/4)) {
	        damageMod = -1;
	    } else if (Math.floor(basicLift/4) < weight && weight <= Math.floor(basicLift/2)) {
	        damageMod = 0;
	    } else if (Math.floor(basicLift/2) < weight && weight <= Math.floor(basicLift)) {
	        damageMod = 1;
	    } else if (Math.floor(basicLift) < weight && weight <= Math.floor(basicLift*2)) {
	        damageMod = 0;
	    } else if (Math.floor(basicLift*2) < weight && weight <= Math.floor(basicLift*4)) {
	        damageMod = -.5;
	    } else if (Math.floor(basicLift*4) < weight && weight <= Math.floor(basicLift*8)) {
	        damageMod = -1;
	    } else {
	        damageMod = -10;
	    }
	    
	    return damageMod;
	    
	}
	
	/*
	 * Get distance modifier based on ratio
	 *
	 * @param decimal weightRatio Object Weight/Basic Lift
	 *
	 * @return decimal
	 */
	function distanceModifier(weightRatio) {
	    
	    var distanceMod = 0;
	    
	    if (weightRatio <= .05) {
	        distanceMod = 3.5;
	    } else if (.05 < weightRatio && weightRatio <= .10) {
	        distanceMod = 2.5;
	    } else if (.10 < weightRatio && weightRatio <= .15) {
	        distanceMod = 2.0;
	    } else if (.15 < weightRatio && weightRatio <= .20) {
	        distanceMod = 1.5;
	    } else if (.20 < weightRatio && weightRatio <= .25) {
	        distanceMod = 1.2;
	    } else if (.25 < weightRatio && weightRatio <= .30) {
	        distanceMod = 1.1;
	    } else if (.30 < weightRatio && weightRatio <= .40) {
	        distanceMod = 1.0;
	    } else if (.40 < weightRatio && weightRatio <= .50) {
	        distanceMod = .8;
	    } else if (.50 < weightRatio && weightRatio <= .75) {
	        distanceMod = .7;
	    } else if (.75 < weightRatio && weightRatio <= 1.00) {
	        distanceMod = .6;
	    } else if (1.00 < weightRatio && weightRatio <= 1.50) {
	        distanceMod = .4;
	    } else if (1.50 < weightRatio && weightRatio <= 2.0) {
	        distanceMod = .30;
	    } else if (2.0 < weightRatio && weightRatio <= 2.5) {
	        distanceMod = .25;
	    } else if (2.5 < weightRatio && weightRatio <= 3.0) {
	        distanceMod = .20;
	    } else if (3.0 < weightRatio && weightRatio <= 4.0) {
	        distanceMod = .15;
	    } else if (4.0 < weightRatio && weightRatio <= 5.0) {
	        distanceMod = .12;
	    } else if (5.0 < weightRatio && weightRatio <= 6.0) {
	        distanceMod = .10;
	    } else if (6.0 < weightRatio && weightRatio <= 7.0) {
	        distanceMod = .09;
	    } else if (7.0 < weightRatio && weightRatio <= 8.0) {
	        distanceMod = .08;
	    } else if (8.0 < weightRatio && weightRatio <= 9.0) {
	        distanceMod = .07;
	    } else if (9.0 < weightRatio && weightRatio <= 10.0) {
	        distanceMod = .06;
	    } else if (10.0 < weightRatio && weightRatio <= 12.0) {
	        distanceMod = .05;
	    } else {
	        distanceMod = 0;
	    }
	    
	    return distanceMod;
	    
	}

	/**
	 * Determines the final damage dice + modifier
	 * 
	 * @param string damageDice Original damage dice; 3d6
	 * @param int    damageMod  Damage modifier per dice; +1 per dice
	 * 
	 * @return string Modified damge dice
	 */
	function getModifiedDamage(damageDice, damageMod) {
	    
	    var newDamageDice = damageDice;
	    
	    damageDice = damageDice.toLowerCase();
	    
	    // split into array. 
	    // 3d6 = [3,6]
	    var arrDice = damageDice.split("d");
	    
	    if (arrDice.length == 2) {

            var diceCount = parseInt(arrDice[0]);
	    
    	    var diceType = arrDice[1];
    	    
    	    var arrDiceTypeModifier = [];
    	    
    	    var diceModifier = "";
	        
	        if (diceCount < 1) {
	            diceCount = 1;
	        }
	        
	        // check for dice modifier
	        // 3d6+1; diceType = 6+1; diceType=6; diceModifier=1;
	        if (diceType.includes("+")) {
	            
	            arrDiceTypeModifier = diceType.split("+");
	            
	            diceType = arrDiceTypeModifier[0];
	            
	            diceModifier = parseInt(arrDiceTypeModifier[1]);
	            
	        } else if (diceType.includes("-")) { 
	            
	            arrDiceTypeModifier = diceType.split("-");
	            
	            diceType = arrDiceTypeModifier[0];
	            
	            diceModifier = -1 * parseInt(arrDiceTypeModifier[1]);
	            
	        } else {
	            
	            diceModifier = 0;
	            
	        }
	        
	        newDamageDice = diceCount + "d" + diceType;
	        
	        // get the final damage modifier
	        damageMod = Math.floor(damageMod + diceModifier);
	        
	        if (damageMod < 0) {
	            
	            damageMod = Math.abs(damageMod) * diceCount;
	            
	            newDamageDice = newDamageDice + "-" + damageMod;
	            
	        } else if (damageMod > 0) {
	            
	            damageMod = Math.abs(damageMod) * diceCount;
	            
	            newDamageDice = newDamageDice + "+" + damageMod;
	            
	        }
	        
	    }
	    
	    return newDamageDice;
	    
	}
	
	
	on("change:yards_fallen change:gravity change:atmosphere", function() {
	    
	    var fields = [
	        "yards_fallen",
	        "gravity",
	        "atmosphere"
        ];
        
        getAttrs(fields, function(values) {
            
            var yards = Math.floor(+values.yards_fallen);
            
            var gravity = +values.gravity;
            
            var atmosphere = +values.atmosphere;
            
            if (yards <= 0)
                yards = 1;
                
            if (gravity < 0)
                gravity = 1;
                
            if (atmosphere < 0)
                atmosphere = 1;
                
            var velocity = (Math.sqrt(gravity * 21.4 * yards) / Math.sqrt(atmosphere));
            
            velocity = Math.round(velocity);
            
            setAttrs({
                falling_velocity: velocity
            });
            
        });
	    
	});
	
	// handle falling/collision damage
	on("change:falling_velocity change:falling_hit_points", function() {
	    
	    var strDmg = "";
	    
	    getAttrs(["falling_velocity", "falling_hit_points"], function(values) {
	        
	        strDmg = getCollisionDamage(values.falling_velocity, values.falling_hit_points);
	        
	        setAttrs({
	            "falling_damage": strDmg
	        });
	        
	    });
	    
	});
    
    on("change:collision_velocity change:collision_hit_points", function() {
        
        var strDmg = "";
	    
	    getAttrs(["collision_velocity", "collision_hit_points"], function(values) {
	        
	        strDmg = getCollisionDamage(values.collision_velocity, values.collision_hit_points);
	        
	        setAttrs({
	            "collision_damage": strDmg
	        });
	        
	    });
	    
    });
    
    function getCollisionDamage(velocity, hit_points) {
        
        var strDmg = "1d6-3";
        
        var remainder = 0;
        
        velocity = +velocity;
        
        if (velocity <= 0) {
            velocity = 1;
        }
        
        hit_points = +hit_points;
        
        if (hit_points <= 0) {
            hit_points = 1;
        }
        
        var ratio = (hit_points*velocity)/100;

        if (ratio <= .25) {
            
            strDmg = "1d6-3";
            
        } else if (ratio <= .5) {
            
            strDmg = "1d6-2";
            
        } else if (ratio < 1) {
            
            strDmg = "1d6-1";
            
        } else {
            
            remainder = ratio % 1;
            
            if (remainder < .5) {
                strDmg = Math.floor(ratio) + "d6";
            } else {
                strDmg = Math.ceil(ratio) + "d6";
            }
            
        }
        
        return strDmg;
    }	
	    on("clicked:falling_reset", function() {
        
        setAttrs({
            "yards_fallen": 1,
            "gravity": 1,
            "atmosphere": 1,
            "falling_hit_points": 10
        });
        
    });    
    
    on("clicked:collision_reset", function() {
        
        setAttrs({
            "collision_velocity": 1,
            "collision_hit_points": 10
        });
        
    });
	
	on("clicked:condition_reset", function() {
        
        setAttrs({
            "stunned": 0, "shock": 0, "mentally_stunned": 0, "bleeding": 0, "reeling": 0, "mortally_wounded": 0, "coughing": 0, "drowsy": 0, "drunk": 0, "euphoria": 0, "nauseated": 0, "moderate_pain": 0, "severe_pain": 0, "terrible_pain": 0, "typsy": 0, "agony": 0, "choking": 0, "dazed": 0, "ecstasy": 0, "hallucinating": 0, "paralyzed": 0, "retching": 0, "seizure": 0, "unconscious": 0, "coma": 0, "heart_attack": 0, "tired": 0
        });
    });

on("clicked:condition_reset", function() {
        
        setAttrs({
            "stunned": 0, "shock": 0, "mentally_stunned": 0, "bleeding": 0, "reeling": 0, "mortally_wounded": 0, "coughing": 0, "drowsy": 0, "drunk": 0, "euphoria": 0, "nauseated": 0, "moderate_pain": 0, "severe_pain": 0, "terrible_pain": 0, "typsy": 0, "agony": 0, "choking": 0, "dazed": 0, "ecstasy": 0, "hallucinating": 0, "paralyzed": 0, "retching": 0, "seizure": 0, "unconscious": 0, "coma": 0, "heart_attack": 0, "tired": 0
        });
    });	

  on("clicked:defense_reset", function() {
        
        setAttrs({
            "defend_verticaldiff": 0, "defend_badfoot": 0, "cantseeattacker": 0, "defdistracted": 0, "ad_mounted": 0, "multiparry": 0, "frombehind": 0, "fromside": 0, "defendlaser": 0, "defenddeceptive": 0, "unarmedattacker": 0, "dual": 0, "defendflail": 0, "defendfeint": 0, "parrythrown": 0, "defendacrobatic": 0, "feverish": 0, "crossparry": 0, "dodgeanddrop": 0, "riposte": 0, "retreat":0, "manuever":"DN"
        });
    });

on("clicked:melee_reset", function() {
        
        setAttrs({
        	"badfoot":0, "meleegrappled":0, "shieldccbt":0, "distraction":0, "meleestrikeccbt":0, "meleewild":0, "evaluate":0, "meleecannotsee":0, "visionpenalty":0, "nightvision":0, "firing_size_mod":0, "targetloc":"Chest", "manuever":"DN" 
        });
    });	

on("clicked:ranged_reset", function() {
        
        setAttrs({
        	"badfoot":0, "rangedccbt":0, "damagedweapon":0, "distraction":0, "extraaim":0, "popup":0, "unfam":0,  "rapidfire":0, "oppfireon":0, "oppfire":0, "hexes":0, "rangedcannotsee":0, "visionpenalty":0, "nightvision":0, "firing_size_mod":0, "firing_speed_difference":0, "firing_distance":0, "firing_direction": "linear", "firing_up_dwn_distance":0, "lightcover":0, "targetbehind":0, "targetposture":0, "targetpartialcover":0, "targetloc":"Chest", "manuever":"DN"
        });
    });

on("clicked:veh_reset", function() {
        
        setAttrs({
        	"badfoot":0, "rangedccbt":0, "damagedweapon":0, "distraction":0, "extraaim":0, "popup":0, "unfam":0,  "rapidfire":0, "oppfireon":0, "oppfire":0, "hexes":0, "rangedcannotsee":0, "visionpenalty":0, "nightvision":0, "firing_size_mod":0, "firing_speed_difference":0, "firing_distance":0, "firing_direction": "linear", "firing_up_dwn_distance":0, "lightcover":0, "targetbehind":0, "targetposture":0, "targetpartialcover":0, "targetloc":"Chest", "manuever":"DN", "terrain":0, "hangingrider":0, "failedctrl":0, "turnedrider":0, "vehdodged":0
        });
    });
    
    // An explosion doing 6d¥n damage takes (n¥n)/4 pounds of TNT.
    on("sheet:opened change:explosivetypea change:explosive_multiplier change:ref_much",	function(e) {
		getAttrs(['explosive_multiplier', 'ref_much'
			], function(v) {
				var n = +v.explosive_multiplier;
				var REF = +v.ref_much;
				var r = (n*n)/(4 * REF);
				var dice ="6d6*"
				var damage = dice.concat(n);
				var result = r.toFixed(2);
			setAttrs({
				wgt_result:result,
				ex_dam1:damage
			});
		});
	});

	//damage is 6d ¥ square root of (weight of explosive in lbs. ¥ 4 ¥ REF).
    on("sheet:opened change:explosivetypeb change:wgt_req change:ref_big",	function(e) {
		getAttrs(['wgt_req', 'ref_big'
			], function(v) {
				var REF = +v.ref_big;
				var w = +v.wgt_req * 4 * REF;
				var sqrt = Math.sqrt(w)
				
				var n = Math.floor(1 * sqrt);
				var dice ="6d6*"
				var damage = dice.concat(n);
			setAttrs({
				ex_damage_result:damage
			});
		});
	});

// ========== Super ST =========
const modBySuperStrength = [ 
                    	{b:0, s:0},
                        {b:1, s:3},
                    	{b:2, s:5},
                    	{b:3, s:7},
                    	{b:4, s:10},
                    	{b:5, s:15},
                    	{b:6, s:20},
                    	{b:7, s:30},
                    	{b:8, s:50},
                    	{b:9, s:70},
                    	{b:10, s:100},
                    	{b:11, s:150},
                    	{b:12, s:200},
                    	{b:13, s:300},
                    	{b:14, s:500},
                    	{b:15, s:700},
                    	{b:16, s:1000},
                    	{b:17, s:1500},
                    	{b:18, s:2000},
                    	{b:19, s:3000},
                    	{b:20, s:5000},
                    	{b:21, s:7000},
                    	{b:22, s:10000},
                    	{b:23, s:15000},
                    	{b:24, s:20000},
                         {b:25, s:30000},
                         {b:26, s:50000},
                         {b:27, s:70000},
                         {b:28, s:100000},
                         {b:29, s:150000},
                         {b:30, s:200000}
                    ];
const getModBySuperStrength = (d) => {
     const entry = modBySuperStrength.find((o)=>o.b>=d );
     // if no matches, return 0.
     return (entry != undefined ? entry.s : 0);
};

// Super Abilities Calculator
on('sheet:opened change:base_value change:strength', function (event) {
     updateSuperStrengthStats();
});
function updateSuperStrengthStats() {
     var fields = ["base_value", "strength"];
     getAttrs(fields, function(values) {
          var baseValue = +values.base_value;
          var strength = +values.strength;
          finalSuperStrengthValue = baseValue;
          var superStrengthValue = getModBySuperStrength(finalSuperStrengthValue);

          setAttrs({
               "superstrength": superStrengthValue,
               "total_superstrength": strength + superStrengthValue
          })

     })
}

	
</script>

	<!-- ===== ===== ===== ===== ROLL TEMPLATES ===== ===== ===== ===== -->
	<div class="sheet-hidden">
		<rolltemplate class="sheet-rolltemplate-GURPSATTR">
			<div class="sheet-name-box">
				<div class="sheet-namebar">{{charactername}}</div>
				<div class="sheet-rollbar">Roll: {{roll}} vs. effective {{roll_name}}: {{target}}</div>
		{{#success}}
				<div class="sheet-successbar">{{success}}</div>
		{{/success}}
		{{#fail}}
				<div class="sheet-failbar">{{fail}}</div>
		{{/fail}}
		{{#notes}}
				<div class="sheet-notebar">Notes</div>
				<div class="sheet-notestext">{{notes}}</div>
		{{/notes}}
			</div>			
		</rolltemplate>
		<rolltemplate class="sheet-rolltemplate-GURPSBASIC">
			<div class="sheet-name-box">
				<div class="sheet-namebar">{{charactername}}</div>
				<div class="sheet-rollbar">Basic {{roll_type}} Damage: {{roll}}</div>
			</div>
		</rolltemplate>
		<rolltemplate class="sheet-rolltemplate-GURPSADV">
			<div class="sheet-name-box">
				<div class="sheet-namebar">{{charactername}}</div>
				<div class="sheet-titlebar">{{roll_name}}</div>
				<div class="sheet-rollbar">Roll: {{roll}} vs. Control Rating: {{target}}</div>
				{{#success}}
				<div class="sheet-successbar">{{success}}</div>
				{{/success}}
				{{#fail}}
				<div class="sheet-failbar">{{fail}}</div>
				{{/fail}}
				{{#notes}}
				<div class="sheet-notebar">Notes</div>
				<div class="sheet-notestext">{{notes}}</div>
				{{/notes}}
			</div>			
		</rolltemplate>
		<rolltemplate class="sheet-rolltemplate-GURPSDISAD">
			<div class="sheet-name-box">
				<div class="sheet-namebar">{{charactername}}</div>
				<div class="sheet-titlebar">{{roll_name}}</div>
				<div class="sheet-rollbar">Roll: {{roll}} vs. Control Roll: {{target}}</div>
			{{#success}}
				<div class="sheet-successbar">{{success}}</div>
			{{/success}}
			{{#fail}}
				<div class="sheet-failbar">{{fail}}</div>
			{{/fail}}
			{{#notes}}
				<div class="sheet-notestext">{{notes}}</div>
			{{/notes}}
			</div>	
		</rolltemplate>
		<rolltemplate class="sheet-rolltemplate-GURPSTRAIT">
			<div class="sheet-name-box">
				<div class="sheet-namebar">{{charactername}}</div>
				<div class="sheet-titlebar">{{roll_name}}</div>
				<div class="sheet-rollbar">Roll: {{roll}} vs. Control Roll: {{target}}</div>
			{{#success}}
				<div class="sheet-successbar">{{success}}</div>
			{{/success}}
			{{#fail}}
				<div class="sheet-failbar">{{fail}}</div>
			{{/fail}}
			{{#notes}}
				<div class="sheet-notestext">{{notes}}</div>
			{{/notes}}
			</div>	
		</rolltemplate>
		<rolltemplate class="sheet-rolltemplate-GURPSSKILL">
			<div class="sheet-name-box">
				<div class="sheet-namebar">{{charactername}}</div>
				<div class="sheet-titlebar">{{roll_name}}</div>
				<div class="sheet-rollbar">Roll: {{roll}} vs. Effective Skill Level: {{target}}</div>
			{{#success}}
				<div class="sheet-successbar">{{success}}</div>
			{{/success}}
			{{#fail}}
				<div class="sheet-failbar">{{fail}}</div>
			{{/fail}}
			{{#notes}}
				<div class="sheet-notestext">{{notes}}</div>
			{{/notes}}
			</div>	
		</rolltemplate>
		<rolltemplate class="sheet-rolltemplate-GURPSTECH">
			<div class="sheet-name-box">
				<div class="sheet-namebar">{{charactername}}</div>
				<div class="sheet-titlebar">{{roll_name}}</div>
				<div class="sheet-parentbar">({{parent_name}})</div>
				<div class="sheet-rollbar">Roll: {{roll}} vs. Effective Skill Level: {{target}}</div>
			{{#success}}
				<div class="sheet-successbar">{{success}}</div>
			{{/success}}
			{{#fail}}
				<div class="sheet-failbar">{{fail}}</div>
			{{/fail}}
			{{#notes}}
				<div class="sheet-notestext">{{notes}}</div>
			{{/notes}}
			</div>	
		</rolltemplate>
		<rolltemplate class="sheet-rolltemplate-GURPSDEFENSE">
			<div class="sheet-name-box">
				<div class="sheet-namebar">{{charactername}}</div>
				<div class="sheet-titlebar">{{roll_name}}</div>
				<div class="sheet-parentbar">({{type}})</div>
				<div class="sheet-rollbar">Roll: {{roll}} vs. Effective Skill Level: {{target}}</div>
			{{#success}}
				<div class="sheet-successbar">{{success}}</div>
			{{/success}}
			{{#fail}}
				<div class="sheet-failbar">{{fail}}</div>
			{{/fail}}
			{{#notes}}
				<div class="sheet-notestext">{{notes}}</div>
			{{/notes}}
			</div>	
		</rolltemplate>
		<rolltemplate class="sheet-rolltemplate-GURPSATTACK">
			<div class="sheet-name-box">
				<div class="sheet-namebar">{{charactername}}</div>
				<div class="sheet-titlebar">{{roll_name}}</div>
				<div class="sheet-parentbar">{{usage}}</div>
				<div class="sheet-rollbar">Roll: {{roll}} vs. Effective Skill Level: {{target}}</div>
			{{#success}}
				<div class="sheet-successbar">{{success}}</div>
			{{/success}}
			{{#fail}}
				<div class="sheet-failbar">{{fail}}</div>
			{{/fail}}
			{{#notes}}
				<div class="sheet-notestext">{{notes}}</div>
			{{/notes}}
			</div>
		</rolltemplate>
		<rolltemplate class="sheet-rolltemplate-GURPSDAMAGE">
			{{#damage}}
			<div class="sheet-damage-box">
				<div class="sheet-damagebar">
					<div class="sheet-dam0">Damage</div>
					<div class="sheet-dam1">Type</div>
					<div class="sheet-dam2">Location</div>
					<div class="sheet-dam3">Mod</div>
				</div>
				<div class="sheet-damagetext">
					<div class="sheet-dam0">{{damage}}</div>
					<div class="sheet-dam1">{{type}}</div>
					<div class="sheet-dam2">{{location}}</div>
					<div class="sheet-dam3">{{wm}}</div>
				</div>
				<div class="sheet-woundbar">Wound Notes</div>
				<div class="sheet-woundtext">{{wound_notes}}</div>
			</div>
			{{/damage}}
			{{#rollGreater() linked 0}}
			<div class="sheet-damage-box">
				<div class="sheet-woundbar">Linked Damage</div>
				<div class="sheet-damagebar">
					<div class="sheet-dam0">Damage</div>
					<div class="sheet-dam1">Type</div>
					<div class="sheet-dam2">Location</div>
					<div class="sheet-dam3">Mod</div>
				</div>
				<div class="sheet-damagetext">
					<div class="sheet-dam0">{{linked}}</div>
					<div class="sheet-dam1">{{type}}</div>
					<div class="sheet-dam2">{{location}}</div>
					<div class="sheet-dam3">{{wm}}</div>
				</div>
				<div class="sheet-woundbar">Wound Notes</div>
				<div class="sheet-woundtext">{{wound_notes}}</div>
			</div>
			{{/rollGreater() linked 0}}
			{{#rollGreater() followup 0}}
			<div class="sheet-damage-box">
				<div class="sheet-woundbar">Follow-up Damage</div>
				<div class="sheet-damagebar">
					<div class="sheet-dam0">Damage</div>
					<div class="sheet-dam1">Type</div>
					<div class="sheet-dam2">Location</div>
					<div class="sheet-dam3">Mod</div>
				</div>
				<div class="sheet-damagetext">
					<div class="sheet-dam0">{{followup}}</div>
					<div class="sheet-dam1">{{type}}</div>
					<div class="sheet-dam2">{{location}}</div>
					<div class="sheet-dam3">{{wm}}</div>
				</div>
				<div class="sheet-woundbar">Wound Notes</div>
				<div class="sheet-woundtext">{{wound_notes}}</div>
			</div>
			{{/rollGreater() followup 0}}
			{{#criteffect}}
				<div class="sheet-critical-box">
					<div class="sheet-critnotes">{{criteffect}}</div>
				</div>
			{{/criteffect}}			
		</rolltemplate>
		
		<rolltemplate class="sheet-rolltemplate-GURPSMAGIC">
			<div class="sheet-name-box">
				<div class="sheet-namebar">{{charactername}}</div>
				<div class="sheet-titlebar">{{roll_name}}</div>
				{{#clss}}
				<div class="sheet-magictext">
					<div class="sheet-cell1">Class: </div>
					<div class="sheet-cell2">{{clss}}</div>
					<div class="sheet-cell1">College: </div>
					<div class="sheet-cell2">{{college}}</div>
				</div>
				{{/clss}}
				{{#casttime}}
				<div class="sheet-magictext">
					<div class="sheet-cell1">Cast Time: </div>
					<div class="sheet-cell2">{{casttime}}</div>
					<div class="sheet-cell1">Duration: </div>
					<div class="sheet-cell2">{{duration}}</div>
				</div>
				{{/casttime}}
				{{#cost}}
				<div class="sheet-magictext">
					<div class="sheet-cell1">Cost Cast: </div>
					<div class="sheet-cell2">{{cost}}</div>
					<div class="sheet-cell1">Maintain: </div>
					<div class="sheet-cell2">{{maintain}}</div>
				</div>
				{{/cost}}
				<div class="sheet-rollbar">Roll: {{roll}} vs. Effective Skill Level: {{target}}</div>
			{{#success}}
				<div class="sheet-successbar">{{success}}</div>
			{{/success}}
			{{#fail}}
				<div class="sheet-failbar">{{fail}}</div>
			{{/fail}}
			{{#notes}}
				<div class="sheet-notestext">{{notes}}</div>
			{{/notes}}
			</div>
		</rolltemplate>
		<rolltemplate class="sheet-rolltemplate-GURPSRITUAL">
			<div class="sheet-name-box">
				<div class="sheet-namebar">{{charactername}}</div>
				<div class="sheet-titlebar">{{roll_name}}</div>
				<div class="sheet-rollbar">Roll: {{roll}} vs. Effective Skill Level: {{target}}</div>
			{{#success}}
				<div class="sheet-successbar">{{success}}</div>
			{{/success}}
			{{#fail}}
				<div class="sheet-failbar">{{fail}}</div>
			{{/fail}}
			{{#notes}}
				<div class="sheet-notestext">{{notes}}</div>
			{{/notes}}
			{{#effects}}
				<div class="sheet-ritualbar">Spell Effects</div>
				<div class="sheet-notestext">{{effects}}</div>
			{{/effects}}
			{{#inherentmod}}
				<div class="sheet-ritualbar">Inherent Modifiers</div>
				<div class="sheet-notestext">{{inherentmod}}</div>
			{{/inherentmod}}
			{{#descr}}
				<div class="sheet-ritualbar">Ritual Dscription</div>
				<div class="sheet-notestext">{{descr}}</div>
			{{/descr}}
			{{#typical}}
				<div class="sheet-ritualbar">This Casting</div>
				<div class="sheet-notestext">{{typical}}</div>
			{{/typical}}
			</div>
		</rolltemplate>
		<rolltemplate class="sheet-rolltemplate-GURPSFRIGHT">
			<div class="sheet-name-box">
				<div class="sheet-namebar">{{charactername}}</div>
				<div class="sheet-titlebar">{{fright_table}}</div>
				<div class="sheet-rollbar">Roll: {{roll}} vs. Effective Skill Level: {{target}}</div>
			{{#success}}
				<div class="sheet-successbar">{{success}}</div>
			{{/success}}
			{{#fail}}
				<div class="sheet-failbar">{{fail}}</div>
			{{/fail}}
			{{#fright_result}}
				<div class="sheet-feartext">{{fright_result}}</div>
			{{/fright_result}}
			</div>
		</rolltemplate>
		<rolltemplate class="sheet-rolltemplate-GURPSGM">
			<div class="sheet-critical-box">
				<div class="sheet-critnotes">{{criteffect}}</div>
			</div>
		</rolltemplate>
				<rolltemplate class="sheet-rolltemplate-GURPSATTRGM">
			<div class="sheet-name-box">
				<div class="sheet-namebar">{{charactername}}</div>
				<div class="sheet-rollbar">Roll: {{roll}} vs. effective {{roll_name}}: {{target}}</div>
		{{#success}}
				<div class="sheet-successbar">{{success}}</div>
		{{/success}}
		{{#fail}}
				<div class="sheet-failbar">{{fail}}</div>
		{{/fail}}
		{{#notes}}
				<div class="sheet-notebar">Notes</div>
				<div class="sheet-notestext">{{notes}}</div>
		{{/notes}}
			</div>			
		</rolltemplate>
		<rolltemplate class="sheet-rolltemplate-GURPSBASICGM">
			<div class="sheet-name-box">
				<div class="sheet-namebar">{{charactername}}</div>
				<div class="sheet-rollbar">Basic {{roll_type}} Damage: {{roll}}</div>
			</div>
		</rolltemplate>
		<rolltemplate class="sheet-rolltemplate-GURPSADVGM">
				<div class="sheet-name-box">
					<div class="sheet-namebar">{{charactername}}</div>
					<div class="sheet-titlebar">{{roll_name}}</div>
					<div class="sheet-rollbar">Roll: {{roll}} vs. Control Rating: {{target}}</div>
			{{#success}}
					<div class="sheet-successbar">{{success}}</div>
			{{/success}}
			{{#fail}}
					<div class="sheet-failbar">{{fail}}</div>
			{{/fail}}
			{{#notes}}
					<div class="sheet-notebar">Notes</div>
					<div class="sheet-notestext">{{notes}}</div>
			{{/notes}}
				</div>			
		</rolltemplate>
		<rolltemplate class="sheet-rolltemplate-GURPSDISADGM">
			<div class="sheet-name-box">
				<div class="sheet-namebar">{{charactername}}</div>
				<div class="sheet-titlebar">{{roll_name}}</div>
				<div class="sheet-rollbar">Roll: {{roll}} vs. Control Roll: {{target}}</div>
			{{#success}}
				<div class="sheet-successbar">{{success}}</div>
			{{/success}}
			{{#fail}}
				<div class="sheet-failbar">{{fail}}</div>
			{{/fail}}
			{{#notes}}
				<div class="sheet-notestext">{{notes}}</div>
			{{/notes}}
			</div>	
		</rolltemplate>
		<rolltemplate class="sheet-rolltemplate-GURPSTRAITGM">
			<div class="sheet-name-box">
				<div class="sheet-namebar">{{charactername}}</div>
				<div class="sheet-titlebar">{{roll_name}}</div>
				<div class="sheet-rollbar">Roll: {{roll}} vs. Control Roll: {{target}}</div>
			{{#success}}
				<div class="sheet-successbar">{{success}}</div>
			{{/success}}
			{{#fail}}
				<div class="sheet-failbar">{{fail}}</div>
			{{/fail}}
			{{#notes}}
				<div class="sheet-notestext">{{notes}}</div>
			{{/notes}}
			</div>	
		</rolltemplate>
		<rolltemplate class="sheet-rolltemplate-GURPSSKILLGM">
			<div class="sheet-name-box">
				<div class="sheet-namebar">{{charactername}}</div>
				<div class="sheet-titlebar">{{roll_name}}</div>
				<div class="sheet-rollbar">Roll: {{roll}} vs. Effective Skill Level: {{target}}</div>
			{{#success}}
				<div class="sheet-successbar">{{success}}</div>
			{{/success}}
			{{#fail}}
				<div class="sheet-failbar">{{fail}}</div>
			{{/fail}}
			{{#notes}}
				<div class="sheet-notestext">{{notes}}</div>
			{{/notes}}
			</div>	
		</rolltemplate>
		<rolltemplate class="sheet-rolltemplate-GURPSTECHGM">
			<div class="sheet-name-box">
				<div class="sheet-namebar">{{charactername}}</div>
				<div class="sheet-titlebar">{{roll_name}}</div>
				<div class="sheet-parentbar">({{parent_name}})</div>
				<div class="sheet-rollbar">Roll: {{roll}} vs. Effective Skill Level: {{target}}</div>
			{{#success}}
				<div class="sheet-successbar">{{success}}</div>
			{{/success}}
			{{#fail}}
				<div class="sheet-failbar">{{fail}}</div>
			{{/fail}}
			{{#notes}}
				<div class="sheet-notestext">{{notes}}</div>
			{{/notes}}
			</div>	
		</rolltemplate>
		<rolltemplate class="sheet-rolltemplate-GURPSDEFENSEGM">
			<div class="sheet-name-box">
				<div class="sheet-namebar">{{charactername}}</div>
				<div class="sheet-titlebar">{{roll_name}}</div>
				<div class="sheet-parentbar">({{type}})</div>
				<div class="sheet-rollbar">Roll: {{roll}} vs. Effective Skill Level: {{target}}</div>
			{{#success}}
				<div class="sheet-successbar">{{success}}</div>
			{{/success}}
			{{#fail}}
				<div class="sheet-failbar">{{fail}}</div>
			{{/fail}}
			{{#notes}}
				<div class="sheet-notestext">{{notes}}</div>
			{{/notes}}
			</div>	
		</rolltemplate>
		<rolltemplate class="sheet-rolltemplate-GURPSATTACKGM">
			<div class="sheet-name-box">
				<div class="sheet-namebar">{{charactername}}</div>
				<div class="sheet-titlebar">{{roll_name}}</div>
				<div class="sheet-parentbar">{{usage}}</div>
				<div class="sheet-rollbar">Roll: {{roll}} vs. Effective Skill Level: {{target}}</div>
			{{#success}}
				<div class="sheet-successbar">{{success}}</div>
			{{/success}}
			{{#fail}}
				<div class="sheet-failbar">{{fail}}</div>
			{{/fail}}
			{{#notes}}
				<div class="sheet-notestext">{{notes}}</div>
			{{/notes}}
			</div>
		</rolltemplate>
		<rolltemplate class="sheet-rolltemplate-GURPSDAMAGEGM">
			{{#damage}}
			<div class="sheet-damage-box">
				<div class="sheet-damagebar">
					<div class="sheet-dam0">Damage</div>
					<div class="sheet-dam1">Type</div>
					<div class="sheet-dam2">Location</div>
					<div class="sheet-dam3">Mod</div>
				</div>
				<div class="sheet-damagetext">
					<div class="sheet-dam0">{{damage}}</div>
					<div class="sheet-dam1">{{type}}</div>
					<div class="sheet-dam2">{{location}}</div>
					<div class="sheet-dam3">{{wm}}</div>
				</div>
				<div class="sheet-woundbar">Wound Notes</div>
				<div class="sheet-woundtext">{{wound_notes}}</div>
			</div>
			{{/damage}}
			{{#linked}}
			<div class="sheet-damage-box">
				<div class="sheet-woundbar">Linked Damage</div>
				<div class="sheet-damagebar">
					<div class="sheet-dam0">Damage</div>
					<div class="sheet-dam1">Type</div>
					<div class="sheet-dam2">Location</div>
					<div class="sheet-dam3">Mod</div>
				</div>
				<div class="sheet-damagetext">
					<div class="sheet-dam0">{{linked}}</div>
					<div class="sheet-dam1">{{type}}</div>
					<div class="sheet-dam2">{{location}}</div>
					<div class="sheet-dam3">{{wm}}</div>
				</div>
				<div class="sheet-woundbar">Wound Notes</div>
				<div class="sheet-woundtext">{{wound_notes}}</div>
			</div>
			{{/linked}}
			{{#followup}}
			<div class="sheet-damage-box">
				<div class="sheet-woundbar">Follow-up Damage</div>
				<div class="sheet-damagebar">
					<div class="sheet-dam0">Damage</div>
					<div class="sheet-dam1">Type</div>
					<div class="sheet-dam2">Location</div>
					<div class="sheet-dam3">Mod</div>
				</div>
				<div class="sheet-damagetext">
					<div class="sheet-dam0">{{followup}}</div>
					<div class="sheet-dam1">{{type}}</div>
					<div class="sheet-dam2">{{location}}</div>
					<div class="sheet-dam3">{{wm}}</div>
				</div>
				<div class="sheet-woundbar">Wound Notes</div>
				<div class="sheet-woundtext">{{wound_notes}}</div>
			</div>
			{{/followup}}
			
			{{#criteffect}}
				<div class="sheet-critical-box">
					<div class="sheet-critnotes">{{criteffect}}</div>
				</div>
			{{/criteffect}}			
		</rolltemplate>
		<rolltemplate class="sheet-rolltemplate-GURPSMAGICGM">
			<div class="sheet-name-box">
				<div class="sheet-namebar">{{charactername}}</div>
				<div class="sheet-titlebar">{{roll_name}}</div>
				{{#clss}}
				<div class="sheet-magictext">
					<div class="sheet-cell1">Class: </div>
					<div class="sheet-cell2">{{clss}}</div>
					<div class="sheet-cell1">College: </div>
					<div class="sheet-cell2">{{college}}</div>
				</div>
				{{/clss}}
				{{#casttime}}
				<div class="sheet-magictext">
					<div class="sheet-cell1">Cast Time: </div>
					<div class="sheet-cell2">{{casttime}}</div>
					<div class="sheet-cell1">Duration: </div>
					<div class="sheet-cell2">{{duration}}</div>
				</div>
				{{/casttime}}
				{{#cost}}
				<div class="sheet-magictext">
					<div class="sheet-cell1">Cost Cast: </div>
					<div class="sheet-cell2">{{cost}}</div>
					<div class="sheet-cell1">Maintain: </div>
					<div class="sheet-cell2">{{maintain}}</div>
				</div>
				{{/cost}}
				<div class="sheet-rollbar">Roll: {{roll}} vs. Effective Skill Level: {{target}}</div>
			{{#success}}
				<div class="sheet-successbar">{{success}}</div>
			{{/success}}
			{{#fail}}
				<div class="sheet-failbar">{{fail}}</div>
			{{/fail}}
			{{#notes}}
				<div class="sheet-notestext">{{notes}}</div>
			{{/notes}}
			</div>
		</rolltemplate>
		<rolltemplate class="sheet-rolltemplate-GURPSRITUALGM">
			<div class="sheet-name-box">
				<div class="sheet-namebar">{{charactername}}</div>
				<div class="sheet-titlebar">{{roll_name}}</div>
				<div class="sheet-rollbar">Roll: {{roll}} vs. Effective Skill Level: {{target}}</div>
			{{#success}}
				<div class="sheet-successbar">{{success}}</div>
			{{/success}}
			{{#fail}}
				<div class="sheet-failbar">{{fail}}</div>
			{{/fail}}
			{{#notes}}
				<div class="sheet-notestext">{{notes}}</div>
			{{/notes}}
			{{#effects}}
				<div class="sheet-ritualbar">Spell Effects</div>
				<div class="sheet-notestext">{{effects}}</div>
			{{/effects}}
			{{#inherentmod}}
				<div class="sheet-ritualbar">Inherent Modifiers</div>
				<div class="sheet-notestext">{{inherentmod}}</div>
			{{/inherentmod}}
			{{#descr}}
				<div class="sheet-ritualbar">Ritual Dscription</div>
				<div class="sheet-notestext">{{descr}}</div>
			{{/descr}}
			{{#typical}}
				<div class="sheet-ritualbar">This Casting</div>
				<div class="sheet-notestext">{{typical}}</div>
			{{/typical}}
			</div>
		</rolltemplate>
		<rolltemplate class="sheet-rolltemplate-GURPSFRIGHTGM">
			<div class="sheet-name-box">
				<div class="sheet-namebar">{{charactername}}</div>
				<div class="sheet-titlebar">{{fright_table}}</div>
				<div class="sheet-rollbar">Roll: {{roll}} vs. Effective Skill Level: {{target}}</div>
			
			{{#success}}
				<div class="sheet-successbar">{{success}}</div>
			{{/success}}
			{{#fail}}
				<div class="sheet-failbar">{{fail}}</div>
			{{/fail}}
			{{#fright_result}}
				<div class="sheet-feartext">{{fright_result}}</div>
			{{/fright_result}}
			</div>
		</rolltemplate>
		<rolltemplate class="sheet-rolltemplate-GURPSGMGM">
			<div class="sheet-critical-box">
				<div class="sheet-critnotes">{{criteffect}}</div>
			</div>
		</rolltemplate>
		<rolltemplate class="sheet-rolltemplate-GURPSGMROLLING">
			<div class="sheet-GM-box">
				<div class="sheet-gmrolling">{{gmrolling}}</div>
			</div>
		</rolltemplate>
		<rolltemplate class="sheet-rolltemplate-GURPSFALLCOLL">
			<div class="sheet-GM-box">
				<div class="sheet-gmrolling">{{CF}} {{damage}}</div>
			</div>
		</rolltemplate>
		<rolltemplate class="sheet-rolltemplate-GURPSTHROWN">
			<div class="sheet-GM-box">
				<div class="sheet-gmrolling">{{Throw}} {{damage}}</div>
			</div>
		</rolltemplate>
		<rolltemplate class="sheet-rolltemplate-GURPSREACT">
			<div class="sheet-GM-box">
				<div class="sheet-socialtitle">{{header}}</div>
				<div class="sheet-gmrolling"><b>{{reaction}}</b> {{notes}}</div>
			</div>
		</rolltemplate>
	</div>
</div>
